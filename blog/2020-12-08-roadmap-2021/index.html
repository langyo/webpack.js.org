<!DOCTYPE html><html lang="zh-cmn-Hans"><head><title data-rh="true">Roadmap 2021 (2020-12-08) | webpack 中文文档</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="theme-color" content="#2B3A42"/><meta data-rh="true" name="viewport" content="width=device-width, initial-scale=1"/><meta data-rh="true" name="description" content="webpack 是一个模块打包器。它的主要目标是将 JavaScript 文件打包在一起，打包后的文件用于在浏览器中使用，但它也能够胜任转换、打包或包裹任何资源。"/><meta data-rh="true" property="og:site_name" content="webpack"/><meta data-rh="true" property="og:type" content="website"/><meta data-rh="true" property="og:title" content="Roadmap 2021 (2020-12-08) | webpack 中文文档"/><meta data-rh="true" property="og:description" name="description" content="webpack 是一个模块打包器。它的主要目标是将 JavaScript 文件打包在一起，打包后的文件用于在浏览器中使用，但它也能够胜任转换、打包或包裹任何资源。"/><meta data-rh="true" property="og:image" content="https://webpack.js.org/icon-pwa-512x512.d3dae4189855b3a72ff9.png"/><meta data-rh="true" property="twitter:card" content="summary"/><meta data-rh="true" property="twitter:site" content="@webpack"/><meta data-rh="true" property="twitter:creator" content="@webpack"/><meta data-rh="true" property="twitter:domain" content="https://webpack.js.org/"/><meta data-rh="true" name="keywords" content="webpack5, webpack, webpack 中文文档, webpack 官方中文, webpack 5 官方中文, 印记中文, docschina, docschina.org, webpack.docschina.org, doc.react-china.org, nodejs.cn, vue.docschina.org, babel.docschina.org, parceljs.docschina.org, rollup.docschina.org, koajs.docschina.org"/><meta data-rh="true" name="mobile-web-app-capable" content="yes"/><meta data-rh="true" name="apple-mobile-web-app-capable" content="yes"/><meta data-rh="true" name="apple-mobile-web-app-status-bar-style" content="black"/><meta data-rh="true" name="apple-mobile-web-app-title" content="webpack"/><meta data-rh="true" name="msapplication-TileImage" content="/icon_150x150.png"/><meta data-rh="true" name="msapplication-TileColor" content="#465e69"/><link data-rh="true" rel="icon" type="image/x-icon" href="/favicon.f326220248556af65f41.ico"/><link data-rh="true" rel="manifest" href="/manifest.json"/><link data-rh="true" rel="canonical" href="https://webpack.docschina.org/blog/2020-12-08-roadmap-2021/"/><link data-rh="true" rel="icon" sizes="192x192" href="/icon_192x192.png"/><link data-rh="true" rel="icon" sizes="512x512" href="/icon_512x512.png"/><link data-rh="true" rel="apple-touch-icon" href="/icon_180x180.png"/><link data-rh="true" rel="mask-icon" href="/logo-on-white-bg.47eff95f9c01c5972f6f.svg" color="#465e69"/><link rel="stylesheet" href=/index.c114afea0778b47a418a.css /><link rel="stylesheet" href=/9517.acfe42251eae743e4e22.css /></head><body><div id="root"><div class="site"><div class="site__header"><header class="bg-blue-800 dark:bg-gray-900"><div class="flex items-center py-10 px-[16px] justify-between md:px-[24px] md:max-w-[1024px] md:mx-auto md:justify-start"><button class="bg-transparent border-none md:hidden"><svg viewBox="-62 138 25 25" width="20" height="20" class="fill-current text-white"><path fill="currentColor" d="M-60.2 140.2h20.9c1 0 1.8.8 1.8 1.8s-.8 1.8-1.8 1.8h-20.9c-1 0-1.8-.8-1.8-1.8s.8-1.8 1.8-1.8M-60.2 148.7h20.9c1 0 1.8.8 1.8 1.8s-.8 1.8-1.8 1.8h-20.9c-1 0-1.8-.8-1.8-1.8s.8-1.8 1.8-1.8M-60.2 157.2h20.9c1 0 1.8.8 1.8 1.8s-.8 1.8-1.8 1.8h-20.9c-1 0-1.8-.8-1.8-1.8s.8-1.8 1.8-1.8"></path></svg></button><a class="md:mr-auto" href="/"><img class="logo" src="/site-logo.1fcab817090e78435061.svg" alt="webpack logo" width="122" height="35"/></a><nav class="hidden md:inline-grid md:grid-flow-col md:gap-x-[18px]"><a class="text-gray-100 dark:text-gray-100 text-sm font-light uppercase hover:text-blue-200" href="/concepts/">中文文档</a><a class="text-gray-100 dark:text-gray-100 text-sm font-light uppercase hover:text-blue-200" href="/contribute/">参与贡献</a><a aria-current="page" class="text-gray-100 dark:text-gray-100 text-sm font-light uppercase hover:text-blue-200 !text-blue-200" href="/blog/">博客</a><a href="https://docschina.org" target="_blank" rel="noopener noreferrer" class="text-gray-100 dark:text-gray-100 text-sm font-light uppercase hover:text-blue-200">印记中文</a><a href="https://github.com/webpack/webpack" target="_blank" rel="noopener noreferrer" class="inline-flex items-center text-gray-100 dark:text-gray-200 hover:text-blue-200" title="webpack on GitHub"><svg viewBox="0 0 24 24" aria-hidden="true" fill="currentColor" width="16"><path d="M12 2A10 10 0 0 0 2 12a10 10 0 0 0 6.8 9.5c.5 0 .7-.2.7-.5v-1.7C6.7 20 6.1 18 6.1 18c-.4-1.2-1-1.5-1-1.5-1-.6 0-.6 0-.6 1 0 1.5 1 1.5 1 .9 1.6 2.4 1.1 3 .9 0-.7.3-1.1.6-1.4-2.2-.2-4.6-1-4.6-4.9 0-1.1.4-2 1-2.7 0-.3-.4-1.3.2-2.7 0 0 .8-.2 2.7 1a9.4 9.4 0 0 1 5 0c2-1.2 2.8-1 2.8-1 .5 1.4.1 2.4 0 2.7.7.7 1 1.6 1 2.7 0 3.8-2.3 4.7-4.5 5 .4.2.7.8.7 1.8V21c0 .3.2.6.7.5 4-1.3 6.8-5 6.8-9.5A10 10 0 0 0 12 2"></path></svg></a><a href="https://twitter.com/webpack" target="_blank" rel="noopener noreferrer" class="inline-flex items-center text-gray-100 dark:text-gray-200 hover:text-blue-200" title="webpack on Twitter"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30" aria-hidden="true" fill="currentColor" width="16"><path d="M28 6.937c-.957.425-1.985.711-3.064.84a5.343 5.343 0 0 0 2.345-2.951 10.696 10.696 0 0 1-3.388 1.295 5.334 5.334 0 0 0-9.089 4.864A15.143 15.143 0 0 1 3.809 5.411a5.321 5.321 0 0 0-.721 2.683 5.33 5.33 0 0 0 2.372 4.439 5.323 5.323 0 0 1-2.416-.667v.067a5.335 5.335 0 0 0 4.279 5.23 5.336 5.336 0 0 1-2.409.092 5.34 5.34 0 0 0 4.983 3.705 10.699 10.699 0 0 1-6.625 2.284c-.43 0-.855-.025-1.273-.075a15.102 15.102 0 0 0 8.177 2.396c9.812 0 15.176-8.128 15.176-15.177 0-.231-.005-.461-.015-.69A10.855 10.855 0 0 0 28 6.937z"></path></svg></a><a href="https://stackoverflow.com/questions/tagged/webpack" target="_blank" rel="noopener noreferrer" class="inline-flex items-center text-gray-100 dark:text-gray-200 hover:text-blue-200" title="webpack on StackOverflow"><svg viewBox="0 0 24 24" aria-hidden="true" fill="currentColor" width="16"><path d="M17.4 20.2v-5.4h1.8V22H3v-7.2h1.8v5.4zM6.8 14.3l.3-1.7 8.8 1.8-.3 1.8zm1.1-4.2.8-1.6 8.1 3.8-.7 1.6zm2.3-4 1.1-1.4 7 5.8-1.2 1.4L10 6m4.7-4L20 9l-1.4 1-5.4-7 1.4-1m-8 16.5v-1.8h9v1.8z"></path></svg></a><nav class="dropdown "><button aria-haspopup="true" aria-expanded="false" aria-label="Select language"><svg viewBox="0 0 610 560" xmlns="http://www.w3.org/2000/svg" class="dropdown__language text-gray-100 hover:text-blue-200 transition-colors duration-200"><path d="m304.8 99.2-162.5-57.3v353.6l162.5-52.6z"></path><path d="m300.9 99 168.7-57.3v353.6l-168.7-52.5zm-200.7 358.4 200.7-66.9v-291.5l-200.7 66.9z" fill="currentColor"></path><path d="m392.4 461.8 28.4 46.8 15-43.5zm-223.9-262.3c-1.1-1 1.4 8.6 4.8 12 6.1 6.1 10.8 6.9 13.3 7 5.6.2 12.5-1.4 16.5-3.1s10.9-5.2 13.5-10.4c.6-1.1 2.1-3 1.1-7.5-.7-3.5-3-4.8-5.7-4.6s-11 2.4-15 3.6-12.2 3.7-15.8 4.5-11.5-.3-12.7-1.5zm101.2 114.8c-1.6-.6-34.3-14.1-38.9-16.4a368 368 0 0 0 -17.5-7.5c12.3-19 20.1-33.4 21.2-35.6 1.9-4 15-29.5 15.3-31.1s.7-7.5.4-8.9-5.1 1.3-11.6 3.5-18.9 10.2-23.7 11.2-20.1 6.8-28 9.4c-7.8 2.6-22.7 7.1-28.8 8.8-6.1 1.6-11.4 1.8-14.9 2.8 0 0 .5 4.8 1.4 6.2s4.1 5 7.9 5.9c3.8 1 10 .6 12.8-.1s7.7-3.1 8.4-4.1c.7-1.1-.3-4.3.8-5.3s16.1-4.5 21.7-6.2 27.2-9.2 30.1-8.8a916 916 0 0 1 -23.9 47.7 821 821 0 0 1 -45 63.3c-5.3 6-18 21.5-22.4 25 1.1.3 9-.4 10.4-1.3 8.9-5.5 23.8-24.1 28.6-29.7a489.1 489.1 0 0 0 36.7-49.4c1.9.8 17.6 13.6 21.7 16.4a293 293 0 0 0 23.7 13.3c3.5 1.5 16.9 7.7 17.5 5.6.7-1.8-2.3-14.1-3.9-14.7z"></path><path clip-rule="evenodd" d="m194.1 484.7a204.9 204.9 0 0 0 30.7 14.5 233.6 233.6 0 0 0 46.4 12c.5 0 16 1.9 19.2 1.9h15.7c6.1-.5 11.8-.9 17.9-1.7 4.9-.7 10.3-1.6 15.5-2.8 3.8-.9 7.8-1.7 11.7-3 3.7-1 7.8-2.4 11.8-3.8l8.2-3.1c2.3-1 5.1-2.3 7.7-3.3a243 243 0 0 0 19.2-10c2.3-1.2 7.5-5.2 10.3-5.2 3.1 0 5.2 2.8 5.2 5.2 0 5.1-6.8 6.6-9.9 8.9-3.3 2.3-7.3 4-10.8 5.9-7 3.7-14.1 6.8-20.9 9.4a251 251 0 0 1 -27.3 8.5c-3.3.7-6.6 1.6-9.9 2.1-1.7.3-19.9 3.1-24.9 3.1h-23a293.9 293.9 0 0 1 -35.1-5.2 196 196 0 0 1 -33.1-10.3c-12-4.5-24.6-10.5-36.4-18.3-2.1-1.4-2.3-2.8-2.3-4.4a5 5 0 0 1 5.1-5.1c2.4.1 8 4.2 9 4.7zm101.4-98.1-189.9 63.2v-280.1l189.9-63.2zm10.6-288.3v292.7a6 6 0 0 1 -1.2 2.6c-.3.5-1 1.2-1.6 1.4a14621 14621 0 0 1 -203.1 67.6c-2.1 0-4-1.4-5.1-3.7 0-.2-.2-.3-.2-.7v-292.8c.3-.9.5-2.1 1.2-2.8 1.4-1.9 3.8-2.3 5.4-2.8 3-1 196.1-65.8 198.9-65.8 1.9 0 5.7 1.2 5.7 4.3z" fill-rule="evenodd"></path><path clip-rule="evenodd" d="m464.3 388-158-49.1v-236l158-53.7zm10.6-345.8v352.4c-.2 4-3 5.7-5.6 5.7-2.3 0-18.6-5.6-21.4-6.4l-65.8-20.4-14.6-4.7-12.9-4c-18.6-5.7-37.6-11.5-56.3-17.8-.7-.2-2.4-2.6-2.4-3.1v-246.1c.3-.9.7-1.9 1.6-2.6 1.4-1.6 61.1-21.4 84.7-29.3 6.3-2.3 84.8-29.3 87.3-29.3 3 .1 5.4 2.3 5.4 5.6z" fill-rule="evenodd"></path><path d="m515 461.8-211.1-67.3.9-292.8 210.2 66.9z"></path><path clip-rule="evenodd" d="m408.6 232.5-20.7 50.1 38.1 11.5zm-12.4-47.2 27.2 8.2 49.5 178.6-27.9-8.5-10-36.7-57.7-17.5-12.4 29.9-27.9-8.5z" fill="currentColor" fill-rule="evenodd"></path></svg><i aria-hidden="true" class="dropdown__arrow"></i></button><div class="dropdown__list "><ul><li><a href="https://webpack.js.org/blog/2020-12-08-roadmap-2021/" class="px-5 block"><span>English</span></a></li><li><a href="https://webpack.docschina.org/blog/2020-12-08-roadmap-2021/" class="px-5 block"><span lang="zh">中文</span></a></li><li><a href="https://webpack.kr/blog/2020-12-08-roadmap-2021/" class="px-5 block"><span lang="ko">한국어</span></a></li></ul></div></nav></nav><div class="inline-flex items-center ml-[18px]"><button aria-label="Switch to dark theme" class="bg-transparent border-none cursor-pointer text-[16px] p-0 inline-flex items-center text-gray-100 hover:text-blue-200 transition-colors duration-200" data-testid="hello-darkness"><svg width="16" height="16" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18.1406C11.6016 18.1406 11.2782 18.464 11.2782 18.8624V21.0281C11.2782 21.4265 11.6016 21.7499 12 21.7499C12.3985 21.7499 12.7219 21.4265 12.7219 21.0281V18.8624C12.7219 18.464 12.3985 18.1406 12 18.1406V18.1406Z" fill="currentColor"></path><path d="M12 2.25006C11.6016 2.25006 11.2782 2.5735 11.2782 2.97194V5.13756C11.2782 5.536 11.6016 5.85944 12 5.85944C12.3985 5.85944 12.7219 5.536 12.7219 5.13756V2.97194C12.7219 2.5735 12.3985 2.25006 12 2.25006V2.25006Z" fill="currentColor"></path><path d="M5.85936 12C5.85936 11.6015 5.53592 11.2781 5.13749 11.2781H2.97186C2.57342 11.2781 2.24999 11.6015 2.24999 12C2.24999 12.3984 2.57342 12.7218 2.97186 12.7218H5.13749C5.53592 12.7218 5.85936 12.3984 5.85936 12V12Z" fill="currentColor"></path><path d="M21.0281 11.2781H18.8625C18.4641 11.2781 18.1406 11.6015 18.1406 12C18.1406 12.3984 18.4641 12.7218 18.8625 12.7218H21.0281C21.4266 12.7218 21.75 12.3984 21.75 12C21.75 11.6015 21.4266 11.2781 21.0281 11.2781V11.2781Z" fill="currentColor"></path><path d="M7.14841 16.1298C6.95622 16.1298 6.77341 16.2048 6.63747 16.3407L5.10466 17.8735C4.96872 18.0094 4.89372 18.1923 4.89372 18.3844C4.89372 18.5766 4.96872 18.7594 5.10466 18.8954C5.2406 19.0313 5.42341 19.1063 5.6156 19.1063C5.80779 19.1063 5.9906 19.0313 6.12654 18.8954L7.65935 17.3626C7.9406 17.0813 7.9406 16.6219 7.65935 16.3407C7.52341 16.2048 7.3406 16.1298 7.14841 16.1298V16.1298Z" fill="currentColor"></path><path d="M16.8516 7.87036C17.0437 7.87036 17.2266 7.79536 17.3625 7.65942L18.8953 6.12661C19.0312 5.99067 19.1062 5.80786 19.1062 5.61567C19.1062 5.42349 19.0312 5.24067 18.8953 5.10474C18.7594 4.9688 18.5766 4.8938 18.3844 4.8938C18.1922 4.8938 18.0094 4.9688 17.8734 5.10474L16.3406 6.63755C16.2047 6.77349 16.1297 6.9563 16.1297 7.14849C16.1297 7.34067 16.2047 7.52349 16.3406 7.65942C16.4766 7.79536 16.6594 7.87036 16.8516 7.87036V7.87036Z" fill="currentColor"></path><path d="M6.12654 5.10474C5.9906 4.9688 5.80779 4.8938 5.6156 4.8938C5.42341 4.8938 5.2406 4.9688 5.10466 5.10474C4.96872 5.24067 4.89372 5.42349 4.89372 5.61567C4.89372 5.80786 4.96872 5.99067 5.10466 6.12661L6.63747 7.65942C6.77341 7.79536 6.95622 7.87036 7.14841 7.87036C7.3406 7.87036 7.52341 7.79536 7.65935 7.65942C7.79529 7.52349 7.87029 7.34067 7.87029 7.14849C7.87029 6.9563 7.79529 6.77349 7.65935 6.63755L6.12654 5.10474V5.10474Z" fill="currentColor"></path><path d="M17.3625 16.3407C17.2266 16.2048 17.0437 16.1298 16.8516 16.1298C16.6594 16.1298 16.4766 16.2048 16.3406 16.3407C16.0594 16.6219 16.0594 17.0813 16.3406 17.3626L17.8734 18.8954C18.0094 19.0313 18.1922 19.1063 18.3844 19.1063C18.5766 19.1063 18.7594 19.0313 18.8953 18.8954C19.0312 18.7594 19.1062 18.5766 19.1062 18.3844C19.1062 18.1923 19.0312 18.0094 18.8953 17.8735L17.3625 16.3407V16.3407Z" fill="currentColor"></path><path d="M12 7.5C9.52031 7.5 7.5 9.52031 7.5 12C7.5 14.4797 9.52031 16.5 12 16.5C14.4797 16.5 16.5 14.4797 16.5 12C16.5 9.52031 14.4797 7.5 12 7.5Z" fill="currentColor"></path></svg></button><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></header></div><div class="container site__content"><div class="sponsors"><a href="https://docschina.org" target="_blank" rel="noopener noreferrer" class="sponsors__content"><img class="sponsors__img__docschina" src="/docschina-logo.59f03f74b3c450856c01.png"/><div class="sponsors__content-cont">翻译/文档内容有任何问题，请联系我们</div><div class="wwads-cn wwads-horizontal wwads-sticky" data-id="306" style="max-width:350px"></div></a></div><nav class="sidebar site__sidebar"><div class="sidebar__inner"><div class="relative z-0 bg-white dark:bg-gray-100 "><select class="text-gray-600 text-14 px-5 py-5 appearance-none box-border border border-gray-200 border-solid flex-col flex w-full rounded-none bg-transparent bg-none"><option selected="" value="5">Webpack 5</option><option value="4">Webpack 4</option></select><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="absolute right-5 top-5 fill-current text-gray-300 z-[-1]" width="20" height="20"><path d="M4.5 7.5c.5-.4 1-.4 1.6 0l3.9 3.8 4-3.8c.4-.4 1-.4 1.5 0 .4.5.4 1.2 0 1.7l-4.7 4.5a1 1 0 0 1-1.6 0L4.5 9.2c-.4-.5-.4-1.2 0-1.7z"></path></svg></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="m9.2 4.5 4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0"></path></svg><a class="sidebar-item__title" href="/blog/">Blog</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="热门文章 "><a aria-current="page" class="active" href="/blog/#popular-posts">热门文章 </a></li></ul></div></div><div><div class="sidebar-item sidebar-item--open "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="m9.2 4.5 4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0"></path></svg><a aria-current="page" class="sidebar-item__title active" href="/blog/2020-12-08-roadmap-2021/">Roadmap 2021 (2020-12-08)</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="从发布至今有哪些变化？ "><a aria-current="page" class="active" href="/blog/2020-12-08-roadmap-2021/#what-happened-so-far">从发布至今有哪些变化？ </a></li><li class="sidebar-item__anchor" title="Roadmap 2021 "><a aria-current="page" class="active" href="/blog/2020-12-08-roadmap-2021/#roadmap-2021">Roadmap 2021 </a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="进一步稳定 "><a aria-current="page" class="active" href="/blog/2020-12-08-roadmap-2021/#further-stabilizing">进一步稳定 </a></li><li class="sidebar-item__anchor" title="EcmaScript Modules "><a aria-current="page" class="active" href="/blog/2020-12-08-roadmap-2021/#ecmascript-modules">EcmaScript Modules </a></li><li class="sidebar-item__anchor" title="更多一等公民 "><a aria-current="page" class="active" href="/blog/2020-12-08-roadmap-2021/#more-first-class-citizen">更多一等公民 </a></li><li class="sidebar-item__anchor" title="SourceMap 性能优化 "><a aria-current="page" class="active" href="/blog/2020-12-08-roadmap-2021/#sourcemap-performance">SourceMap 性能优化 </a></li><li class="sidebar-item__anchor" title="exports/imports package.json field "><a aria-current="page" class="active" href="/blog/2020-12-08-roadmap-2021/#exports-imports-package-json-field">exports/imports package.json field </a></li><li class="sidebar-item__anchor" title="完善 CommonJS 分析 "><a aria-current="page" class="active" href="/blog/2020-12-08-roadmap-2021/#improve-commonjs-analysis">完善 CommonJS 分析 </a></li><li class="sidebar-item__anchor" title="模块联邦（Module Federation）的 HMR "><a aria-current="page" class="active" href="/blog/2020-12-08-roadmap-2021/#hot-module-replacement-for-module-federation">模块联邦（Module Federation）的 HMR </a></li><li class="sidebar-item__anchor" title="提示系统 "><a aria-current="page" class="active" href="/blog/2020-12-08-roadmap-2021/#hinting-system">提示系统 </a></li><li class="sidebar-item__anchor" title="多线程 "><a aria-current="page" class="active" href="/blog/2020-12-08-roadmap-2021/#multi-threading">多线程 </a></li><li class="sidebar-item__anchor" title="WebAssembly "><a aria-current="page" class="active" href="/blog/2020-12-08-roadmap-2021/#webassembly">WebAssembly </a></li></ul></li><li class="sidebar-item__anchor" title="免责声明 "><a aria-current="page" class="active" href="/blog/2020-12-08-roadmap-2021/#disclaimer">免责声明 </a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="m9.2 4.5 4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0"></path></svg><a class="sidebar-item__title" href="/blog/2020-10-10-webpack-5-release/">Webpack 5 发布 (2020-10-10)</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="疑问解答 "><a class="" href="/blog/2020-10-10-webpack-5-release/#common-questions">疑问解答 </a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="那么发布意味着什么呢？ "><a class="" href="/blog/2020-10-10-webpack-5-release/#so-what-does-the-release-mean">那么发布意味着什么呢？ </a></li><li class="sidebar-item__anchor" title="那么什么时候是升级的时候呢？ "><a class="" href="/blog/2020-10-10-webpack-5-release/#so-when-is-the-time-to-upgrade">那么什么时候是升级的时候呢？ </a></li></ul></li><li class="sidebar-item__anchor" title="赞助情况 "><a class="" href="/blog/2020-10-10-webpack-5-release/#sponsoring-update">赞助情况 </a></li><li class="sidebar-item__anchor" title="整体方向 "><a class="" href="/blog/2020-10-10-webpack-5-release/#general-direction">整体方向 </a></li><li class="sidebar-item__anchor" title="迁移指南 "><a class="" href="/blog/2020-10-10-webpack-5-release/#migration-guide">迁移指南 </a></li><li class="sidebar-item__anchor" title="重大变更: 功能清除 "><a class="" href="/blog/2020-10-10-webpack-5-release/#major-changes-removals">重大变更: 功能清除 </a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="清理弃用的能力 "><a class="" href="/blog/2020-10-10-webpack-5-release/#removed-deprecated-items">清理弃用的能力 </a></li><li class="sidebar-item__anchor" title="废弃代码 "><a class="" href="/blog/2020-10-10-webpack-5-release/#deprecation-codes">废弃代码 </a></li><li class="sidebar-item__anchor" title="语法废弃 "><a class="" href="/blog/2020-10-10-webpack-5-release/#syntax-deprecated">语法废弃 </a></li><li class="sidebar-item__anchor" title="不再为 Node.js 模块 自动引用 Polyfills "><a class="" href="/blog/2020-10-10-webpack-5-release/#automatic-nodejs-polyfills-removed">不再为 Node.js 模块 自动引用 Polyfills </a></li></ul></li><li class="sidebar-item__anchor" title="重大变更：长期缓存 "><a class="" href="/blog/2020-10-10-webpack-5-release/#major-changes-long-term-caching">重大变更：长期缓存 </a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="确定的 Chunk、模块 ID 和导出名称 "><a class="" href="/blog/2020-10-10-webpack-5-release/#deterministic-chunk-module-ids-and-export-names">确定的 Chunk、模块 ID 和导出名称 </a></li><li class="sidebar-item__anchor" title="真正的内容哈希 "><a class="" href="/blog/2020-10-10-webpack-5-release/#real-content-hash">真正的内容哈希 </a></li></ul></li><li class="sidebar-item__anchor" title="重大变更：开发支持 "><a class="" href="/blog/2020-10-10-webpack-5-release/#major-changes-development-support">重大变更：开发支持 </a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="命名代码块 ID "><a class="" href="/blog/2020-10-10-webpack-5-release/#named-chunk-ids">命名代码块 ID </a></li><li class="sidebar-item__anchor" title="模块联邦 "><a class="" href="/blog/2020-10-10-webpack-5-release/#module-federation">模块联邦 </a></li></ul></li><li class="sidebar-item__anchor" title="重大变更：支持崭新的 Web 平台特性 "><a class="" href="/blog/2020-10-10-webpack-5-release/#major-changes-new-web-platform-features">重大变更：支持崭新的 Web 平台特性 </a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="JSON 模块 "><a class="" href="/blog/2020-10-10-webpack-5-release/#json-modules">JSON 模块 </a></li><li class="sidebar-item__anchor" title="import.meta "><a class="" href="/blog/2020-10-10-webpack-5-release/#importmeta">import.meta </a></li><li class="sidebar-item__anchor" title="资源模块 "><a class="" href="/blog/2020-10-10-webpack-5-release/#asset-modules">资源模块 </a></li><li class="sidebar-item__anchor" title="原生 Worker 支持 "><a class="" href="/blog/2020-10-10-webpack-5-release/#native-worker-support">原生 Worker 支持 </a></li><li class="sidebar-item__anchor" title="URIs "><a class="" href="/blog/2020-10-10-webpack-5-release/#uris">URIs </a></li><li class="sidebar-item__anchor" title="异步模块 "><a class="" href="/blog/2020-10-10-webpack-5-release/#async-modules">异步模块 </a></li><li class="sidebar-item__anchor" title="外部资源 "><a class="" href="/blog/2020-10-10-webpack-5-release/#externals">外部资源 </a></li></ul></li><li class="sidebar-item__anchor" title="重大变更：支持全新的 Node.js 生态特性 "><a class="" href="/blog/2020-10-10-webpack-5-release/#major-changes-new-nodejs-ecosystem-features">重大变更：支持全新的 Node.js 生态特性 </a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="解析 "><a class="" href="/blog/2020-10-10-webpack-5-release/#resolving">解析 </a></li></ul></li><li class="sidebar-item__anchor" title="重大变更：开发体验 "><a class="" href="/blog/2020-10-10-webpack-5-release/#major-changes-development-experience">重大变更：开发体验 </a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="经过优化的构建目标(target) "><a class="" href="/blog/2020-10-10-webpack-5-release/#improved-target">经过优化的构建目标(target) </a></li><li class="sidebar-item__anchor" title="Stats "><a class="" href="/blog/2020-10-10-webpack-5-release/#stats">Stats </a></li><li class="sidebar-item__anchor" title="进度 "><a class="" href="/blog/2020-10-10-webpack-5-release/#progress">进度 </a></li><li class="sidebar-item__anchor" title="自动添加唯一命名 "><a class="" href="/blog/2020-10-10-webpack-5-release/#automatic-unique-naming">自动添加唯一命名 </a></li><li class="sidebar-item__anchor" title="自动添加公共路径 "><a class="" href="/blog/2020-10-10-webpack-5-release/#automatic-public-path">自动添加公共路径 </a></li><li class="sidebar-item__anchor" title="Typescript 类型 "><a class="" href="/blog/2020-10-10-webpack-5-release/#typescript-typings">Typescript 类型 </a></li></ul></li><li class="sidebar-item__anchor" title="重大变更: 构建优化 "><a class="" href="/blog/2020-10-10-webpack-5-release/#major-changes-optimization">重大变更: 构建优化 </a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="嵌套的 tree-shaking "><a class="" href="/blog/2020-10-10-webpack-5-release/#nested-tree-shaking">嵌套的 tree-shaking </a></li><li class="sidebar-item__anchor" title="内部模块 tree-shaking "><a class="" href="/blog/2020-10-10-webpack-5-release/#inner-module-tree-shaking">内部模块 tree-shaking </a></li><li class="sidebar-item__anchor" title="CommonJs Tree Shaking "><a class="" href="/blog/2020-10-10-webpack-5-release/#commonjs-tree-shaking">CommonJs Tree Shaking </a></li><li class="sidebar-item__anchor" title="副作用分析 "><a class="" href="/blog/2020-10-10-webpack-5-release/#side-effect-analysis">副作用分析 </a></li><li class="sidebar-item__anchor" title="每个运行时的优化 "><a class="" href="/blog/2020-10-10-webpack-5-release/#optimization-per-runtime">每个运行时的优化 </a></li><li class="sidebar-item__anchor" title="模块合并 "><a class="" href="/blog/2020-10-10-webpack-5-release/#module-concatenation">模块合并 </a></li><li class="sidebar-item__anchor" title="通用 Tree Shaking 改进 "><a class="" href="/blog/2020-10-10-webpack-5-release/#general-tree-shaking-improvements">通用 Tree Shaking 改进 </a></li><li class="sidebar-item__anchor" title="开发与生产的一致性问题 "><a class="" href="/blog/2020-10-10-webpack-5-release/#development-production-similarity">开发与生产的一致性问题 </a></li><li class="sidebar-item__anchor" title="改进代码生成 "><a class="" href="/blog/2020-10-10-webpack-5-release/#improved-code-generation">改进代码生成 </a></li><li class="sidebar-item__anchor" title="改进 target 配置 "><a class="" href="/blog/2020-10-10-webpack-5-release/#improved-target-option">改进 target 配置 </a></li><li class="sidebar-item__anchor" title="代码块拆分与模块大小 "><a class="" href="/blog/2020-10-10-webpack-5-release/#splitchunks-and-module-sizes">代码块拆分与模块大小 </a></li></ul></li><li class="sidebar-item__anchor" title="重大变更：性能优化 "><a class="" href="/blog/2020-10-10-webpack-5-release/#major-changes-performance">重大变更：性能优化 </a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="持久缓存 "><a class="" href="/blog/2020-10-10-webpack-5-release/#persistent-caching">持久缓存 </a></li><li class="sidebar-item__anchor" title="编译器闲置和关闭 "><a class="" href="/blog/2020-10-10-webpack-5-release/#compiler-idle-and-close">编译器闲置和关闭 </a></li><li class="sidebar-item__anchor" title="文件生成 "><a class="" href="/blog/2020-10-10-webpack-5-release/#file-emitting">文件生成 </a></li></ul></li><li class="sidebar-item__anchor" title="重大变更：长期未解决的问题 "><a class="" href="/blog/2020-10-10-webpack-5-release/#major-changes-long-outstanding-problems">重大变更：长期未解决的问题 </a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="单一文件目标的代码分离 "><a class="" href="/blog/2020-10-10-webpack-5-release/#code-splitting-for-single-file-targets">单一文件目标的代码分离 </a></li><li class="sidebar-item__anchor" title="更新了解析器 "><a class="" href="/blog/2020-10-10-webpack-5-release/#updated-resolver">更新了解析器 </a></li><li class="sidebar-item__anchor" title="没有 JS 的代码块 "><a class="" href="/blog/2020-10-10-webpack-5-release/#chunks-without-js">没有 JS 的代码块 </a></li></ul></li><li class="sidebar-item__anchor" title="重大变更：未来计划 "><a class="" href="/blog/2020-10-10-webpack-5-release/#major-changes-future">重大变更：未来计划 </a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="实验特性 "><a class="" href="/blog/2020-10-10-webpack-5-release/#experiments">实验特性 </a></li><li class="sidebar-item__anchor" title="最小 Node.js 版本 "><a class="" href="/blog/2020-10-10-webpack-5-release/#minimum-nodejs-version">最小 Node.js 版本 </a></li></ul></li><li class="sidebar-item__anchor" title="配置变更 "><a class="" href="/blog/2020-10-10-webpack-5-release/#changes-to-the-configuration">配置变更 </a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="结构的变化 "><a class="" href="/blog/2020-10-10-webpack-5-release/#changes-to-the-structure">结构的变化 </a></li><li class="sidebar-item__anchor" title="默认值变更 "><a class="" href="/blog/2020-10-10-webpack-5-release/#changes-to-the-defaults">默认值变更 </a></li></ul></li><li class="sidebar-item__anchor" title="加载器相关变更 "><a class="" href="/blog/2020-10-10-webpack-5-release/#loader-related-changes">加载器相关变更 </a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="this.getOptions "><a class="" href="/blog/2020-10-10-webpack-5-release/#thisgetoptions">this.getOptions </a></li><li class="sidebar-item__anchor" title="this.exec "><a class="" href="/blog/2020-10-10-webpack-5-release/#thisexec">this.exec </a></li><li class="sidebar-item__anchor" title="this.getResolve "><a class="" href="/blog/2020-10-10-webpack-5-release/#thisgetresolve">this.getResolve </a></li></ul></li><li class="sidebar-item__anchor" title="重大内部变更 "><a class="" href="/blog/2020-10-10-webpack-5-release/#major-internal-changes">重大内部变更 </a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="新的插件运行顺序 "><a class="" href="/blog/2020-10-10-webpack-5-release/#new-plugin-order">新的插件运行顺序 </a></li><li class="sidebar-item__anchor" title="运行时模块 "><a class="" href="/blog/2020-10-10-webpack-5-release/#runtime-modules">运行时模块 </a></li><li class="sidebar-item__anchor" title="序列化 "><a class="" href="/blog/2020-10-10-webpack-5-release/#serialization">序列化 </a></li><li class="sidebar-item__anchor" title="用于缓存的插件 "><a class="" href="/blog/2020-10-10-webpack-5-release/#plugins-for-caching">用于缓存的插件 </a></li><li class="sidebar-item__anchor" title="冻结钩子对象 "><a class="" href="/blog/2020-10-10-webpack-5-release/#hook-object-frozen">冻结钩子对象 </a></li><li class="sidebar-item__anchor" title="Tapable 插件升级 "><a class="" href="/blog/2020-10-10-webpack-5-release/#tapable-upgrade">Tapable 插件升级 </a></li><li class="sidebar-item__anchor" title="Stage 钩子 "><a class="" href="/blog/2020-10-10-webpack-5-release/#staged-hooks">Stage 钩子 </a></li><li class="sidebar-item__anchor" title="Main/Chunk/ModuleTemplate 废弃 "><a class="" href="/blog/2020-10-10-webpack-5-release/#mainchunkmoduletemplate-deprecation">Main/Chunk/ModuleTemplate 废弃 </a></li><li class="sidebar-item__anchor" title="入口文件描述符 "><a class="" href="/blog/2020-10-10-webpack-5-release/#entry-point-descriptor">入口文件描述符 </a></li><li class="sidebar-item__anchor" title="排序与 ID "><a class="" href="/blog/2020-10-10-webpack-5-release/#order-and-ids">排序与 ID </a></li><li class="sidebar-item__anchor" title="从数组到集合(Set) "><a class="" href="/blog/2020-10-10-webpack-5-release/#arrays-to-sets">从数组到集合(Set) </a></li><li class="sidebar-item__anchor" title="Compilation.fileSystemInfo "><a class="" href="/blog/2020-10-10-webpack-5-release/#compilationfilesysteminfo">Compilation.fileSystemInfo </a></li><li class="sidebar-item__anchor" title="Filesystems "><a class="" href="/blog/2020-10-10-webpack-5-release/#filesystems">Filesystems </a></li><li class="sidebar-item__anchor" title="模块热替换 "><a class="" href="/blog/2020-10-10-webpack-5-release/#hot-module-replacement">模块热替换 </a></li><li class="sidebar-item__anchor" title="工作队列 "><a class="" href="/blog/2020-10-10-webpack-5-release/#work-queues">工作队列 </a></li><li class="sidebar-item__anchor" title="Logging "><a class="" href="/blog/2020-10-10-webpack-5-release/#logging">Logging </a></li><li class="sidebar-item__anchor" title="模块和 chunk 图 "><a class="" href="/blog/2020-10-10-webpack-5-release/#module-and-chunk-graph">模块和 chunk 图 </a></li><li class="sidebar-item__anchor" title="Init Fragments "><a class="" href="/blog/2020-10-10-webpack-5-release/#init-fragments">Init Fragments </a></li><li class="sidebar-item__anchor" title="模块 Source Types "><a class="" href="/blog/2020-10-10-webpack-5-release/#module-source-types">模块 Source Types </a></li><li class="sidebar-item__anchor" title="Stats 的插件 "><a class="" href="/blog/2020-10-10-webpack-5-release/#plugins-for-stats">Stats 的插件 </a></li><li class="sidebar-item__anchor" title="全新的监听 "><a class="" href="/blog/2020-10-10-webpack-5-release/#new-watching">全新的监听 </a></li><li class="sidebar-item__anchor" title="SizeOnlySource after emit "><a class="" href="/blog/2020-10-10-webpack-5-release/#sizeonlysource-after-emit">SizeOnlySource after emit </a></li><li class="sidebar-item__anchor" title="Emitting assets multiple times "><a class="" href="/blog/2020-10-10-webpack-5-release/#emitting-assets-multiple-times">Emitting assets multiple times </a></li><li class="sidebar-item__anchor" title="ExportsInfo "><a class="" href="/blog/2020-10-10-webpack-5-release/#exportsinfo">ExportsInfo </a></li><li class="sidebar-item__anchor" title="代码生成阶段 "><a class="" href="/blog/2020-10-10-webpack-5-release/#code-generation-phase">代码生成阶段 </a></li><li class="sidebar-item__anchor" title="依赖关系参考 "><a class="" href="/blog/2020-10-10-webpack-5-release/#dependencyreference">依赖关系参考 </a></li><li class="sidebar-item__anchor" title="Presentational Dependencies "><a class="" href="/blog/2020-10-10-webpack-5-release/#presentational-dependencies">Presentational Dependencies </a></li><li class="sidebar-item__anchor" title="弃用 loaders "><a class="" href="/blog/2020-10-10-webpack-5-release/#deprecated-loaders">弃用 loaders </a></li></ul></li><li class="sidebar-item__anchor" title="微小改动 "><a class="" href="/blog/2020-10-10-webpack-5-release/#minor-changes">微小改动 </a></li><li class="sidebar-item__anchor" title="其他微小改动 "><a class="" href="/blog/2020-10-10-webpack-5-release/#other-minor-changes">其他微小改动 </a></li></ul></div></div></div></nav><section class="page"><div class="markdown"><h1>Roadmap 2021 (2020-12-08)</h1><div id="md-content"><p>webpack 5 正式发布已有两月之久。由于赞助方面出了些小状况，我们不能再像之前那样花费很多时间在 webpack 上面了。我（@sokra）个人休息了一段时间，并在这期间做了一些兼职项目。极具讽刺的是，当我在使用 webpack 5 及其所有前沿特性（asset modules，支持 worker，持久化缓存）时，我又发现了 webpack 5 中的一些 bug，而这些 bug 是大家将自己项目升级至 webpack 5 时可能会遇到的，因此，大量时间被用于修复这些 bug。以下是关于这些 bug 的小结：</p><h2><span id="what-happened-so-far"></span>从发布至今有哪些变化？<a href="#what-happened-so-far" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>webpack 中又暴露了一些东西，其中包括类型及运行时相关的内容。同时，我们对一些处理性能低效的代码进行了改进。没有分号的代码曾在某些情况下生成一些无效/错误的代码，这一点也得到了修复。无副作用（side-effect-free）的代码 + 串连模块（concatenated modules）+ 重导出的组合时，会出现意料之外的情况，这一点也已修复（至少是已知的）。</p><p>但是用户报告的 bug 可能也会在 webpack 内部产生全新的特性。如果你对 webpack 内部的特性不感兴趣或者认为它太复杂，可以直接跳过此部分，进入下一章节。</p><p>要复现上述 bug，需了解：</p><ul><li>从 webpack 5 开始，针对 <code>production</code> 模式进行了优化，此优化将对每个运行时（通常与入口相同）使用 exports 分析（Tree Shaking），这意味着 webpack 可以单独优化每个运行时（或入口）。</li><li>自定义的 <code>optimization.splitChunks</code> 配置允许将模块强行合并成一个 chunk。这可以通过传递 <code>name</code> 选项来实现。例如 <code>{ test: /node_modules/, name: &quot;vendors&quot; }</code>，会将 <code>node_modules</code> 中的模块合并到一个 chunk 中。虽然通常情况下并不推荐如此做，但这是可以的，并且在某些情况下可能是合理的。事物都有两面性，做好取舍即可。选择将所有的 vendor 合并到一个 chunk 中，可以很好的缓存这个 chunk，这将有利于在重复访问时或多个入口访问时。</li><li>当未使用导出的无副作用模块时，整个模块会从模块图中省略，<code>import</code> 语句根本不会产生运行时代码。</li></ul><p>当两个入口的模块被合并到一个 chunk 中，并且它们又引用了一个不在共享 chunk 中的无副作用模块时，就会出现问题，因为只有入口使用了无副作用的导出。共享 chunk 中的模块被两个入口同时使用，因此，chunk 中需要引入任何一个入口中使用的导出。
这意味着，它会在上述情况下，生成引用无副作用模块的代码，而在运行时，且另一个入口不可用的情况下，这就会导致运行时代码出现 <code>undefined is not a function</code> 或 <code>cannot read property &#x27;call&#x27; of undefined</code> 的错误。</p><p>一个简单的修复方式是，在所有的入口中加入无副作用的模块，但是有时并不真正需要这个模块，这就会造成对 bundle 大小的浪费。
所以我们另辟蹊径，那就是开发一个全新的特性：<code>runtime-dependent code generation</code>，即依赖运行时的代码生成。
此特性会根据运行时的不同而产生表现不同的代码。</p><p>换句话说，我们会将生成的代码封装在 <code>if</code> 块中，所以它们只会在一个运行时执行。
在这个示例中，会影响到引用无副作用模块的 <code>import</code> 语句。
只会对其中一个入口执行 import。
如此就会避免引入不必要的模块，也避免了执行不必要的代码，即使它是可用。
因此，即使你把所有代码合并成一个 chunk，也只执行真正使用的代码。</p><p>到此为止，对于这次 bug 修复的体验，希望不会让你感到无聊...</p><h2><span id="roadmap-2021"></span>Roadmap 2021<a href="#roadmap-2021" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>因此，假设我们的赞助一切正常，以下为 2021 年的开发计划：</p><h3><span id="further-stabilizing"></span>进一步稳定<a href="#further-stabilizing" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>我们的首要任务是稳定 webpack 5。
目前来说，情况还不错。
上次报告的大部分重大 bug，影响了一些特殊场景。
因此，我觉得 webpack 5 在一般场景下完全能胜任。
但处理特殊场景是 webpack 的强项之一（应该继续保持），所以我们要继续努力修复这些问题。
我们认为，很多 webpack 用户需要通过自定义内容来进行构建，而这正是 webpack 的可配置性和丰富的插件系统所提供的。</p><h3><span id="ecmascript-modules"></span>EcmaScript Modules<a href="#ecmascript-modules" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>EcmaScript 模块（ESM）正在慢慢得到广泛的应用。
在开发时，它们已然成为编写代码的首选标准。
对于浏览器的支持，目前也表现良好（除了 IE11 和一些老的手机浏览器）。
但浏览器在支持 WebWorkers 的 ESM 方面还有所欠缺。</p><p>也可以生成在 <code>type=module</code> 的 script 标签中运行的 bundle 文件，但目前来说这样的意义不大。</p><p>在 webpack 中，有许多地方可以改进对 ESM 的支持：</p><h4><span id="esm-as-chunk-loading-mechanism"></span>ESM 作为 chunk 加载机制<a href="#esm-as-chunk-loading-mechanism" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4><p>当目标环境为 web 时，webpack 通过 <code>script</code> 标签加载 chunk。
当目标环境为 node.js 时，webpack 通过 <code>require</code> 或 <code>fs</code> + <code>vm</code> 的方式加载 chunk。
当目标环境为 WebWorkers 时，webpack 通过 <code>importScripts</code> 的方式加载 chunk。</p><p>在不远的将来，这些环境都会支持 ESM，更重要的是会支持动态的 <code>import()</code> 函数。
因此，基于 <code>import()</code> 的 chunk 加载机制可以一统所有环境，同时可能只需更少的运行时代码。</p><h4><span id="self-executed-chunks"></span>自执行的 chunk<a href="#self-executed-chunks" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4><p>目前 webpack 中按需加载的 chunk 总是模块的容器，从不直接执行模块代码。
当在模块中编写 <code>import(&quot;./module&quot;)</code> 时，会被编译成 <code>__webpack_load_chunk__(&quot;chunk-containing-module.js&quot;).then(() =&gt; __webpack_require__(&quot;./module&quot;))</code>。
在大部分情况下不会变好（比如加载多个 chunk 或者加载 css 时），但有些情况下，webpack 可以生成一个 chunk，并且直接执行 chunk 中所包含的模块。
这样可以减少生成的代码，同时可以避免函数在 chunk 中被包装。</p><p>目前是否值得还尚未可知，但至少值得研究一下。</p><h4><span id="esm-exports"></span>ESM exports<a href="#esm-exports" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4><p>目前不可能通过设置 <code>output.library.type: &quot;module&quot;</code>，为一个 bundle 生成 ESM export。
这将在 webpack 的 bundle 集成到 ESM 加载环境或内联 script 中时非常有效。</p><aside class="tip"><h6 class="tip__prefix">提示</h6><p>webpack 4 时，其实有一个插件可以实现该效果，但是最好还是原生支持。</p></aside><h4><span id="esm-externals-import"></span>ESM externals (import)<a href="#esm-externals-import" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4><p>webpack 运行定义 <code>externals</code> 模块，这些模块并不存在在 bundle 中，而是运行时才加载。
有许多类型的外部资源，从 CommonJS/AMD/System 的全局加载再到经典的 script 标签加载。
甚至 <code>import()</code> (<code>type: &quot;import&quot;</code>) 也可以加载外部模块，但是 <code>import</code> (<code>type: &quot;module&quot;</code>) 还不能使用。</p><p>有趣的是，尽管 <code>type: &quot;module&quot;</code> 还未被支持，但是 webpack 在编写 <code>import x from &quot;https://example.com/module.js&quot;</code> 时，已经将其设为了默认值。
此默认值会无缝添加对 ESM 外部模块的支持，并不会引入破坏性更改。</p><p><code>import</code> 中使用绝对路径的 URL 是有意义的，例如，当使用提供其 API 的外部服务作为 ESM 时：<code>import { event } from &quot;https://analytics.company.com/api/v1.js&quot;</code>（<code>import(&quot;https://analytics.company.com/api/v1.js&quot;)</code> 可能会更有意义，当依赖这个外部服务时，优雅地处理错误，但错误也会出现在模块图当中）。</p><p>像以往一样，<code>externals</code> 配置运行将任何模块名映射到 externals：</p><pre><code class="hljs language-js"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  externalsType<span class="token operator">:</span> <span class="token string">&#x27;module&#x27;</span><span class="token punctuation">,</span>
  externals<span class="token operator">:</span> <span class="token punctuation">{</span>
    analytics<span class="token operator">:</span> <span class="token string">&#x27;https://analytics.company.com/api/v1.js&#x27;</span><span class="token punctuation">,</span>
    svelte<span class="token operator">:</span> <span class="token string">&#x27;https://jspm.dev/svelte@3&#x27;</span><span class="token punctuation">,</span>
    react<span class="token operator">:</span> <span class="token string">&#x27;https://cdn.skypack.dev/preact@10&#x27;</span><span class="token punctuation">,</span>
    <span class="token string">&#x27;react-dom&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;https://esm.sh/[react,react-dom]/react-dom&#x27;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><aside class="warning"><h6 class="warning__prefix">警告</h6><p>使用多个不同的 ESM CDN 将无法工作。这里只是个示例。</p></aside><h4><span id="esm-library"></span>ESM library<a href="#esm-library" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4><p>当支持 ESM 的 export 和 import 时，开发者可能会认为构建一个 library 是有意义的，在某些情况下可能如此，但是在大部分情况下，原生 bundle 会导致更糟糕的结果。
其中最大的问题是，<code>&quot;sideEffects&quot;: false</code> 的 flag。它会影响每个文件的模块，从而跳过整个模块。当连接多个无副作用模块时，不再支持跳过各个模块，当没有使用所有库的出口时，会导致优化效果变差。</p><p>当 output 的应该是一个稍后将被 bundler 处理的库时，需要考虑此问题。</p><p>我可以想到一种特殊的模式，它不使用分块，而是通过 ESM 的 import 和 export（或者 CommonJS 的 <code>require</code>）触发原始（处理过的）的模块连接。
所以，这意味着 loader、模块图和资产会优化运行，但是不会创建 chunk 图，模块图中的每个模块会作为单独的文件发出（emit）。</p><h4><span id="strict-mode-warnings"></span>严格模式警告<a href="#strict-mode-warnings" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4><p>当生成 ESM bundle 包时，其中所有的代码都会被强制转为严格模式。
这对许多模块来说，问题不大。但是有些旧的 package 可能会在不同语义下出现问题。
我们需对这些情况发出警告。</p><h3><span id="more-first-class-citizen"></span>更多一等公民<a href="#more-first-class-citizen" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>Webpack 4 和 5 在支持非 JS 模块方面做了很多工作，webpack 5 已默认支持了一部分模块类型：JS (ESM/CJS/AMD)，JSON，WebAssembly，Asset。
从 webpack 5 开始，我们的长期目标之一就是成为一个 web 应用优化器，目标是支持所有浏览器支持的东西。
所以，从技术上讲，一个 vanilla web 应用应该可以做到使用 webpack 开箱即用，但此功能正在进行优化。</p><p>最初的 webpack 5 版本已经在这个方向上采取了重大更新：原生支持了 <code>new Worker</code>。原生支持了 <code>new URL(...)</code>。</p><p>WebAssembly 和 JSON 已被支持，即使提案还未完成。</p><p>但完整的情况还缺少两种资源类型：HTML 和 CSS。</p><h4><span id="css-as-modules"></span>CSS 作为模块<a href="#css-as-modules" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4><p>目前 webpack 通过 <code>css-loader</code>，<code>style-loader</code> 或者 <code>mini-css-extract-plugin</code> 来支持 CSS。
这很实用，但我认为我们可以通过在 webpack 中支持 CSS 来为原生模块类型做更多事情。</p><p>如此做会提高开发者的体验：<code>mini-css-extract-plugin</code> 的配置并不是最简单的，去掉它可以为开发者简化很多操作。
这并不意味着你可以在此基础上增加额外的定制。
我看到许多开发者并没有使用原生 CSS，而是在 CSS 基础上使用了预处理器（如果有对原生 CSS 的支持，配置大概会变成：<code>{ test: /\.sass$/, type: &quot;stylesheet&quot;, use: &quot;sass-loader&quot; }</code>）。</p><p>从 <a href="https://2020.stateofcss.com/en-US/technologies/css-in-js/">State of CSS 2020</a> 可以看出，CSS Modules 逐渐变为一种流行的模块化 CSS 编写方式，作为 webpack 中的原生模块类型，它可以从模块图中获益，比如 Tree Shaking（使用 export 优化和副作用优化）。当使用 CSS 模块时，这意味着生成 CSS 将只包含从应用程序中引用的 CSS（就像大家习惯在 JS 中使用 Tree Shaking 一样）。</p><p>有些潜在的 CSS 模块可以通过 webpack 的实现特定的优化：CSS 规则可以被分割为更小粒度，以避免出现重复的公共属性。由于输出的 CSS 包含较少的重复属性（原子级别的 CSS），因此，可以使 payload 更小。</p><p>但是，在 WebComponents 社区中，有一个不同的 &quot;CSS Modules&quot; 提案，计划会被浏览器原生所支持。
遗憾的是，这个提案与目前前端生态中使用的方案不同，但使用了类似的语法。
通常，webpack 会和提案保持一致，因此，这里需要斟酌一下。
我们必须考虑是否可以避免潜在的冲突。</p><h4><span id="html-as-entrypoint"></span>HTML 作为入口<a href="#html-as-entrypoint" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4><p>灵感来源于 Parcels 的例子，我们也希望支持 HTML 的原生入口。
要支持这一点，会与 webpack 成为 web 应用优化器的目标不谋而合，因为一切 web 应用的异常都是从 HTML 开始的。
对于初学者来说，这也是开发体验质的提升，因为很多东西都可以从 HTML 中推断出来。</p><p>控制生成的 HTML 也会在默认情况下进行更适合的优化。
目前，默认情况下，我们禁止重命名和拆分初始 chink，因为这需要额外的基建来生成 HTML。</p><p>HTML 入口也将受益于 CSS 模块和 Asset 模块，因为这些资源也可以在 HTML 中引用（例如 <code>&lt;link rel=stylesheet /&gt;</code>，<code>&lt;img src=&quot;...&quot; /&gt;</code>，<code>&lt;link rel=icon /&gt;</code>）。</p><h4><span id="html-modules"></span>HTML 模块<a href="#html-modules" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4><p>还有一个提案，就是关于在浏览器中原生支持引入 HTML，此提案我们会同步跟进，这与 HTML 作为入口的想法不谋而合。</p><h3><span id="sourcemap-performance"></span>SourceMap 性能优化<a href="#sourcemap-performance" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>在 webpack 中使用（完整的） SourceMaps，成本略高，因为 SourceMap 处理的性能并不是最好的。
这点我们要为 webpack 做对应优化，同时也要为 terser 优化，因为 webpack 默认将其作为 minimizer 的。</p><h3><span id="exports-imports-package-json-field"></span><code>exports</code>/<code>imports</code> package.json field<a href="#exports-imports-package-json-field" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>Node.js 14 增加了对 package.json 中 <code>exports</code> 字段的支持，允许定义一个 package 的入口。
Webpack 5 也遵循了这一点，甚至增加了额外的字段，例如 <code>production/development</code>。</p><p>不久后，Node.js 又在此基础上做了进一步的补充，例如，他们为私有 import 增加了 <code>imports</code> 字段。</p><p>这一点我们也想跟进。</p><h3><span id="improve-commonjs-analysis"></span>完善 CommonJS 分析<a href="#improve-commonjs-analysis" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>尽管未来 ESM 是趋势，但在 npm 中仍然有很多 CommonJS 的 package 在使用。
Webpack 5 增加了对 CommonJS 模块的分享，使得这些模块大部分都能实现 Tree Shaking。</p><p>但是我们可以做的更多。虽然支持了许多 export 模式，但仅支持了少数几个 import 模式。
我们希望增加对更多模式的支持，让 CommonJS 模块得到进一步优化。</p><h3><span id="hot-module-replacement-for-module-federation"></span>模块联邦（Module Federation）的 HMR<a href="#hot-module-replacement-for-module-federation" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>Webpack 5 新增了一个全新的特性名为 &quot;Module Federation&quot;，可以在运行时将多个构建整合在一起。
目前，HMR 一次仅支持单个构建，而且两个构建间无法进行更新。
我们希望对此进行改进，并允许 HMR 在不同版本间实现更新，这将改善正在开发 federation 的应用程序。</p><h3><span id="hinting-system"></span>提示系统<a href="#hinting-system" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>目前，webpack 会向用户展示警告和错误。
在构建过程中，有许多情况下，我们可以告知用户一些信息，比如潜在的问题或优化方案，但它们并不适合作为警告或错误输出，我们不想用这些信息来冗余输出信息。
因此，我们想增加一个分类：提示。
我们希望在构建过程中收集所有提示（插件可以 emit 一些），但只在输出中展示有限的内容（默认只展示一个）。
这应该会为用户带来更好的开发体验。</p><h3><span id="multi-threading"></span>多线程<a href="#multi-threading" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>尽管 Persistent Caching 使得缓存构建的速度有了质的提示，但不使用 Persistent Cache 的初始构建仍有一定的改进空间。
Node.js 中的 JavaScript 执行默认是单线程的，但最近增加的功能允许使用 <code>worker_threads</code>，这是一个类似于 WebWorker 的 API。</p><p>如此做可以充分利用 CPU 来分配工作。webpack 5 中已经为此做了一些准备：比如允许内部数据结构序列化，工作队列支持插件。但其中有些部分还尚未明确，需进行实验。</p><p>此功能已在我们的投票名单中很久了，但至今没有多少人为此投票。不知大家是否需要此功能？</p><h3><span id="webassembly"></span>WebAssembly<a href="#webassembly" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>目前，WebAssembly 是实验性功能，默认情况下不启用。
一旦此提案达到 Stage 4 时，我们会默认启用。</p><p>这也可能使得生态系统更广泛地采用 WebAssembly。
我认为 2021 年，可能在此领域会有更深入的探索。</p><h2><span id="disclaimer"></span>免责声明<a href="#disclaimer" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>此工作计划并非一成不变。
Web 生态系统变化如此之快，以至于我们最终可能会实现完全不同的内容，而我们此时可能并未意识到。
同时，由于我们目前赞助情况尚未可知，我们甚至不清楚能在 webpack 上投入多少时间。</p></div><div class="print:hidden mt-20"><a class="text-gray-500 dark:text-gray-500 text-sm cursor-pointer font-sans hover:underline" href="https://github.com/docschina/webpack.js.org/edit/cn/src/content/blog/2020-12-08-roadmap-2021.mdx">编辑此页</a><span class="mx-5 text-black font-bold dark:text-white">·</span><a class="text-gray-500 dark:text-gray-500 text-sm cursor-pointer font-sans hover:underline">打印文档</a></div><div class="adjacent-links print:hidden"><div class="adjacent-links__prev"><div>« Previous</div><a class="adjacent-links__link" href="/blog/">Blog</a></div><div class="adjacent-links__next"><div class="adjacent-links__label--next">Next »</div><a class="adjacent-links__link" href="/blog/2020-10-10-webpack-5-release/">Webpack 5 发布 (2020-10-10)</a></div></div><div class="contributors__section"><h3 class="!font-sans !font-normal">1<!-- --> <!-- -->位译者</h3><div class="translators"><div class="translators__list"><a class="translator" href="https://github.com/QC-L"><img alt="QC-L" src="/icon-square-small-slack.9281492bb267314634b4.png"/><span class="translator__name"> <!-- -->QC-L</span></a></div></div></div><div data-testid="contributors" class="print:hidden"><h2 class="!font-sans !font-normal">1<!-- --> <!-- -->位贡献者</h2><div><div class="grid gap-[10px] lg:gap-[15px] grid-cols-contributors"><a href="https://github.com/sokra"><img width="45" height="45" alt="sokra" title="sokra" class="w-full rounded-full shadow" src="/icon-square-small-slack.9281492bb267314634b4.png"/></a></div></div></div></div></section></div><footer class="footer"><div class="container footer__inner"><section class="footer__left"><a class="footer__link" href="/guides/getting-started/">快速开始</a><a class="footer__link" href="/comparison/">对比</a><a href="https://privacy-policy.openjsf.org/" target="_blank" rel="noopener noreferrer" class="footer__link">Privacy Policy</a></section><section class="footer__middle"><a class="footer__icon" href="/"><img src="/icon-square-small.85ba630cf0c5f29ae3e3.svg" alt="webpack icon" width="35" height="35"/></a></section><section class="footer__right"><a href="https://webpack.threadless.com/" target="_blank" rel="noopener noreferrer" class="footer__link">周边</a><a class="footer__link" href="/awesome-webpack/">Awesome webpack</a><a class="footer__link" href="/glossary/">术语</a><a class="footer__link" href="/branding/">品牌</a><a href="https://gitter.im/webpack/webpack" target="_blank" rel="noopener noreferrer" class="footer__link">Gitter</a><a href="https://github.com/webpack/webpack/releases" target="_blank" rel="noopener noreferrer" class="footer__link">更新日志</a><a class="footer__link footer__license" href="/license"><img alt="Creative Commons License" src="/cc.ab77d813bf219c6e34ff.svg" width="25" height="25"/><img alt="Creative Commons License" src="/by.1360bb2e6d1fc28cdd9e.svg" width="25" height="25"/></a></section></div></footer></div></div><script src="/vendor.e63a9c1308a47f528841.js"></script><script src="/index.9021dfa1363de1c1e288.js"></script><script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?f92e0e48311f635665d2de225751a349";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script></body>