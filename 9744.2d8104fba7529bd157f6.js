"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9744],{9744:function(e,a,n){n.r(a),n(7378);var t=n(2682);function o(){return o=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e},o.apply(this,arguments)}function p(e){let{components:a,...n}=e;return(0,t.kt)("wrapper",o({components:a},n),(0,t.kt)("p",null,"ECMAScript 模块（ESM）是在 Web 中使用模块的",(0,t.kt)("a",{href:"https://tc39.github.io/ecma262/#sec-modules",parentName:"p"},"规范"),"。\n所有现代浏览器均支持此功能，同时也是在 Web 中编写模块化代码的推荐方式。"),(0,t.kt)("p",null,"webpack 支持处理 ECMAScript 模块以优化它们。"),(0,t.kt)("h2",null,(0,t.kt)("span",{id:"exporting",parentName:"h2"}),"导出",(0,t.kt)("a",{href:"#exporting","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"关键字 ",(0,t.kt)("inlineCode",{parentName:"p"},"export")," 允许将 ESM 中的内容暴露给其他模块:"),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-js",parentName:"pre"},(0,t.kt)("span",{className:"token keyword",parentName:"code"},"export")," ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"const")," ",(0,t.kt)("span",{className:"token constant",parentName:"code"},"CONSTANT")," ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,t.kt)("span",{className:"token number",parentName:"code"},"42"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n\n",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"export")," ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"let")," variable ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,t.kt)("span",{className:"token number",parentName:"code"},"42"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// 对外暴露的变量为只读"),"\n",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// 无法从外部修改"),"\n\n",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"export")," ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"function")," ",(0,t.kt)("span",{className:"token function",parentName:"code"},"fun"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  console",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function",parentName:"code"},"log"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token string",parentName:"code"},"'fun'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),"\n\n",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"export")," ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"class")," ",(0,t.kt)("span",{className:"token class-name",parentName:"code"},"C")," ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"extends")," ",(0,t.kt)("span",{className:"token class-name",parentName:"code"},"Super")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  ",(0,t.kt)("span",{className:"token function",parentName:"code"},"method"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    console",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function",parentName:"code"},"log"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token string",parentName:"code"},"'method'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),"\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),"\n\n",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"let")," a",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},",")," b",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},",")," other",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"export")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{")," a",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},",")," b",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},",")," other ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"as")," c ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n\n",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"export")," ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"default")," ",(0,t.kt)("span",{className:"token number",parentName:"code"},"1")," ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"+")," ",(0,t.kt)("span",{className:"token number",parentName:"code"},"2")," ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"+")," ",(0,t.kt)("span",{className:"token number",parentName:"code"},"3")," ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"+")," ",(0,t.kt)("span",{className:"token function",parentName:"code"},"more"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,t.kt)("h2",null,(0,t.kt)("span",{id:"importing",parentName:"h2"}),"导入",(0,t.kt)("a",{href:"#importing","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"关键字 ",(0,t.kt)("inlineCode",{parentName:"p"},"import")," 允许从其他模块获取引用到 ESM 中:"),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-js",parentName:"pre"},(0,t.kt)("span",{className:"token keyword",parentName:"code"},"import")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{")," ",(0,t.kt)("span",{className:"token constant",parentName:"code"},"CONSTANT"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},",")," variable ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}")," ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"from")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'./module.js'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// 导入由其他模块导出的“绑定”"),"\n",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// 这些绑定是动态的. 这里并非获取到了值的副本"),"\n",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// 而是当将要访问“variable”时"),"\n",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// 再从导入的模块中获取当前值"),"\n\n",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"import")," ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"*")," ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"as")," module ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"from")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'./module.js'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\nmodule",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function",parentName:"code"},"fun"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// 导入包含所有导出内容的“命名空间对象”"),"\n\n",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"import")," theDefaultValue ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"from")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'./module.js'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// 导入 `default` 导出的快捷方式"))),(0,t.kt)("h2",null,(0,t.kt)("span",{id:"flagging-modules-as-esm",parentName:"h2"}),"将模块标记为 ESM",(0,t.kt)("a",{href:"#flagging-modules-as-esm","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"默认情况下，webpack 将自动检测文件是 ESM 还是其他模块系统。"),(0,t.kt)("p",null,"Node.js 通过设置 ",(0,t.kt)("inlineCode",{parentName:"p"},"package.json")," 中的属性来显式设置文件模块类型。\n在 package.json 中设置 ",(0,t.kt)("inlineCode",{parentName:"p"},'"type": "module"')," 会强制 package.json 下的所有文件使用 ECMAScript 模块。\n设置 ",(0,t.kt)("inlineCode",{parentName:"p"},'"type": "commonjs"')," 将会强制使用 CommonJS 模块。"),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-json",parentName:"pre"},(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  ",(0,t.kt)("span",{className:"token property",parentName:"code"},'"type"'),(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},'"module"'),"\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"))),(0,t.kt)("p",null,"除此之外，文件还可以通过使用 ",(0,t.kt)("inlineCode",{parentName:"p"},".mjs")," 或 ",(0,t.kt)("inlineCode",{parentName:"p"},".cjs")," 扩展名来设置模块类型。 ",(0,t.kt)("inlineCode",{parentName:"p"},".mjs")," 将它们强制置为 ESM，",(0,t.kt)("inlineCode",{parentName:"p"},".cjs")," 将它们强制置为 CommonJs。"),(0,t.kt)("p",null,"在使用 ",(0,t.kt)("inlineCode",{parentName:"p"},"text/javascript")," 或 ",(0,t.kt)("inlineCode",{parentName:"p"},"application/javascript")," mime type 的 DataURI 中，也将使用 ESM。"),(0,t.kt)("p",null,"除了模块格式外，将模块标记为 ESM 还会影响解析逻辑，操作逻辑和模块中的可用符号。"),(0,t.kt)("p",null,"导入模块在 ESM 中更为严格，导入相对路径的模块必须包含文件名和文件扩展名（例如 ",(0,t.kt)("inlineCode",{parentName:"p"},"*.js")," 或者 ",(0,t.kt)("inlineCode",{parentName:"p"},"*.mjs"),"），除非你设置了 ",(0,t.kt)("a",{href:"/configuration/module/#resolve-fully-specified",parentName:"p"},(0,t.kt)("inlineCode",{parentName:"a"},"fullySpecified=false")),"。"),(0,t.kt)("aside",{className:"tip"},(0,t.kt)("h6",{className:"tip__prefix",parentName:"aside"},"提示"),(0,t.kt)("p",{parentName:"aside"},"依旧支持导入包，例如 ",(0,t.kt)("inlineCode",{parentName:"p"},'import "lodash"')," .")),(0,t.kt)("p",null,"non-ESM 仅能导入 ",(0,t.kt)("inlineCode",{parentName:"p"},"default")," 导出的模块，不支持命名导出的模块。"),(0,t.kt)("p",null,"CommonJs 语法不可用: ",(0,t.kt)("inlineCode",{parentName:"p"},"require"),", ",(0,t.kt)("inlineCode",{parentName:"p"},"module"),", ",(0,t.kt)("inlineCode",{parentName:"p"},"exports"),", ",(0,t.kt)("inlineCode",{parentName:"p"},"__filename"),", ",(0,t.kt)("inlineCode",{parentName:"p"},"__dirname"),"."),(0,t.kt)("aside",{className:"tip"},(0,t.kt)("h6",{className:"tip__prefix",parentName:"aside"},"提示"),(0,t.kt)("p",{parentName:"aside"},"HMR 使用 ",(0,t.kt)("a",{href:"/api/module-variables/#importmetawebpackHot",parentName:"p"},(0,t.kt)("inlineCode",{parentName:"a"},"import.meta.webpackHot"))," 代替 ",(0,t.kt)("a",{href:"/api/module-variables/#modulehot-webpack-specific",parentName:"p"},(0,t.kt)("inlineCode",{parentName:"a"},"module.hot")),"。")))}p.isMDXComponent=!0,a.default=p}}]);