"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7684],{7684:function(e,a,n){n.r(a),n(7378);var t=n(2682);function p(){return p=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e},p.apply(this,arguments)}function o(e){let{components:a,...n}=e;return(0,t.kt)("wrapper",p({components:a},n),(0,t.kt)("p",null,"本插件实现了对 source map 生成内容进行更细粒度的控制。它也可以根据 ",(0,t.kt)("a",{href:"/configuration/devtool/",parentName:"p"},(0,t.kt)("inlineCode",{parentName:"a"},"devtool"))," 配置选项的某些设置来自动启用。"),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-js",parentName:"pre"},(0,t.kt)("span",{className:"token keyword",parentName:"code"},"new")," ",(0,t.kt)("span",{className:"token class-name",parentName:"code"},"webpack",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"."),"SourceMapDevToolPlugin"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),"options",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,t.kt)("h2",null,(0,t.kt)("span",{id:"options",parentName:"h2"}),"配置项",(0,t.kt)("a",{href:"#options","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"支持以下配置项："),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"test"),"（",(0,t.kt)("inlineCode",{parentName:"li"},"string")," ",(0,t.kt)("inlineCode",{parentName:"li"},"RegExp")," ",(0,t.kt)("inlineCode",{parentName:"li"},"[string, RegExp]"),"）：包含基于扩展名的模块的 source map（默认是 ",(0,t.kt)("inlineCode",{parentName:"li"},".js"),", ",(0,t.kt)("inlineCode",{parentName:"li"},".mjs")," 和 ",(0,t.kt)("inlineCode",{parentName:"li"},".css"),"）。"),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"include"),"（",(0,t.kt)("inlineCode",{parentName:"li"},"string")," ",(0,t.kt)("inlineCode",{parentName:"li"},"RegExp")," ",(0,t.kt)("inlineCode",{parentName:"li"},"[string, RegExp]"),"）：使路径与该值匹配的模块生成 source map。"),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"exclude"),"（",(0,t.kt)("inlineCode",{parentName:"li"},"string")," ",(0,t.kt)("inlineCode",{parentName:"li"},"RegExp")," ",(0,t.kt)("inlineCode",{parentName:"li"},"[string, RegExp]"),"）：使匹配该值的模块不生成 source map。"),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"filename"),"（",(0,t.kt)("inlineCode",{parentName:"li"},"string"),"）：定义生成的 SourceMap 的名称（不设置将默认置为 inlined）。"),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"append"),"（",(0,t.kt)("inlineCode",{parentName:"li"},"string"),"）：在原始资源后追加给定值。通常是 ",(0,t.kt)("inlineCode",{parentName:"li"},"#sourceMappingURL")," 注释。",(0,t.kt)("inlineCode",{parentName:"li"},"[url]")," 被替换成 source map 文件的 URL。webpack v4.36.0 之后支持 path 参数：",(0,t.kt)("inlineCode",{parentName:"li"},"[chunk]"),"、",(0,t.kt)("inlineCode",{parentName:"li"},"[filename]")," 和 ",(0,t.kt)("inlineCode",{parentName:"li"},"[contenthash]"),"。设置 ",(0,t.kt)("inlineCode",{parentName:"li"},"append")," 为 ",(0,t.kt)("inlineCode",{parentName:"li"},"false")," 会禁止追加。"),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"moduleFilenameTemplate"),"（",(0,t.kt)("inlineCode",{parentName:"li"},"string"),"）：查看 ",(0,t.kt)("a",{href:"/configuration/output/#outputdevtoolmodulefilenametemplate",parentName:"li"},(0,t.kt)("inlineCode",{parentName:"a"},"output.devtoolModuleFilenameTemplate")),"。"),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"fallbackModuleFilenameTemplate"),"（",(0,t.kt)("inlineCode",{parentName:"li"},"string"),"）：查看上面的链接。"),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"namespace"),"（",(0,t.kt)("inlineCode",{parentName:"li"},"string"),"）：查看 ",(0,t.kt)("a",{href:"/configuration/output/#outputdevtoolnamespace",parentName:"li"},(0,t.kt)("inlineCode",{parentName:"a"},"output.devtoolNamespace")),"。"),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"module = true"),"（",(0,t.kt)("inlineCode",{parentName:"li"},"boolean"),"）：表示 loader 是否生成 source map。"),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"columns = true"),"（",(0,t.kt)("inlineCode",{parentName:"li"},"boolean"),"）：表示是否应该使用 column mapping。"),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"noSources = false"),"（",(0,t.kt)("inlineCode",{parentName:"li"},"boolean"),"）：防止源文件的内容被包含在 source map 中。"),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"publicPath")," (",(0,t.kt)("inlineCode",{parentName:"li"},"string"),")：生成带 public path 前缀的绝对 URL，例如：",(0,t.kt)("inlineCode",{parentName:"li"},"https://example.com/project/"),"。"),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"fileContext")," (",(0,t.kt)("inlineCode",{parentName:"li"},"string"),")：使得 ",(0,t.kt)("inlineCode",{parentName:"li"},"[file]")," 参数作为本目录的相对路径。"),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"sourceRoot"),"（",(0,t.kt)("inlineCode",{parentName:"li"},"string"),"）：给 SourceMap 中的 ",(0,t.kt)("inlineCode",{parentName:"li"},"sourceRoot")," 属性提供一个自定义值。")),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"fileContext")," 配置在你想要将 source map 存储到上层目录，以避免 ",(0,t.kt)("inlineCode",{parentName:"p"},"../../")," 出现在绝对路径 ",(0,t.kt)("inlineCode",{parentName:"p"},"[url]")," 里面时是有用的。"),(0,t.kt)("aside",{className:"tip"},(0,t.kt)("h6",{className:"tip__prefix",parentName:"aside"},"提示"),(0,t.kt)("p",{parentName:"aside"},"设置 ",(0,t.kt)("inlineCode",{parentName:"p"},"module")," 和/或 ",(0,t.kt)("inlineCode",{parentName:"p"},"columns")," 为 ",(0,t.kt)("inlineCode",{parentName:"p"},"false")," 将会生成不太精确的 source map，但同时会显著地提升编译性能。")),(0,t.kt)("aside",{className:"tip"},(0,t.kt)("h6",{className:"tip__prefix",parentName:"aside"},"提示"),(0,t.kt)("p",{parentName:"aside"},"如果你想在",(0,t.kt)("a",{href:"/configuration/mode/#mode-development",parentName:"p"},"开发模式"),"中使用该插件的自定义配置，请确保禁用默认配置。即设置 ",(0,t.kt)("inlineCode",{parentName:"p"},"devtool: false"),"。")),(0,t.kt)("aside",{className:"warning"},(0,t.kt)("h6",{className:"warning__prefix",parentName:"aside"},"警告"),(0,t.kt)("p",{parentName:"aside"},"如果默认的 webpack ",(0,t.kt)("inlineCode",{parentName:"p"},"minimizer")," 已经被覆盖（比如自定义 ",(0,t.kt)("inlineCode",{parentName:"p"},"TerserPlugin")," 配置），请确保将其替换为 ",(0,t.kt)("inlineCode",{parentName:"p"},"sourceMap: true")," 以启动 SourceMap 支持。")),(0,t.kt)("h2",null,(0,t.kt)("span",{id:"examples",parentName:"h2"}),"示例",(0,t.kt)("a",{href:"#examples","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"下面的示例展示了本插件的一些常见用例。"),(0,t.kt)("h3",null,(0,t.kt)("span",{id:"basic-use-case",parentName:"h3"}),"基本使用",(0,t.kt)("a",{href:"#basic-use-case","aria-hidden":"true",tabIndex:"-1",parentName:"h3"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"你可以使用以下代码将配置项 ",(0,t.kt)("inlineCode",{parentName:"p"},"devtool: inline-source-map")," 替换为等效的自定义插件配置："),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-js",parentName:"pre"},"module",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),"exports ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// ..."),"\n  devtool",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token boolean",parentName:"code"},"false"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  plugins",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),(0,t.kt)("span",{className:"token keyword",parentName:"code"},"new")," ",(0,t.kt)("span",{className:"token class-name",parentName:"code"},"webpack",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"."),"SourceMapDevToolPlugin"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,t.kt)("h3",null,(0,t.kt)("span",{id:"exclude-vendor-maps",parentName:"h3"}),"排除 Vendor Maps",(0,t.kt)("a",{href:"#exclude-vendor-maps","aria-hidden":"true",tabIndex:"-1",parentName:"h3"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"以下代码会排除 ",(0,t.kt)("inlineCode",{parentName:"p"},"vendor.js")," bundle 内模块的 source map。"),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-js",parentName:"pre"},(0,t.kt)("span",{className:"token keyword",parentName:"code"},"new")," ",(0,t.kt)("span",{className:"token class-name",parentName:"code"},"webpack",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"."),"SourceMapDevToolPlugin"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  filename",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'[name].js.map'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  exclude",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),(0,t.kt)("span",{className:"token string",parentName:"code"},"'vendor.js'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,t.kt)("h3",null,(0,t.kt)("span",{id:"host-source-maps-externally",parentName:"h3"}),"在宿主环境外部化 source map",(0,t.kt)("a",{href:"#host-source-maps-externally","aria-hidden":"true",tabIndex:"-1",parentName:"h3"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"设置 source map 的 URL。在宿主环境需要授权的情况下很有用。"),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-js",parentName:"pre"},(0,t.kt)("span",{className:"token keyword",parentName:"code"},"new")," ",(0,t.kt)("span",{className:"token class-name",parentName:"code"},"webpack",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"."),"SourceMapDevToolPlugin"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  append",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'\\n//# sourceMappingURL=https://example.com/sourcemap/[url]'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  filename",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'[name].map'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,t.kt)("p",null,"还有一种场景，source map 存储在上层目录中时："),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-code",parentName:"pre"},"project\n|- dist\n  |- public\n    |- bundle-[hash].js\n  |- sourcemaps\n    |- bundle-[hash].js.map\n")),(0,t.kt)("p",null,"如下设置："),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-js",parentName:"pre"},(0,t.kt)("span",{className:"token keyword",parentName:"code"},"new")," ",(0,t.kt)("span",{className:"token class-name",parentName:"code"},"webpack",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"."),"SourceMapDevToolPlugin"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  filename",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'sourcemaps/[file].map'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  publicPath",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'https://example.com/project/'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  fileContext",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'public'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,t.kt)("p",null,"将会生成以下 URL："),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-code",parentName:"pre"},"https://example.com/project/sourcemaps/bundle-[hash].js.map\n")))}o.isMDXComponent=!0,a.default=o}}]);