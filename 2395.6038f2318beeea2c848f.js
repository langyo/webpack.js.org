"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[2395],{2395:function(e,a,t){t.r(a),t(7378);var n=t(2682);function p(){return p=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},p.apply(this,arguments)}function s(e){let{components:a,...t}=e;return(0,n.kt)("wrapper",p({components:a},t),(0,n.kt)("p",null,"由于 JavaScript 既可以编写服务端代码也可以编写浏览器代码，所以 webpack 提供了多种部署 ",(0,n.kt)("em",{parentName:"p"},"target"),"，你可以在 webpack 的",(0,n.kt)("a",{href:"/configuration",parentName:"p"},"配置选项"),"中进行设置。"),(0,n.kt)("aside",{className:"warning"},(0,n.kt)("h6",{className:"warning__prefix",parentName:"aside"},"警告"),(0,n.kt)("p",{parentName:"aside"},"webpack 的 ",(0,n.kt)("inlineCode",{parentName:"p"},"target")," 属性，不要和 ",(0,n.kt)("inlineCode",{parentName:"p"},"output.libraryTarget")," 属性混淆。有关 ",(0,n.kt)("inlineCode",{parentName:"p"},"output")," 属性的更多信息，请参阅 ",(0,n.kt)("a",{href:"/concepts/output/",parentName:"p"},"output 指南"))),(0,n.kt)("h2",null,(0,n.kt)("span",{id:"usage",parentName:"h2"}),"用法",(0,n.kt)("a",{href:"#usage","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,n.kt)("span",{className:"header-link",parentName:"a"}))),(0,n.kt)("p",null,"想设置 ",(0,n.kt)("inlineCode",{parentName:"p"},"target")," 属性，只需在 webpack 配置中设置 target 字段："),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"webpack.config.js")),(0,n.kt)("pre",null,(0,n.kt)("code",{className:"hljs language-javascript",parentName:"pre"},"module",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"."),"exports ",(0,n.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  target",(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,n.kt)("span",{className:"token string",parentName:"code"},"'node'"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,n.kt)("p",null,"在上述示例中，target 设置为 ",(0,n.kt)("inlineCode",{parentName:"p"},"node"),"，webpack 将在类 Node.js 环境编译代码。(使用 Node.js 的 ",(0,n.kt)("inlineCode",{parentName:"p"},"require")," 加载 chunk，而不加载任何内置模块，如 ",(0,n.kt)("inlineCode",{parentName:"p"},"fs")," 或 ",(0,n.kt)("inlineCode",{parentName:"p"},"path"),")。"),(0,n.kt)("p",null,"每个 ",(0,n.kt)("em",{parentName:"p"},"target")," 都包含各种 deployment（部署）/environment（环境）特定的附加项，以满足其需求。具体请参阅 ",(0,n.kt)("a",{href:"/configuration/target/",parentName:"p"},"target 可用值"),"。"),(0,n.kt)("aside",{className:"todo"},(0,n.kt)("h6",{className:"todo__prefix",parentName:"aside"},"TODO"),(0,n.kt)("p",{parentName:"aside"},"后续会进一步扩展受欢迎的 target。")),(0,n.kt)("h2",null,(0,n.kt)("span",{id:"multiple-targets",parentName:"h2"}),"多 target",(0,n.kt)("a",{href:"#multiple-targets","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,n.kt)("span",{className:"header-link",parentName:"a"}))),(0,n.kt)("p",null,"虽然 webpack ",(0,n.kt)("strong",{parentName:"p"},"不支持")," 向 ",(0,n.kt)("inlineCode",{parentName:"p"},"target")," 属性传入多个字符串，但是可以通过设置两个独立配置，来构建对 library 进行同构："),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"webpack.config.js")),(0,n.kt)("pre",null,(0,n.kt)("code",{className:"hljs language-javascript",parentName:"pre"},(0,n.kt)("span",{className:"token keyword",parentName:"code"},"const")," path ",(0,n.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,n.kt)("span",{className:"token function",parentName:"code"},"require"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,n.kt)("span",{className:"token string",parentName:"code"},"'path'"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"const")," serverConfig ",(0,n.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  target",(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,n.kt)("span",{className:"token string",parentName:"code"},"'node'"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  output",(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    path",(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," path",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,n.kt)("span",{className:"token function",parentName:"code"},"resolve"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),"__dirname",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},",")," ",(0,n.kt)("span",{className:"token string",parentName:"code"},"'dist'"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n    filename",(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,n.kt)("span",{className:"token string",parentName:"code"},"'lib.node.js'"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,n.kt)("span",{className:"token comment",parentName:"code"},"//…"),"\n",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n\n",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"const")," clientConfig ",(0,n.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  target",(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,n.kt)("span",{className:"token string",parentName:"code"},"'web'"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},",")," ",(0,n.kt)("span",{className:"token comment",parentName:"code"},"// <=== 默认为 'web'，可省略"),"\n  output",(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    path",(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," path",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,n.kt)("span",{className:"token function",parentName:"code"},"resolve"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),"__dirname",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},",")," ",(0,n.kt)("span",{className:"token string",parentName:"code"},"'dist'"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n    filename",(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,n.kt)("span",{className:"token string",parentName:"code"},"'lib.js'"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,n.kt)("span",{className:"token comment",parentName:"code"},"//…"),"\n",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n\nmodule",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"."),"exports ",(0,n.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"["),"serverConfig",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},",")," clientConfig",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"]"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,n.kt)("p",null,"上述示例中，将会在 ",(0,n.kt)("inlineCode",{parentName:"p"},"dist")," 文件夹下创建 ",(0,n.kt)("inlineCode",{parentName:"p"},"lib.js")," 和 ",(0,n.kt)("inlineCode",{parentName:"p"},"lib.node.js")," 文件。"),(0,n.kt)("h2",null,(0,n.kt)("span",{id:"resources",parentName:"h2"}),"资源",(0,n.kt)("a",{href:"#resources","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,n.kt)("span",{className:"header-link",parentName:"a"}))),(0,n.kt)("p",null,"从上面选项可以看出，你可以选择部署不同的 ",(0,n.kt)("em",{parentName:"p"},"target"),"。下面是可以参考的示例和资源："),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},(0,n.kt)("a",{href:"https://github.com/TheLarkInn/compare-webpack-target-bundles",parentName:"strong"},"compare-webpack-target-bundles")),"：测试并查看 webpack ",(0,n.kt)("em",{parentName:"li"},"target")," 的绝佳资源。同样包含错误上报。"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},(0,n.kt)("a",{href:"https://github.com/chentsulin/electron-react-boilerplate",parentName:"strong"},"Boilerplate of Electron-React Application")),": 一个关于 electron 主进程和渲染进程构建过程的优秀示例。")),(0,n.kt)("aside",{className:"todo"},(0,n.kt)("h6",{className:"todo__prefix",parentName:"aside"},"TODO"),(0,n.kt)("p",{parentName:"aside"},"需要你查看在线代码或样本中 webpack 配置中使用的 target 示例。")))}s.isMDXComponent=!0,a.default=s}}]);