<!DOCTYPE html><html lang="zh-cmn-Hans"><head><title data-rh="true">Combined printable page | webpack 中文文档</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="theme-color" content="#2B3A42"/><meta data-rh="true" name="viewport" content="width=device-width, initial-scale=1"/><meta data-rh="true" name="robots" content="noindex,nofollow"/><meta data-rh="true" name="description" content="webpack 是一个模块打包器。它的主要目标是将 JavaScript 文件打包在一起，打包后的文件用于在浏览器中使用，但它也能够胜任转换、打包或包裹任何资源。"/><meta data-rh="true" property="og:site_name" content="webpack"/><meta data-rh="true" property="og:type" content="website"/><meta data-rh="true" property="og:title" content="Combined printable page | webpack 中文文档"/><meta data-rh="true" property="og:description" name="description" content="webpack 是一个模块打包器。它的主要目标是将 JavaScript 文件打包在一起，打包后的文件用于在浏览器中使用，但它也能够胜任转换、打包或包裹任何资源。"/><meta data-rh="true" property="og:image" content="https://webpack.js.org/icon-pwa-512x512.d3dae4189855b3a72ff9.png"/><meta data-rh="true" property="twitter:card" content="summary"/><meta data-rh="true" property="twitter:site" content="@webpack"/><meta data-rh="true" property="twitter:creator" content="@webpack"/><meta data-rh="true" property="twitter:domain" content="https://webpack.js.org/"/><meta data-rh="true" name="keywords" content="webpack5, webpack, webpack 中文文档, webpack 官方中文, webpack 5 官方中文, 印记中文, docschina, docschina.org, webpack.docschina.org, doc.react-china.org, nodejs.cn, vue.docschina.org, babel.docschina.org, parceljs.docschina.org, rollup.docschina.org, koajs.docschina.org"/><meta data-rh="true" name="mobile-web-app-capable" content="yes"/><meta data-rh="true" name="apple-mobile-web-app-capable" content="yes"/><meta data-rh="true" name="apple-mobile-web-app-status-bar-style" content="black"/><meta data-rh="true" name="apple-mobile-web-app-title" content="webpack"/><meta data-rh="true" name="msapplication-TileImage" content="/icon_150x150.png"/><meta data-rh="true" name="msapplication-TileColor" content="#465e69"/><link data-rh="true" rel="icon" type="image/x-icon" href="/favicon.f326220248556af65f41.ico"/><link data-rh="true" rel="manifest" href="/manifest.json"/><link data-rh="true" rel="canonical" href="https://webpack.docschina.org/api/printable/"/><link data-rh="true" rel="icon" sizes="192x192" href="/icon_192x192.png"/><link data-rh="true" rel="icon" sizes="512x512" href="/icon_512x512.png"/><link data-rh="true" rel="apple-touch-icon" href="/icon_180x180.png"/><link data-rh="true" rel="mask-icon" href="/logo-on-white-bg.47eff95f9c01c5972f6f.svg" color="#465e69"/><link rel="stylesheet" href=/index.c114afea0778b47a418a.css /><link rel="stylesheet" href=/9517.acfe42251eae743e4e22.css /></head><body><div id="root"><div class="site"><div class="site__header"><header class="bg-blue-800 dark:bg-gray-900"><div class="flex items-center py-10 px-[16px] justify-between md:px-[24px] md:max-w-[1024px] md:mx-auto md:justify-start"><button class="bg-transparent border-none md:hidden"><svg viewBox="-62 138 25 25" width="20" height="20" class="fill-current text-white"><path fill="currentColor" d="M-60.2 140.2h20.9c1 0 1.8.8 1.8 1.8s-.8 1.8-1.8 1.8h-20.9c-1 0-1.8-.8-1.8-1.8s.8-1.8 1.8-1.8M-60.2 148.7h20.9c1 0 1.8.8 1.8 1.8s-.8 1.8-1.8 1.8h-20.9c-1 0-1.8-.8-1.8-1.8s.8-1.8 1.8-1.8M-60.2 157.2h20.9c1 0 1.8.8 1.8 1.8s-.8 1.8-1.8 1.8h-20.9c-1 0-1.8-.8-1.8-1.8s.8-1.8 1.8-1.8"></path></svg></button><a class="md:mr-auto" href="/"><img class="logo" src="/site-logo.1fcab817090e78435061.svg" alt="webpack logo" width="122" height="35"/></a><nav class="hidden md:inline-grid md:grid-flow-col md:gap-x-[18px]"><a class="text-gray-100 dark:text-gray-100 text-sm font-light uppercase hover:text-blue-200" href="/concepts/">中文文档</a><a class="text-gray-100 dark:text-gray-100 text-sm font-light uppercase hover:text-blue-200" href="/contribute/">参与贡献</a><a class="text-gray-100 dark:text-gray-100 text-sm font-light uppercase hover:text-blue-200" href="/blog/">博客</a><a href="https://docschina.org" target="_blank" rel="noopener noreferrer" class="text-gray-100 dark:text-gray-100 text-sm font-light uppercase hover:text-blue-200">印记中文</a><a href="https://github.com/webpack/webpack" target="_blank" rel="noopener noreferrer" class="inline-flex items-center text-gray-100 dark:text-gray-200 hover:text-blue-200" title="webpack on GitHub"><svg viewBox="0 0 24 24" aria-hidden="true" fill="currentColor" width="16"><path d="M12 2A10 10 0 0 0 2 12a10 10 0 0 0 6.8 9.5c.5 0 .7-.2.7-.5v-1.7C6.7 20 6.1 18 6.1 18c-.4-1.2-1-1.5-1-1.5-1-.6 0-.6 0-.6 1 0 1.5 1 1.5 1 .9 1.6 2.4 1.1 3 .9 0-.7.3-1.1.6-1.4-2.2-.2-4.6-1-4.6-4.9 0-1.1.4-2 1-2.7 0-.3-.4-1.3.2-2.7 0 0 .8-.2 2.7 1a9.4 9.4 0 0 1 5 0c2-1.2 2.8-1 2.8-1 .5 1.4.1 2.4 0 2.7.7.7 1 1.6 1 2.7 0 3.8-2.3 4.7-4.5 5 .4.2.7.8.7 1.8V21c0 .3.2.6.7.5 4-1.3 6.8-5 6.8-9.5A10 10 0 0 0 12 2"></path></svg></a><a href="https://twitter.com/webpack" target="_blank" rel="noopener noreferrer" class="inline-flex items-center text-gray-100 dark:text-gray-200 hover:text-blue-200" title="webpack on Twitter"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30" aria-hidden="true" fill="currentColor" width="16"><path d="M28 6.937c-.957.425-1.985.711-3.064.84a5.343 5.343 0 0 0 2.345-2.951 10.696 10.696 0 0 1-3.388 1.295 5.334 5.334 0 0 0-9.089 4.864A15.143 15.143 0 0 1 3.809 5.411a5.321 5.321 0 0 0-.721 2.683 5.33 5.33 0 0 0 2.372 4.439 5.323 5.323 0 0 1-2.416-.667v.067a5.335 5.335 0 0 0 4.279 5.23 5.336 5.336 0 0 1-2.409.092 5.34 5.34 0 0 0 4.983 3.705 10.699 10.699 0 0 1-6.625 2.284c-.43 0-.855-.025-1.273-.075a15.102 15.102 0 0 0 8.177 2.396c9.812 0 15.176-8.128 15.176-15.177 0-.231-.005-.461-.015-.69A10.855 10.855 0 0 0 28 6.937z"></path></svg></a><a href="https://stackoverflow.com/questions/tagged/webpack" target="_blank" rel="noopener noreferrer" class="inline-flex items-center text-gray-100 dark:text-gray-200 hover:text-blue-200" title="webpack on StackOverflow"><svg viewBox="0 0 24 24" aria-hidden="true" fill="currentColor" width="16"><path d="M17.4 20.2v-5.4h1.8V22H3v-7.2h1.8v5.4zM6.8 14.3l.3-1.7 8.8 1.8-.3 1.8zm1.1-4.2.8-1.6 8.1 3.8-.7 1.6zm2.3-4 1.1-1.4 7 5.8-1.2 1.4L10 6m4.7-4L20 9l-1.4 1-5.4-7 1.4-1m-8 16.5v-1.8h9v1.8z"></path></svg></a><nav class="dropdown "><button aria-haspopup="true" aria-expanded="false" aria-label="Select language"><svg viewBox="0 0 610 560" xmlns="http://www.w3.org/2000/svg" class="dropdown__language text-gray-100 hover:text-blue-200 transition-colors duration-200"><path d="m304.8 99.2-162.5-57.3v353.6l162.5-52.6z"></path><path d="m300.9 99 168.7-57.3v353.6l-168.7-52.5zm-200.7 358.4 200.7-66.9v-291.5l-200.7 66.9z" fill="currentColor"></path><path d="m392.4 461.8 28.4 46.8 15-43.5zm-223.9-262.3c-1.1-1 1.4 8.6 4.8 12 6.1 6.1 10.8 6.9 13.3 7 5.6.2 12.5-1.4 16.5-3.1s10.9-5.2 13.5-10.4c.6-1.1 2.1-3 1.1-7.5-.7-3.5-3-4.8-5.7-4.6s-11 2.4-15 3.6-12.2 3.7-15.8 4.5-11.5-.3-12.7-1.5zm101.2 114.8c-1.6-.6-34.3-14.1-38.9-16.4a368 368 0 0 0 -17.5-7.5c12.3-19 20.1-33.4 21.2-35.6 1.9-4 15-29.5 15.3-31.1s.7-7.5.4-8.9-5.1 1.3-11.6 3.5-18.9 10.2-23.7 11.2-20.1 6.8-28 9.4c-7.8 2.6-22.7 7.1-28.8 8.8-6.1 1.6-11.4 1.8-14.9 2.8 0 0 .5 4.8 1.4 6.2s4.1 5 7.9 5.9c3.8 1 10 .6 12.8-.1s7.7-3.1 8.4-4.1c.7-1.1-.3-4.3.8-5.3s16.1-4.5 21.7-6.2 27.2-9.2 30.1-8.8a916 916 0 0 1 -23.9 47.7 821 821 0 0 1 -45 63.3c-5.3 6-18 21.5-22.4 25 1.1.3 9-.4 10.4-1.3 8.9-5.5 23.8-24.1 28.6-29.7a489.1 489.1 0 0 0 36.7-49.4c1.9.8 17.6 13.6 21.7 16.4a293 293 0 0 0 23.7 13.3c3.5 1.5 16.9 7.7 17.5 5.6.7-1.8-2.3-14.1-3.9-14.7z"></path><path clip-rule="evenodd" d="m194.1 484.7a204.9 204.9 0 0 0 30.7 14.5 233.6 233.6 0 0 0 46.4 12c.5 0 16 1.9 19.2 1.9h15.7c6.1-.5 11.8-.9 17.9-1.7 4.9-.7 10.3-1.6 15.5-2.8 3.8-.9 7.8-1.7 11.7-3 3.7-1 7.8-2.4 11.8-3.8l8.2-3.1c2.3-1 5.1-2.3 7.7-3.3a243 243 0 0 0 19.2-10c2.3-1.2 7.5-5.2 10.3-5.2 3.1 0 5.2 2.8 5.2 5.2 0 5.1-6.8 6.6-9.9 8.9-3.3 2.3-7.3 4-10.8 5.9-7 3.7-14.1 6.8-20.9 9.4a251 251 0 0 1 -27.3 8.5c-3.3.7-6.6 1.6-9.9 2.1-1.7.3-19.9 3.1-24.9 3.1h-23a293.9 293.9 0 0 1 -35.1-5.2 196 196 0 0 1 -33.1-10.3c-12-4.5-24.6-10.5-36.4-18.3-2.1-1.4-2.3-2.8-2.3-4.4a5 5 0 0 1 5.1-5.1c2.4.1 8 4.2 9 4.7zm101.4-98.1-189.9 63.2v-280.1l189.9-63.2zm10.6-288.3v292.7a6 6 0 0 1 -1.2 2.6c-.3.5-1 1.2-1.6 1.4a14621 14621 0 0 1 -203.1 67.6c-2.1 0-4-1.4-5.1-3.7 0-.2-.2-.3-.2-.7v-292.8c.3-.9.5-2.1 1.2-2.8 1.4-1.9 3.8-2.3 5.4-2.8 3-1 196.1-65.8 198.9-65.8 1.9 0 5.7 1.2 5.7 4.3z" fill-rule="evenodd"></path><path clip-rule="evenodd" d="m464.3 388-158-49.1v-236l158-53.7zm10.6-345.8v352.4c-.2 4-3 5.7-5.6 5.7-2.3 0-18.6-5.6-21.4-6.4l-65.8-20.4-14.6-4.7-12.9-4c-18.6-5.7-37.6-11.5-56.3-17.8-.7-.2-2.4-2.6-2.4-3.1v-246.1c.3-.9.7-1.9 1.6-2.6 1.4-1.6 61.1-21.4 84.7-29.3 6.3-2.3 84.8-29.3 87.3-29.3 3 .1 5.4 2.3 5.4 5.6z" fill-rule="evenodd"></path><path d="m515 461.8-211.1-67.3.9-292.8 210.2 66.9z"></path><path clip-rule="evenodd" d="m408.6 232.5-20.7 50.1 38.1 11.5zm-12.4-47.2 27.2 8.2 49.5 178.6-27.9-8.5-10-36.7-57.7-17.5-12.4 29.9-27.9-8.5z" fill="currentColor" fill-rule="evenodd"></path></svg><i aria-hidden="true" class="dropdown__arrow"></i></button><div class="dropdown__list "><ul><li><a href="https://webpack.js.org/api/printable/" class="px-5 block"><span>English</span></a></li><li><a href="https://webpack.docschina.org/api/printable/" class="px-5 block"><span lang="zh">中文</span></a></li><li><a href="https://webpack.kr/api/printable/" class="px-5 block"><span lang="ko">한국어</span></a></li></ul></div></nav></nav><div class="inline-flex items-center ml-[18px]"><button aria-label="Switch to dark theme" class="bg-transparent border-none cursor-pointer text-[16px] p-0 inline-flex items-center text-gray-100 hover:text-blue-200 transition-colors duration-200" data-testid="hello-darkness"><svg width="16" height="16" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18.1406C11.6016 18.1406 11.2782 18.464 11.2782 18.8624V21.0281C11.2782 21.4265 11.6016 21.7499 12 21.7499C12.3985 21.7499 12.7219 21.4265 12.7219 21.0281V18.8624C12.7219 18.464 12.3985 18.1406 12 18.1406V18.1406Z" fill="currentColor"></path><path d="M12 2.25006C11.6016 2.25006 11.2782 2.5735 11.2782 2.97194V5.13756C11.2782 5.536 11.6016 5.85944 12 5.85944C12.3985 5.85944 12.7219 5.536 12.7219 5.13756V2.97194C12.7219 2.5735 12.3985 2.25006 12 2.25006V2.25006Z" fill="currentColor"></path><path d="M5.85936 12C5.85936 11.6015 5.53592 11.2781 5.13749 11.2781H2.97186C2.57342 11.2781 2.24999 11.6015 2.24999 12C2.24999 12.3984 2.57342 12.7218 2.97186 12.7218H5.13749C5.53592 12.7218 5.85936 12.3984 5.85936 12V12Z" fill="currentColor"></path><path d="M21.0281 11.2781H18.8625C18.4641 11.2781 18.1406 11.6015 18.1406 12C18.1406 12.3984 18.4641 12.7218 18.8625 12.7218H21.0281C21.4266 12.7218 21.75 12.3984 21.75 12C21.75 11.6015 21.4266 11.2781 21.0281 11.2781V11.2781Z" fill="currentColor"></path><path d="M7.14841 16.1298C6.95622 16.1298 6.77341 16.2048 6.63747 16.3407L5.10466 17.8735C4.96872 18.0094 4.89372 18.1923 4.89372 18.3844C4.89372 18.5766 4.96872 18.7594 5.10466 18.8954C5.2406 19.0313 5.42341 19.1063 5.6156 19.1063C5.80779 19.1063 5.9906 19.0313 6.12654 18.8954L7.65935 17.3626C7.9406 17.0813 7.9406 16.6219 7.65935 16.3407C7.52341 16.2048 7.3406 16.1298 7.14841 16.1298V16.1298Z" fill="currentColor"></path><path d="M16.8516 7.87036C17.0437 7.87036 17.2266 7.79536 17.3625 7.65942L18.8953 6.12661C19.0312 5.99067 19.1062 5.80786 19.1062 5.61567C19.1062 5.42349 19.0312 5.24067 18.8953 5.10474C18.7594 4.9688 18.5766 4.8938 18.3844 4.8938C18.1922 4.8938 18.0094 4.9688 17.8734 5.10474L16.3406 6.63755C16.2047 6.77349 16.1297 6.9563 16.1297 7.14849C16.1297 7.34067 16.2047 7.52349 16.3406 7.65942C16.4766 7.79536 16.6594 7.87036 16.8516 7.87036V7.87036Z" fill="currentColor"></path><path d="M6.12654 5.10474C5.9906 4.9688 5.80779 4.8938 5.6156 4.8938C5.42341 4.8938 5.2406 4.9688 5.10466 5.10474C4.96872 5.24067 4.89372 5.42349 4.89372 5.61567C4.89372 5.80786 4.96872 5.99067 5.10466 6.12661L6.63747 7.65942C6.77341 7.79536 6.95622 7.87036 7.14841 7.87036C7.3406 7.87036 7.52341 7.79536 7.65935 7.65942C7.79529 7.52349 7.87029 7.34067 7.87029 7.14849C7.87029 6.9563 7.79529 6.77349 7.65935 6.63755L6.12654 5.10474V5.10474Z" fill="currentColor"></path><path d="M17.3625 16.3407C17.2266 16.2048 17.0437 16.1298 16.8516 16.1298C16.6594 16.1298 16.4766 16.2048 16.3406 16.3407C16.0594 16.6219 16.0594 17.0813 16.3406 17.3626L17.8734 18.8954C18.0094 19.0313 18.1922 19.1063 18.3844 19.1063C18.5766 19.1063 18.7594 19.0313 18.8953 18.8954C19.0312 18.7594 19.1062 18.5766 19.1062 18.3844C19.1062 18.1923 19.0312 18.0094 18.8953 17.8735L17.3625 16.3407V16.3407Z" fill="currentColor"></path><path d="M12 7.5C9.52031 7.5 7.5 9.52031 7.5 12C7.5 14.4797 9.52031 16.5 12 16.5C14.4797 16.5 16.5 14.4797 16.5 12C16.5 9.52031 14.4797 7.5 12 7.5Z" fill="currentColor"></path></svg></button><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div><div class="bg-gray-100 dark:bg-gray-800 hidden md:block"><div class="md:max-w-[1024px] md:mx-auto md:grid md:grid-flow-col md:justify-end md:gap-x-[20px] md:px-[24px]" data-testid="sub-navigation"><a title="api" aria-current="page" class="!text-black dark:!text-white text-blue-400 py-5 text-sm capitalize hover:text-black dark:hover:text-white" href="/api/">API</a><a title="概念" class="text-blue-400 py-5 text-sm capitalize hover:text-black dark:hover:text-white" href="/concepts/">概念</a><a title="配置" class="text-blue-400 py-5 text-sm capitalize hover:text-black dark:hover:text-white" href="/configuration/">配置</a><a title="指南" class="text-blue-400 py-5 text-sm capitalize hover:text-black dark:hover:text-white" href="/guides/">指南</a><a title="loader" class="text-blue-400 py-5 text-sm capitalize hover:text-black dark:hover:text-white" href="/loaders/">loader</a><a title="迁移" class="text-blue-400 py-5 text-sm capitalize hover:text-black dark:hover:text-white" href="/migrate/">迁移</a><a title="plugin" class="text-blue-400 py-5 text-sm capitalize hover:text-black dark:hover:text-white" href="/plugins/">plugin</a></div></div></header></div><div class="container site__content"><div class="sponsors"><a href="https://docschina.org" target="_blank" rel="noopener noreferrer" class="sponsors__content"><img class="sponsors__img__docschina" src="/docschina-logo.59f03f74b3c450856c01.png"/><div class="sponsors__content-cont">翻译/文档内容有任何问题，请联系我们</div><div class="wwads-cn wwads-horizontal wwads-sticky" data-id="306" style="max-width:350px"></div></a></div><nav class="sidebar site__sidebar"><div class="sidebar__inner"><div class="relative z-0 bg-white dark:bg-gray-100 "><select class="text-gray-600 text-14 px-5 py-5 appearance-none box-border border border-gray-200 border-solid flex-col flex w-full rounded-none bg-transparent bg-none"><option selected="" value="5">Webpack 5</option><option value="4">Webpack 4</option></select><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="absolute right-5 top-5 fill-current text-gray-300 z-[-1]" width="20" height="20"><path d="M4.5 7.5c.5-.4 1-.4 1.6 0l3.9 3.8 4-3.8c.4-.4 1-.4 1.5 0 .4.5.4 1.2 0 1.7l-4.7 4.5a1 1 0 0 1-1.6 0L4.5 9.2c-.4-.5-.4-1.2 0-1.7z"></path></svg></div><div class="sidebar-item sidebar-item--disabled`"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="sidebar-item__toggle" width="15" height="17" fill="#175d96"><path d="M10 3.3c-.6 0-1 .4-1.1 1.1v11.2c0 .3.2.6.4.8s.5.4.8.4c.6 0 1-.4 1.1-1.1V4.5c0-.3-.2-.6-.4-.8s-.5-.4-.8-.4z"></path></svg><a class="sidebar-item__title sidebar-link__print" href="/api/printable/" rel="nofollow noopener noreferrer" alt="Print" title="Print" target="_blank">Print Section<img src="/icon-print.d4d2cfa27f8b9a98e34a.svg" width="27" height="20" alt="Printer Icon"/></a></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="m9.2 4.5 4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0"></path></svg><a class="sidebar-item__title" href="/api/">简介</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="CLI "><a aria-current="page" class="active" href="/api/#cli">CLI </a></li><li class="sidebar-item__anchor" title="模块 "><a aria-current="page" class="active" href="/api/#module">模块 </a></li><li class="sidebar-item__anchor" title="Node "><a aria-current="page" class="active" href="/api/#node">Node </a></li><li class="sidebar-item__anchor" title="Loaders "><a aria-current="page" class="active" href="/api/#loaders">Loaders </a></li><li class="sidebar-item__anchor" title="插件 "><a aria-current="page" class="active" href="/api/#plugins">插件 </a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="m9.2 4.5 4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0"></path></svg><a class="sidebar-item__title" href="/api/cli/">命令行接口（CLI）</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="命令 "><a class="" href="/api/cli/#commands">命令 </a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Build "><a class="" href="/api/cli/#build">Build </a></li><li class="sidebar-item__anchor" title="Init "><a class="" href="/api/cli/#init">Init </a></li><li class="sidebar-item__anchor" title="Loader "><a class="" href="/api/cli/#loader">Loader </a></li><li class="sidebar-item__anchor" title="Plugin "><a class="" href="/api/cli/#plugin">Plugin </a></li><li class="sidebar-item__anchor" title="Info "><a class="" href="/api/cli/#info">Info </a></li><li class="sidebar-item__anchor" title="Configtest "><a class="" href="/api/cli/#configtest">Configtest </a></li><li class="sidebar-item__anchor" title="Serve "><a class="" href="/api/cli/#serve">Serve </a></li><li class="sidebar-item__anchor" title="Watch "><a class="" href="/api/cli/#watch">Watch </a></li></ul></li><li class="sidebar-item__anchor" title="Flags "><a class="" href="/api/cli/#flags">Flags </a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Negated Flags "><a class="" href="/api/cli/#negated-flags">Negated Flags </a></li><li class="sidebar-item__anchor" title="核心 Flags "><a class="" href="/api/cli/#core-flags">核心 Flags </a></li></ul></li><li class="sidebar-item__anchor" title="用法 "><a class="" href="/api/cli/#usage">用法 </a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="使用配置文件 "><a class="" href="/api/cli/#with-configuration-file">使用配置文件 </a></li><li class="sidebar-item__anchor" title="不使用配置文件 "><a class="" href="/api/cli/#without-configuration-file">不使用配置文件 </a></li></ul></li><li class="sidebar-item__anchor" title="默认配置 "><a class="" href="/api/cli/#default-configurations">默认配置 </a></li><li class="sidebar-item__anchor" title="通用配置 "><a class="" href="/api/cli/#common-options">通用配置 </a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="help "><a class="" href="/api/cli/#help">help </a></li><li class="sidebar-item__anchor" title="version "><a class="" href="/api/cli/#version">version </a></li><li class="sidebar-item__anchor" title="config "><a class="" href="/api/cli/#config">config </a></li><li class="sidebar-item__anchor" title="config-name "><a class="" href="/api/cli/#config-name">config-name </a></li><li class="sidebar-item__anchor" title="merge "><a class="" href="/api/cli/#merge">merge </a></li><li class="sidebar-item__anchor" title="json "><a class="" href="/api/cli/#json">json </a></li></ul></li><li class="sidebar-item__anchor" title="Environment 选项 "><a class="" href="/api/cli/#environment-options">Environment 选项 </a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="env"><a class="" href="/api/cli/#env">env</a></li><li class="sidebar-item__anchor" title="node-env "><a class="" href="/api/cli/#node-env">node-env </a></li></ul></li><li class="sidebar-item__anchor" title="配置选项 "><a class="" href="/api/cli/#configuration-options">配置选项 </a></li><li class="sidebar-item__anchor" title="分析 Bundle "><a class="" href="/api/cli/#analyzing-bundle">分析 Bundle </a></li><li class="sidebar-item__anchor" title="Progress "><a class="" href="/api/cli/#progress">Progress </a></li><li class="sidebar-item__anchor" title="将 CLI 参数传递给 Node.js "><a class="" href="/api/cli/#pass-cli-arguments-to-nodejs">将 CLI 参数传递给 Node.js </a></li><li class="sidebar-item__anchor" title="退出代码及其含义 "><a class="" href="/api/cli/#exit-codes-and-their-meanings">退出代码及其含义 </a></li><li class="sidebar-item__anchor" title="CLI 环境变量 "><a class="" href="/api/cli/#cli-environment-variables">CLI 环境变量 </a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="WEBPACK_PACKAGE "><a class="" href="/api/cli/#webpack_package">WEBPACK_PACKAGE </a></li></ul></li><li class="sidebar-item__anchor" title="Troubleshooting"><a class="" href="/api/cli/#Troubleshooting">Troubleshooting</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="TypeError [ERR_UNKNOWN_FILE_EXTENSION]: Unknown file extension &quot;.ts&quot; for ./webpack.config.ts"><a class="" href="/api/cli/#TypeError-ERR_UNKNOWN_FILE_EXTENSION-Unknown-file-extension-ts-for-webpackconfigts">TypeError [ERR_UNKNOWN_FILE_EXTENSION]: Unknown file extension &quot;.ts&quot; for ./webpack.config.ts</a></li></ul></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="m9.2 4.5 4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0"></path></svg><a class="sidebar-item__title" href="/api/node/">Node 接口</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="安装(Installation) "><a class="" href="/api/node/#installation">安装(Installation) </a></li><li class="sidebar-item__anchor" title="webpack() "><a class="" href="/api/node/#webpack">webpack() </a></li><li class="sidebar-item__anchor" title="Compiler 实例（Compiler Instance） "><a class="" href="/api/node/#compiler-instance">Compiler 实例（Compiler Instance） </a></li><li class="sidebar-item__anchor" title="执行（Run） "><a class="" href="/api/node/#run">执行（Run） </a></li><li class="sidebar-item__anchor" title="监听(Watching) "><a class="" href="/api/node/#watching">监听(Watching) </a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="关闭 Watching (Close Watching) "><a class="" href="/api/node/#close-watching">关闭 Watching (Close Watching) </a></li><li class="sidebar-item__anchor" title="Invalidate Watching "><a class="" href="/api/node/#invalidate-watching">Invalidate Watching </a></li></ul></li><li class="sidebar-item__anchor" title="Stats 对象(Stats Object) "><a class="" href="/api/node/#stats-object">Stats 对象(Stats Object) </a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="stats.hasErrors() "><a class="" href="/api/node/#statshaserrors">stats.hasErrors() </a></li><li class="sidebar-item__anchor" title="stats.hasWarnings() "><a class="" href="/api/node/#statshaswarnings">stats.hasWarnings() </a></li><li class="sidebar-item__anchor" title="stats.toJson(options) "><a class="" href="/api/node/#statstojsonoptions">stats.toJson(options) </a></li><li class="sidebar-item__anchor" title="stats.toString(options) "><a class="" href="/api/node/#statstostringoptions">stats.toString(options) </a></li></ul></li><li class="sidebar-item__anchor" title="MultiCompiler "><a class="" href="/api/node/#multicompiler">MultiCompiler </a></li><li class="sidebar-item__anchor" title="错误处理(Error Handling) "><a class="" href="/api/node/#error-handling">错误处理(Error Handling) </a></li><li class="sidebar-item__anchor" title="自定义文件系统(Custom File Systems) "><a class="" href="/api/node/#custom-file-systems">自定义文件系统(Custom File Systems) </a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="m9.2 4.5 4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0"></path></svg><a class="sidebar-item__title" href="/api/stats/">Stats Data</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="配置结构（Structure） "><a class="" href="/api/stats/#structure">配置结构（Structure） </a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Asset 对象 "><a class="" href="/api/stats/#asset-objects">Asset 对象 </a></li><li class="sidebar-item__anchor" title="Chunk 对象 "><a class="" href="/api/stats/#chunk-objects">Chunk 对象 </a></li><li class="sidebar-item__anchor" title="Module 对象 "><a class="" href="/api/stats/#module-objects">Module 对象 </a></li><li class="sidebar-item__anchor" title="Entry 对象 "><a class="" href="/api/stats/#entry-objects">Entry 对象 </a></li><li class="sidebar-item__anchor" title="错误和告警信息 "><a class="" href="/api/stats/#errors-and-warnings">错误和告警信息 </a></li></ul></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="m9.2 4.5 4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0"></path></svg><a class="sidebar-item__title" href="/api/webpack-dev-server/">webpack-dev-server API</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Installation"><a class="" href="/api/webpack-dev-server/#Installation">Installation</a></li><li class="sidebar-item__anchor" title="start"><a class="" href="/api/webpack-dev-server/#start">start</a></li><li class="sidebar-item__anchor" title="startCallback(callback)"><a class="" href="/api/webpack-dev-server/#startCallbackcallback">startCallback(callback)</a></li><li class="sidebar-item__anchor" title="stop"><a class="" href="/api/webpack-dev-server/#stop">stop</a></li><li class="sidebar-item__anchor" title="stopCallback(callback)"><a class="" href="/api/webpack-dev-server/#stopCallbackcallback">stopCallback(callback)</a></li><li class="sidebar-item__anchor" title="internalIP(family: &quot;v4&quot; | &quot;v6&quot;)"><a class="" href="/api/webpack-dev-server/#internalIPfamily-v4--v6">internalIP(family: &quot;v4&quot; | &quot;v6&quot;)</a></li><li class="sidebar-item__anchor" title="internalIPSync(family: &quot;v4&quot; | &quot;v6&quot;)"><a class="" href="/api/webpack-dev-server/#internalIPSyncfamily-v4--v6">internalIPSync(family: &quot;v4&quot; | &quot;v6&quot;)</a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="m9.2 4.5 4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0"></path></svg><a class="sidebar-item__title" href="/api/hot-module-replacement/">Hot Module Replacement</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="模块 API "><a class="" href="/api/hot-module-replacement/#module-api">模块 API </a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="accept "><a class="" href="/api/hot-module-replacement/#accept">accept </a></li><li class="sidebar-item__anchor" title="accept (self) "><a class="" href="/api/hot-module-replacement/#accept-self">accept (self) </a></li><li class="sidebar-item__anchor" title="decline "><a class="" href="/api/hot-module-replacement/#decline">decline </a></li><li class="sidebar-item__anchor" title="decline (self) "><a class="" href="/api/hot-module-replacement/#decline-self">decline (self) </a></li><li class="sidebar-item__anchor" title="dispose (or addDisposeHandler) "><a class="" href="/api/hot-module-replacement/#dispose-or-adddisposehandler">dispose (or addDisposeHandler) </a></li><li class="sidebar-item__anchor" title="invalidate "><a class="" href="/api/hot-module-replacement/#invalidate">invalidate </a></li><li class="sidebar-item__anchor" title="removeDisposeHandler "><a class="" href="/api/hot-module-replacement/#removedisposehandler">removeDisposeHandler </a></li></ul></li><li class="sidebar-item__anchor" title="API 管理 "><a class="" href="/api/hot-module-replacement/#management-api">API 管理 </a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="status "><a class="" href="/api/hot-module-replacement/#status">status </a></li><li class="sidebar-item__anchor" title="check "><a class="" href="/api/hot-module-replacement/#check">check </a></li><li class="sidebar-item__anchor" title="apply "><a class="" href="/api/hot-module-replacement/#apply">apply </a></li><li class="sidebar-item__anchor" title="addStatusHandler "><a class="" href="/api/hot-module-replacement/#addstatushandler">addStatusHandler </a></li><li class="sidebar-item__anchor" title="removeStatusHandler "><a class="" href="/api/hot-module-replacement/#removestatushandler">removeStatusHandler </a></li></ul></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="m9.2 4.5 4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0"></path></svg><a class="sidebar-item__title" href="/api/loaders/">Loader Interface</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="示例 "><a class="" href="/api/loaders/#examples">示例 </a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="同步 Loaders "><a class="" href="/api/loaders/#synchronous-loaders">同步 Loaders </a></li><li class="sidebar-item__anchor" title="异步 Loaders "><a class="" href="/api/loaders/#asynchronous-loaders">异步 Loaders </a></li><li class="sidebar-item__anchor" title="&quot;Raw&quot; Loader "><a class="" href="/api/loaders/#raw-loader">&quot;Raw&quot; Loader </a></li><li class="sidebar-item__anchor" title="Pitching Loader "><a class="" href="/api/loaders/#pitching-loader">Pitching Loader </a></li></ul></li><li class="sidebar-item__anchor" title="The Loader Context "><a class="" href="/api/loaders/#the-loader-context">The Loader Context </a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="loader 上下文示例 "><a class="" href="/api/loaders/#example-for-the-loader-context">loader 上下文示例 </a></li><li class="sidebar-item__anchor" title="this.addContextDependency "><a class="" href="/api/loaders/#thisaddcontextdependency">this.addContextDependency </a></li><li class="sidebar-item__anchor" title="this.addDependency "><a class="" href="/api/loaders/#thisadddependency">this.addDependency </a></li><li class="sidebar-item__anchor" title="this.addMissingDependency "><a class="" href="/api/loaders/#thisaddmissingdependency">this.addMissingDependency </a></li><li class="sidebar-item__anchor" title="this.async "><a class="" href="/api/loaders/#thisasync">this.async </a></li><li class="sidebar-item__anchor" title="this.cacheable "><a class="" href="/api/loaders/#thiscacheable">this.cacheable </a></li><li class="sidebar-item__anchor" title="this.callback "><a class="" href="/api/loaders/#thiscallback">this.callback </a></li><li class="sidebar-item__anchor" title="this.clearDependencies "><a class="" href="/api/loaders/#thiscleardependencies">this.clearDependencies </a></li><li class="sidebar-item__anchor" title="this.context "><a class="" href="/api/loaders/#thiscontext">this.context </a></li><li class="sidebar-item__anchor" title="this.data "><a class="" href="/api/loaders/#thisdata">this.data </a></li><li class="sidebar-item__anchor" title="this.emitError "><a class="" href="/api/loaders/#thisemiterror">this.emitError </a></li><li class="sidebar-item__anchor" title="this.emitFile "><a class="" href="/api/loaders/#thisemitfile">this.emitFile </a></li><li class="sidebar-item__anchor" title="this.emitWarning "><a class="" href="/api/loaders/#thisemitwarning">this.emitWarning </a></li><li class="sidebar-item__anchor" title="this.fs "><a class="" href="/api/loaders/#thisfs">this.fs </a></li><li class="sidebar-item__anchor" title="this.getOptions(schema) "><a class="" href="/api/loaders/#thisgetoptionsschema">this.getOptions(schema) </a></li><li class="sidebar-item__anchor" title="this.getResolve "><a class="" href="/api/loaders/#thisgetresolve">this.getResolve </a></li><li class="sidebar-item__anchor" title="this.hot "><a class="" href="/api/loaders/#thishot">this.hot </a></li><li class="sidebar-item__anchor" title="this.importModule "><a class="" href="/api/loaders/#thisimportmodule">this.importModule </a></li><li class="sidebar-item__anchor" title="this.loaderIndex "><a class="" href="/api/loaders/#thisloaderindex">this.loaderIndex </a></li><li class="sidebar-item__anchor" title="this.loadModule "><a class="" href="/api/loaders/#thisloadmodule">this.loadModule </a></li><li class="sidebar-item__anchor" title="this.loaders "><a class="" href="/api/loaders/#thisloaders">this.loaders </a></li><li class="sidebar-item__anchor" title="this.mode "><a class="" href="/api/loaders/#thismode">this.mode </a></li><li class="sidebar-item__anchor" title="this.query "><a class="" href="/api/loaders/#thisquery">this.query </a></li><li class="sidebar-item__anchor" title="this.request "><a class="" href="/api/loaders/#thisrequest">this.request </a></li><li class="sidebar-item__anchor" title="this.resolve "><a class="" href="/api/loaders/#thisresolve">this.resolve </a></li><li class="sidebar-item__anchor" title="this.resource "><a class="" href="/api/loaders/#thisresource">this.resource </a></li><li class="sidebar-item__anchor" title="this.resourcePath "><a class="" href="/api/loaders/#thisresourcepath">this.resourcePath </a></li><li class="sidebar-item__anchor" title="this.resourceQuery "><a class="" href="/api/loaders/#thisresourcequery">this.resourceQuery </a></li><li class="sidebar-item__anchor" title="this.rootContext "><a class="" href="/api/loaders/#thisrootcontext">this.rootContext </a></li><li class="sidebar-item__anchor" title="this.sourceMap "><a class="" href="/api/loaders/#thissourcemap">this.sourceMap </a></li><li class="sidebar-item__anchor" title="this.target "><a class="" href="/api/loaders/#thistarget">this.target </a></li><li class="sidebar-item__anchor" title="this.utils "><a class="" href="/api/loaders/#thisutils">this.utils </a></li><li class="sidebar-item__anchor" title="this.version "><a class="" href="/api/loaders/#thisversion">this.version </a></li><li class="sidebar-item__anchor" title="this.webpack "><a class="" href="/api/loaders/#thiswebpack">this.webpack </a></li></ul></li><li class="sidebar-item__anchor" title="Webpack 特有属性 "><a class="" href="/api/loaders/#webpack-specific-properties">Webpack 特有属性 </a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="this._compilation "><a class="" href="/api/loaders/#this_compilation">this._compilation </a></li><li class="sidebar-item__anchor" title="this._compiler "><a class="" href="/api/loaders/#this_compiler">this._compiler </a></li></ul></li><li class="sidebar-item__anchor" title="过时的上下文属性 "><a class="" href="/api/loaders/#deprecated-context-properties">过时的上下文属性 </a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="this.debug "><a class="" href="/api/loaders/#thisdebug">this.debug </a></li><li class="sidebar-item__anchor" title="this.inputValue "><a class="" href="/api/loaders/#thisinputvalue">this.inputValue </a></li><li class="sidebar-item__anchor" title="this.minimize "><a class="" href="/api/loaders/#thisminimize">this.minimize </a></li><li class="sidebar-item__anchor" title="this.value "><a class="" href="/api/loaders/#thisvalue">this.value </a></li><li class="sidebar-item__anchor" title="this._module "><a class="" href="/api/loaders/#this_module">this._module </a></li></ul></li><li class="sidebar-item__anchor" title="错误报告 "><a class="" href="/api/loaders/#error-reporting">错误报告 </a></li><li class="sidebar-item__anchor" title="Inline matchResource "><a class="" href="/api/loaders/#inline-matchresource">Inline matchResource </a></li><li class="sidebar-item__anchor" title="Logging "><a class="" href="/api/loaders/#logging">Logging </a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="m9.2 4.5 4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0"></path></svg><a class="sidebar-item__title" href="/api/logging/">Logger 接口</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Examples of how to get and use webpack logger in loaders and plugins "><a class="" href="/api/logging/#examples-of-how-to-get-and-use-webpack-logger-in-loaders-and-plugins">Examples of how to get and use webpack logger in loaders and plugins </a></li><li class="sidebar-item__anchor" title="Logger methods "><a class="" href="/api/logging/#logger-methods">Logger methods </a></li><li class="sidebar-item__anchor" title="Runtime Logger API "><a class="" href="/api/logging/#runtime-logger-api">Runtime Logger API </a></li></ul></div></div><div><h4 class="sidebar__group">Modules</h4><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="m9.2 4.5 4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0"></path></svg><a class="sidebar-item__title" href="/api/module-methods/">模块方法</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="ES6 (推荐) "><a class="" href="/api/module-methods/#es6-recommended">ES6 (推荐) </a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="import "><a class="" href="/api/module-methods/#import">import </a></li><li class="sidebar-item__anchor" title="export "><a class="" href="/api/module-methods/#export">export </a></li><li class="sidebar-item__anchor" title="import() "><a class="" href="/api/module-methods/#import">import() </a></li><li class="sidebar-item__anchor" title="import() 中的表达式 "><a class="" href="/api/module-methods/#dynamic-expressions-in-import">import() 中的表达式 </a></li></ul></li><li class="sidebar-item__anchor" title="CommonJS "><a class="" href="/api/module-methods/#commonjs">CommonJS </a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="require "><a class="" href="/api/module-methods/#require">require </a></li><li class="sidebar-item__anchor" title="require.resolve "><a class="" href="/api/module-methods/#requireresolve">require.resolve </a></li><li class="sidebar-item__anchor" title="require.cache "><a class="" href="/api/module-methods/#requirecache">require.cache </a></li><li class="sidebar-item__anchor" title="require.ensure "><a class="" href="/api/module-methods/#requireensure">require.ensure </a></li></ul></li><li class="sidebar-item__anchor" title="AMD "><a class="" href="/api/module-methods/#amd">AMD </a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="define (with factory) "><a class="" href="/api/module-methods/#define-with-factory">define (with factory) </a></li><li class="sidebar-item__anchor" title="define (with value) "><a class="" href="/api/module-methods/#define-with-value">define (with value) </a></li><li class="sidebar-item__anchor" title="require (amd-version) "><a class="" href="/api/module-methods/#require-amd-version">require (amd-version) </a></li></ul></li><li class="sidebar-item__anchor" title="标签模块(Labeled Modules) "><a class="" href="/api/module-methods/#labeled-modules">标签模块(Labeled Modules) </a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="export label "><a class="" href="/api/module-methods/#export-label">export label </a></li><li class="sidebar-item__anchor" title="require label "><a class="" href="/api/module-methods/#require-label">require label </a></li></ul></li><li class="sidebar-item__anchor" title="Webpack "><a class="" href="/api/module-methods/#webpack">Webpack </a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="require.context "><a class="" href="/api/module-methods/#requirecontext">require.context </a></li><li class="sidebar-item__anchor" title="require.include "><a class="" href="/api/module-methods/#requireinclude">require.include </a></li><li class="sidebar-item__anchor" title="require.resolveWeak "><a class="" href="/api/module-methods/#requireresolveweak">require.resolveWeak </a></li><li class="sidebar-item__anchor" title="warning"><a class="" href="/api/module-methods/#warning">warning</a></li></ul></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="m9.2 4.5 4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0"></path></svg><a class="sidebar-item__title" href="/api/module-variables/">Module Variables</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="module.loaded (NodeJS) "><a class="" href="/api/module-variables/#moduleloaded-nodejs">module.loaded (NodeJS) </a></li><li class="sidebar-item__anchor" title="module.hot (webpack-specific) "><a class="" href="/api/module-variables/#modulehot-webpack-specific">module.hot (webpack-specific) </a></li><li class="sidebar-item__anchor" title="module.id (CommonJS) "><a class="" href="/api/module-variables/#moduleid-commonjs">module.id (CommonJS) </a></li><li class="sidebar-item__anchor" title="module.exports (CommonJS) "><a class="" href="/api/module-variables/#moduleexports-commonjs">module.exports (CommonJS) </a></li><li class="sidebar-item__anchor" title="exports (CommonJS) "><a class="" href="/api/module-variables/#exports-commonjs">exports (CommonJS) </a></li><li class="sidebar-item__anchor" title="global (NodeJS) "><a class="" href="/api/module-variables/#global-nodejs">global (NodeJS) </a></li><li class="sidebar-item__anchor" title="__dirname (NodeJS) "><a class="" href="/api/module-variables/#__dirname-nodejs">__dirname (NodeJS) </a></li><li class="sidebar-item__anchor" title="import.meta.url"><a class="" href="/api/module-variables/#importmetaurl">import.meta.url</a></li><li class="sidebar-item__anchor" title="import.meta.webpack"><a class="" href="/api/module-variables/#importmetawebpack">import.meta.webpack</a></li><li class="sidebar-item__anchor" title="import.meta.webpackHot"><a class="" href="/api/module-variables/#importmetawebpackHot">import.meta.webpackHot</a></li><li class="sidebar-item__anchor" title="import.meta.webpackContext"><a class="" href="/api/module-variables/#importmetawebpackContext">import.meta.webpackContext</a></li><li class="sidebar-item__anchor" title="__filename (NodeJS)"><a class="" href="/api/module-variables/#__filename-NodeJS">__filename (NodeJS)</a></li><li class="sidebar-item__anchor" title="__resourceQuery (webpack-specific) "><a class="" href="/api/module-variables/#__resourcequery-webpack-specific">__resourceQuery (webpack-specific) </a></li><li class="sidebar-item__anchor" title="__webpack_public_path__ (webpack-specific)"><a class="" href="/api/module-variables/#__webpack_public_path__-webpack-specific">__webpack_public_path__ (webpack-specific)</a></li><li class="sidebar-item__anchor" title="__webpack_require__ (webpack-specific)"><a class="" href="/api/module-variables/#__webpack_require__-webpack-specific">__webpack_require__ (webpack-specific)</a></li><li class="sidebar-item__anchor" title="__webpack_chunk_load__ (webpack-specific)"><a class="" href="/api/module-variables/#__webpack_chunk_load__-webpack-specific">__webpack_chunk_load__ (webpack-specific)</a></li><li class="sidebar-item__anchor" title="__webpack_module__ (webpack-specific)"><a class="" href="/api/module-variables/#__webpack_module__-webpack-specific">__webpack_module__ (webpack-specific)</a></li><li class="sidebar-item__anchor" title="__webpack_module__.id (webpack-specific)"><a class="" href="/api/module-variables/#__webpack_module__id-webpack-specific">__webpack_module__.id (webpack-specific)</a></li><li class="sidebar-item__anchor" title="__webpack_modules__ (webpack-specific)"><a class="" href="/api/module-variables/#__webpack_modules__-webpack-specific">__webpack_modules__ (webpack-specific)</a></li><li class="sidebar-item__anchor" title="__webpack_hash__ (webpack-specific)"><a class="" href="/api/module-variables/#__webpack_hash__-webpack-specific">__webpack_hash__ (webpack-specific)</a></li><li class="sidebar-item__anchor" title="__webpack_get_script_filename__ (webpack-specific)"><a class="" href="/api/module-variables/#__webpack_get_script_filename__-webpack-specific">__webpack_get_script_filename__ (webpack-specific)</a></li><li class="sidebar-item__anchor" title="__non_webpack_require__ (webpack-specific)"><a class="" href="/api/module-variables/#__non_webpack_require__-webpack-specific">__non_webpack_require__ (webpack-specific)</a></li><li class="sidebar-item__anchor" title="__webpack_exports_info__ (webpack-specific)"><a class="" href="/api/module-variables/#__webpack_exports_info__-webpack-specific">__webpack_exports_info__ (webpack-specific)</a></li><li class="sidebar-item__anchor" title="__webpack_is_included__ (webpack-specific)"><a class="" href="/api/module-variables/#__webpack_is_included__-webpack-specific">__webpack_is_included__ (webpack-specific)</a></li><li class="sidebar-item__anchor" title="__webpack_base_uri__ (webpack-specific)"><a class="" href="/api/module-variables/#__webpack_base_uri__-webpack-specific">__webpack_base_uri__ (webpack-specific)</a></li><li class="sidebar-item__anchor" title="__webpack_runtime_id__"><a class="" href="/api/module-variables/#__webpack_runtime_id__">__webpack_runtime_id__</a></li><li class="sidebar-item__anchor" title="DEBUG (webpack-specific)"><a class="" href="/api/module-variables/#DEBUG-webpack-specific">DEBUG (webpack-specific)</a></li></ul></div></div><div><h4 class="sidebar__group">Objects</h4><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="m9.2 4.5 4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0"></path></svg><a class="sidebar-item__title" href="/api/compilation-object/">Compilation Object</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="compilation 对象方法 "><a class="" href="/api/compilation-object/#compilation-object-methods">compilation 对象方法 </a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="getStats "><a class="" href="/api/compilation-object/#getstats">getStats </a></li><li class="sidebar-item__anchor" title="addModule "><a class="" href="/api/compilation-object/#addmodule">addModule </a></li><li class="sidebar-item__anchor" title="getModule "><a class="" href="/api/compilation-object/#getmodule">getModule </a></li><li class="sidebar-item__anchor" title="findModule "><a class="" href="/api/compilation-object/#findmodule">findModule </a></li><li class="sidebar-item__anchor" title="buildModule "><a class="" href="/api/compilation-object/#buildmodule">buildModule </a></li><li class="sidebar-item__anchor" title="processModuleDependencies "><a class="" href="/api/compilation-object/#processmoduledependencies">processModuleDependencies </a></li><li class="sidebar-item__anchor" title="addEntry "><a class="" href="/api/compilation-object/#addentry">addEntry </a></li><li class="sidebar-item__anchor" title="rebuildModule "><a class="" href="/api/compilation-object/#rebuildmodule">rebuildModule </a></li><li class="sidebar-item__anchor" title="finish "><a class="" href="/api/compilation-object/#finish">finish </a></li><li class="sidebar-item__anchor" title="seal "><a class="" href="/api/compilation-object/#seal">seal </a></li><li class="sidebar-item__anchor" title="unseal "><a class="" href="/api/compilation-object/#unseal">unseal </a></li><li class="sidebar-item__anchor" title="reportDependencyErrorsAndWarnings "><a class="" href="/api/compilation-object/#reportdependencyerrorsandwarnings">reportDependencyErrorsAndWarnings </a></li><li class="sidebar-item__anchor" title="addChunkInGroup "><a class="" href="/api/compilation-object/#addchunkingroup">addChunkInGroup </a></li><li class="sidebar-item__anchor" title="addChunk "><a class="" href="/api/compilation-object/#addchunk">addChunk </a></li><li class="sidebar-item__anchor" title="assignDepth "><a class="" href="/api/compilation-object/#assigndepth">assignDepth </a></li><li class="sidebar-item__anchor" title="getDependencyReference "><a class="" href="/api/compilation-object/#getdependencyreference">getDependencyReference </a></li><li class="sidebar-item__anchor" title="processDependenciesBlocksForChunkGroups "><a class="" href="/api/compilation-object/#processdependenciesblocksforchunkgroups">processDependenciesBlocksForChunkGroups </a></li><li class="sidebar-item__anchor" title="removeReasonsOfDependencyBlock "><a class="" href="/api/compilation-object/#removereasonsofdependencyblock">removeReasonsOfDependencyBlock </a></li><li class="sidebar-item__anchor" title="patchChunksAfterReasonRemoval "><a class="" href="/api/compilation-object/#patchchunksafterreasonremoval">patchChunksAfterReasonRemoval </a></li><li class="sidebar-item__anchor" title="removeChunkFromDependencies "><a class="" href="/api/compilation-object/#removechunkfromdependencies">removeChunkFromDependencies </a></li><li class="sidebar-item__anchor" title="sortItemsWithChunkIds "><a class="" href="/api/compilation-object/#sortitemswithmoduleids">sortItemsWithChunkIds </a></li><li class="sidebar-item__anchor" title="summarizeDependencies "><a class="" href="/api/compilation-object/#summarizedependencies">summarizeDependencies </a></li><li class="sidebar-item__anchor" title="createHash "><a class="" href="/api/compilation-object/#createhash">createHash </a></li><li class="sidebar-item__anchor" title="createModuleAssets "><a class="" href="/api/compilation-object/#createmoduleassets">createModuleAssets </a></li><li class="sidebar-item__anchor" title="createChunkAssets "><a class="" href="/api/compilation-object/#createchunkassets">createChunkAssets </a></li><li class="sidebar-item__anchor" title="getPath "><a class="" href="/api/compilation-object/#getpath">getPath </a></li><li class="sidebar-item__anchor" title="getPathWithInfo "><a class="" href="/api/compilation-object/#getpathwithinfo">getPathWithInfo </a></li><li class="sidebar-item__anchor" title="createChildCompiler "><a class="" href="/api/compilation-object/#createchildcompiler">createChildCompiler </a></li><li class="sidebar-item__anchor" title="checkConstraints "><a class="" href="/api/compilation-object/#checkconstraints">checkConstraints </a></li><li class="sidebar-item__anchor" title="emitAsset "><a class="" href="/api/compilation-object/#emitasset">emitAsset </a></li><li class="sidebar-item__anchor" title="updateAsset "><a class="" href="/api/compilation-object/#updateasset">updateAsset </a></li><li class="sidebar-item__anchor" title="deleteAsset "><a class="" href="/api/compilation-object/#deleteasset">deleteAsset </a></li><li class="sidebar-item__anchor" title="getAssets "><a class="" href="/api/compilation-object/#getassets">getAssets </a></li><li class="sidebar-item__anchor" title="getAsset "><a class="" href="/api/compilation-object/#getasset">getAsset </a></li></ul></li></ul></div></div><div><h4 class="sidebar__group">Plugins</h4><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="m9.2 4.5 4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0"></path></svg><a class="sidebar-item__title" href="/api/compiler-hooks/">compiler 钩子</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="监听(watching) "><a class="" href="/api/compiler-hooks/#watching">监听(watching) </a></li><li class="sidebar-item__anchor" title="钩子 "><a class="" href="/api/compiler-hooks/#hooks">钩子 </a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="environment "><a class="" href="/api/compiler-hooks/#environment">environment </a></li><li class="sidebar-item__anchor" title="afterEnvironment $#afterEnvironment$"><a class="" href="/api/compiler-hooks/#afterEnvironment-afterEnvironment">afterEnvironment $#afterEnvironment$</a></li><li class="sidebar-item__anchor" title="entryOption "><a class="" href="/api/compiler-hooks/#entryoption">entryOption </a></li><li class="sidebar-item__anchor" title="afterPlugins "><a class="" href="/api/compiler-hooks/#afterplugins">afterPlugins </a></li><li class="sidebar-item__anchor" title="afterResolvers "><a class="" href="/api/compiler-hooks/#afterresolvers">afterResolvers </a></li><li class="sidebar-item__anchor" title="initialize "><a class="" href="/api/compiler-hooks/#initialize">initialize </a></li><li class="sidebar-item__anchor" title="beforeRun "><a class="" href="/api/compiler-hooks/#beforerun">beforeRun </a></li><li class="sidebar-item__anchor" title="run "><a class="" href="/api/compiler-hooks/#run">run </a></li><li class="sidebar-item__anchor" title="watchRun "><a class="" href="/api/compiler-hooks/#watchrun">watchRun </a></li><li class="sidebar-item__anchor" title="normalModuleFactory "><a class="" href="/api/compiler-hooks/#normalmodulefactory">normalModuleFactory </a></li><li class="sidebar-item__anchor" title="contextModuleFactory "><a class="" href="/api/compiler-hooks/#contextmodulefactory">contextModuleFactory </a></li><li class="sidebar-item__anchor" title="beforeCompile "><a class="" href="/api/compiler-hooks/#beforecompile">beforeCompile </a></li><li class="sidebar-item__anchor" title="compile "><a class="" href="/api/compiler-hooks/#compile">compile </a></li><li class="sidebar-item__anchor" title="thisCompilation "><a class="" href="/api/compiler-hooks/#thiscompilation">thisCompilation </a></li><li class="sidebar-item__anchor" title="compilation "><a class="" href="/api/compiler-hooks/#compilation">compilation </a></li><li class="sidebar-item__anchor" title="make "><a class="" href="/api/compiler-hooks/#make">make </a></li><li class="sidebar-item__anchor" title="afterCompile "><a class="" href="/api/compiler-hooks/#aftercompile">afterCompile </a></li><li class="sidebar-item__anchor" title="shouldEmit "><a class="" href="/api/compiler-hooks/#shouldemit">shouldEmit </a></li><li class="sidebar-item__anchor" title="emit "><a class="" href="/api/compiler-hooks/#emit">emit </a></li><li class="sidebar-item__anchor" title="afterEmit "><a class="" href="/api/compiler-hooks/#afteremit">afterEmit </a></li><li class="sidebar-item__anchor" title="assetEmitted "><a class="" href="/api/compiler-hooks/#assetemitted">assetEmitted </a></li><li class="sidebar-item__anchor" title="done "><a class="" href="/api/compiler-hooks/#done">done </a></li><li class="sidebar-item__anchor" title="additionalPass"><a class="" href="/api/compiler-hooks/#additionalPass">additionalPass</a></li><li class="sidebar-item__anchor" title="failed "><a class="" href="/api/compiler-hooks/#failed">failed </a></li><li class="sidebar-item__anchor" title="invalid "><a class="" href="/api/compiler-hooks/#invalid">invalid </a></li><li class="sidebar-item__anchor" title="watchClose "><a class="" href="/api/compiler-hooks/#watchclose">watchClose </a></li><li class="sidebar-item__anchor" title="shutdown"><a class="" href="/api/compiler-hooks/#shutdown">shutdown</a></li><li class="sidebar-item__anchor" title="infrastructureLog"><a class="" href="/api/compiler-hooks/#infrastructureLog">infrastructureLog</a></li><li class="sidebar-item__anchor" title="log "><a class="" href="/api/compiler-hooks/#log">log </a></li></ul></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="m9.2 4.5 4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0"></path></svg><a class="sidebar-item__title" href="/api/compilation-hooks/">compilation 钩子</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="buildModule "><a class="" href="/api/compilation-hooks/#buildmodule">buildModule </a></li><li class="sidebar-item__anchor" title="rebuildModule "><a class="" href="/api/compilation-hooks/#rebuildmodule">rebuildModule </a></li><li class="sidebar-item__anchor" title="failedModule "><a class="" href="/api/compilation-hooks/#failedmodule">failedModule </a></li><li class="sidebar-item__anchor" title="succeedModule "><a class="" href="/api/compilation-hooks/#succeedmodule">succeedModule </a></li><li class="sidebar-item__anchor" title="finishModules "><a class="" href="/api/compilation-hooks/#finishmodules">finishModules </a></li><li class="sidebar-item__anchor" title="finishRebuildingModule "><a class="" href="/api/compilation-hooks/#finishrebuildingmodule">finishRebuildingModule </a></li><li class="sidebar-item__anchor" title="seal "><a class="" href="/api/compilation-hooks/#seal">seal </a></li><li class="sidebar-item__anchor" title="unseal "><a class="" href="/api/compilation-hooks/#unseal">unseal </a></li><li class="sidebar-item__anchor" title="optimizeDependencies "><a class="" href="/api/compilation-hooks/#optimizedependencies">optimizeDependencies </a></li><li class="sidebar-item__anchor" title="afterOptimizeDependencies "><a class="" href="/api/compilation-hooks/#afteroptimizedependencies">afterOptimizeDependencies </a></li><li class="sidebar-item__anchor" title="optimize "><a class="" href="/api/compilation-hooks/#optimize">optimize </a></li><li class="sidebar-item__anchor" title="optimizeModules "><a class="" href="/api/compilation-hooks/#optimizemodules">optimizeModules </a></li><li class="sidebar-item__anchor" title="afterOptimizeModules "><a class="" href="/api/compilation-hooks/#afteroptimizemodules">afterOptimizeModules </a></li><li class="sidebar-item__anchor" title="optimizeChunks "><a class="" href="/api/compilation-hooks/#optimizechunks">optimizeChunks </a></li><li class="sidebar-item__anchor" title="afterOptimizeChunks "><a class="" href="/api/compilation-hooks/#afteroptimizechunks">afterOptimizeChunks </a></li><li class="sidebar-item__anchor" title="optimizeTree "><a class="" href="/api/compilation-hooks/#optimizetree">optimizeTree </a></li><li class="sidebar-item__anchor" title="afterOptimizeTree "><a class="" href="/api/compilation-hooks/#afteroptimizetree">afterOptimizeTree </a></li><li class="sidebar-item__anchor" title="optimizeChunkModules "><a class="" href="/api/compilation-hooks/#optimizechunkmodules">optimizeChunkModules </a></li><li class="sidebar-item__anchor" title="afterOptimizeChunkModules "><a class="" href="/api/compilation-hooks/#afteroptimizechunkmodules">afterOptimizeChunkModules </a></li><li class="sidebar-item__anchor" title="shouldRecord "><a class="" href="/api/compilation-hooks/#shouldrecord">shouldRecord </a></li><li class="sidebar-item__anchor" title="reviveModules "><a class="" href="/api/compilation-hooks/#revivemodules">reviveModules </a></li><li class="sidebar-item__anchor" title="beforeModuleIds "><a class="" href="/api/compilation-hooks/#beforemoduleids">beforeModuleIds </a></li><li class="sidebar-item__anchor" title="moduleIds "><a class="" href="/api/compilation-hooks/#moduleids">moduleIds </a></li><li class="sidebar-item__anchor" title="optimizeModuleIds "><a class="" href="/api/compilation-hooks/#optimizemoduleids">optimizeModuleIds </a></li><li class="sidebar-item__anchor" title="afterOptimizeModuleIds "><a class="" href="/api/compilation-hooks/#afteroptimizemoduleids">afterOptimizeModuleIds </a></li><li class="sidebar-item__anchor" title="reviveChunks "><a class="" href="/api/compilation-hooks/#revivechunks">reviveChunks </a></li><li class="sidebar-item__anchor" title="beforeChunkIds "><a class="" href="/api/compilation-hooks/#beforechunkids">beforeChunkIds </a></li><li class="sidebar-item__anchor" title="chunkIds "><a class="" href="/api/compilation-hooks/#chunkids">chunkIds </a></li><li class="sidebar-item__anchor" title="optimizeChunkIds "><a class="" href="/api/compilation-hooks/#optimizechunkids">optimizeChunkIds </a></li><li class="sidebar-item__anchor" title="afterOptimizeChunkIds "><a class="" href="/api/compilation-hooks/#afteroptimizechunkids">afterOptimizeChunkIds </a></li><li class="sidebar-item__anchor" title="recordModules "><a class="" href="/api/compilation-hooks/#recordmodules">recordModules </a></li><li class="sidebar-item__anchor" title="recordChunks "><a class="" href="/api/compilation-hooks/#recordchunks">recordChunks </a></li><li class="sidebar-item__anchor" title="beforeModuleHash "><a class="" href="/api/compilation-hooks/#beforemodulehash">beforeModuleHash </a></li><li class="sidebar-item__anchor" title="afterModuleHash "><a class="" href="/api/compilation-hooks/#aftermodulehash">afterModuleHash </a></li><li class="sidebar-item__anchor" title="beforeHash "><a class="" href="/api/compilation-hooks/#beforehash">beforeHash </a></li><li class="sidebar-item__anchor" title="afterHash "><a class="" href="/api/compilation-hooks/#afterhash">afterHash </a></li><li class="sidebar-item__anchor" title="recordHash "><a class="" href="/api/compilation-hooks/#recordhash">recordHash </a></li><li class="sidebar-item__anchor" title="record "><a class="" href="/api/compilation-hooks/#record">record </a></li><li class="sidebar-item__anchor" title="beforeModuleAssets "><a class="" href="/api/compilation-hooks/#beforemoduleassets">beforeModuleAssets </a></li><li class="sidebar-item__anchor" title="additionalChunkAssets "><a class="" href="/api/compilation-hooks/#additionalchunkassets">additionalChunkAssets </a></li><li class="sidebar-item__anchor" title="shouldGenerateChunkAssets "><a class="" href="/api/compilation-hooks/#shouldgeneratechunkassets">shouldGenerateChunkAssets </a></li><li class="sidebar-item__anchor" title="beforeChunkAssets "><a class="" href="/api/compilation-hooks/#beforechunkassets">beforeChunkAssets </a></li><li class="sidebar-item__anchor" title="additionalAssets "><a class="" href="/api/compilation-hooks/#additionalassets">additionalAssets </a></li><li class="sidebar-item__anchor" title="optimizeChunkAssets "><a class="" href="/api/compilation-hooks/#optimizechunkassets">optimizeChunkAssets </a></li><li class="sidebar-item__anchor" title="afterOptimizeChunkAssets "><a class="" href="/api/compilation-hooks/#afteroptimizechunkassets">afterOptimizeChunkAssets </a></li><li class="sidebar-item__anchor" title="optimizeAssets "><a class="" href="/api/compilation-hooks/#optimizeassets">optimizeAssets </a></li><li class="sidebar-item__anchor" title="afterOptimizeAssets "><a class="" href="/api/compilation-hooks/#afteroptimizeassets">afterOptimizeAssets </a></li><li class="sidebar-item__anchor" title="processAssets "><a class="" href="/api/compilation-hooks/#processassets">processAssets </a></li><li class="sidebar-item__anchor" title="afterProcessAssets "><a class="" href="/api/compilation-hooks/#afterprocessassets">afterProcessAssets </a></li><li class="sidebar-item__anchor" title="needAdditionalSeal "><a class="" href="/api/compilation-hooks/#needadditionalseal">needAdditionalSeal </a></li><li class="sidebar-item__anchor" title="afterSeal "><a class="" href="/api/compilation-hooks/#afterseal">afterSeal </a></li><li class="sidebar-item__anchor" title="chunkHash "><a class="" href="/api/compilation-hooks/#chunkhash">chunkHash </a></li><li class="sidebar-item__anchor" title="moduleAsset "><a class="" href="/api/compilation-hooks/#moduleasset">moduleAsset </a></li><li class="sidebar-item__anchor" title="chunkAsset "><a class="" href="/api/compilation-hooks/#chunkasset">chunkAsset </a></li><li class="sidebar-item__anchor" title="assetPath "><a class="" href="/api/compilation-hooks/#assetpath">assetPath </a></li><li class="sidebar-item__anchor" title="needAdditionalPass "><a class="" href="/api/compilation-hooks/#needadditionalpass">needAdditionalPass </a></li><li class="sidebar-item__anchor" title="childCompiler "><a class="" href="/api/compilation-hooks/#childcompiler">childCompiler </a></li><li class="sidebar-item__anchor" title="normalModuleLoader "><a class="" href="/api/compilation-hooks/#normalmoduleloader">normalModuleLoader </a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="m9.2 4.5 4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0"></path></svg><a class="sidebar-item__title" href="/api/contextmodulefactory-hooks/">ContextModuleFactory Hooks</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="beforeResolve "><a class="" href="/api/contextmodulefactory-hooks/#beforeresolve">beforeResolve </a></li><li class="sidebar-item__anchor" title="afterResolve "><a class="" href="/api/contextmodulefactory-hooks/#afterresolve">afterResolve </a></li><li class="sidebar-item__anchor" title="contextModuleFiles "><a class="" href="/api/contextmodulefactory-hooks/#contextmodulefiles">contextModuleFiles </a></li><li class="sidebar-item__anchor" title="alternativeRequests "><a class="" href="/api/contextmodulefactory-hooks/#alternativerequests">alternativeRequests </a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="m9.2 4.5 4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0"></path></svg><a class="sidebar-item__title" href="/api/parser/">JavascriptParser Hooks</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="钩子 "><a class="" href="/api/parser/#hooks">钩子 </a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="evaluateTypeof "><a class="" href="/api/parser/#evaluatetypeof">evaluateTypeof </a></li><li class="sidebar-item__anchor" title="evaluate "><a class="" href="/api/parser/#evaluate">evaluate </a></li><li class="sidebar-item__anchor" title="evaluateIdentifier "><a class="" href="/api/parser/#evaluateidentifier">evaluateIdentifier </a></li><li class="sidebar-item__anchor" title="evaluateDefinedIdentifier "><a class="" href="/api/parser/#evaluatedefinedidentifier">evaluateDefinedIdentifier </a></li><li class="sidebar-item__anchor" title="evaluateCallExpressionMember "><a class="" href="/api/parser/#evaluatecallexpressionmember">evaluateCallExpressionMember </a></li><li class="sidebar-item__anchor" title="statement "><a class="" href="/api/parser/#statement">statement </a></li><li class="sidebar-item__anchor" title="statementIf "><a class="" href="/api/parser/#statementif">statementIf </a></li><li class="sidebar-item__anchor" title="label "><a class="" href="/api/parser/#label">label </a></li><li class="sidebar-item__anchor" title="import "><a class="" href="/api/parser/#import">import </a></li><li class="sidebar-item__anchor" title="importSpecifier "><a class="" href="/api/parser/#importspecifier">importSpecifier </a></li><li class="sidebar-item__anchor" title="export "><a class="" href="/api/parser/#export">export </a></li><li class="sidebar-item__anchor" title="exportImport "><a class="" href="/api/parser/#exportimport">exportImport </a></li><li class="sidebar-item__anchor" title="exportDeclaration "><a class="" href="/api/parser/#exportdeclaration">exportDeclaration </a></li><li class="sidebar-item__anchor" title="exportExpression "><a class="" href="/api/parser/#exportexpression">exportExpression </a></li><li class="sidebar-item__anchor" title="exportSpecifier "><a class="" href="/api/parser/#exportspecifier">exportSpecifier </a></li><li class="sidebar-item__anchor" title="exportImportSpecifier "><a class="" href="/api/parser/#exportimportspecifier">exportImportSpecifier </a></li><li class="sidebar-item__anchor" title="varDeclaration "><a class="" href="/api/parser/#vardeclaration">varDeclaration </a></li><li class="sidebar-item__anchor" title="varDeclarationLet "><a class="" href="/api/parser/#vardeclarationlet">varDeclarationLet </a></li><li class="sidebar-item__anchor" title="varDeclarationConst "><a class="" href="/api/parser/#vardeclarationconst">varDeclarationConst </a></li><li class="sidebar-item__anchor" title="varDeclarationVar "><a class="" href="/api/parser/#vardeclarationvar">varDeclarationVar </a></li><li class="sidebar-item__anchor" title="canRename "><a class="" href="/api/parser/#canrename">canRename </a></li><li class="sidebar-item__anchor" title="rename "><a class="" href="/api/parser/#rename">rename </a></li><li class="sidebar-item__anchor" title="assigned "><a class="" href="/api/parser/#assigned">assigned </a></li><li class="sidebar-item__anchor" title="assign "><a class="" href="/api/parser/#assign">assign </a></li><li class="sidebar-item__anchor" title="typeof "><a class="" href="/api/parser/#typeof">typeof </a></li><li class="sidebar-item__anchor" title="call "><a class="" href="/api/parser/#call">call </a></li><li class="sidebar-item__anchor" title="callMemberChain "><a class="" href="/api/parser/#callmemberchain">callMemberChain </a></li><li class="sidebar-item__anchor" title="new "><a class="" href="/api/parser/#new">new </a></li><li class="sidebar-item__anchor" title="expression "><a class="" href="/api/parser/#expression">expression </a></li><li class="sidebar-item__anchor" title="expressionConditionalOperator "><a class="" href="/api/parser/#expressionconditionaloperator">expressionConditionalOperator </a></li><li class="sidebar-item__anchor" title="program "><a class="" href="/api/parser/#program">program </a></li></ul></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="m9.2 4.5 4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0"></path></svg><a class="sidebar-item__title" href="/api/normalmodulefactory-hooks/">NormalModuleFactory Hooks</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="beforeResolve "><a class="" href="/api/normalmodulefactory-hooks/#beforeresolve">beforeResolve </a></li><li class="sidebar-item__anchor" title="factorize "><a class="" href="/api/normalmodulefactory-hooks/#factorize">factorize </a></li><li class="sidebar-item__anchor" title="resolve "><a class="" href="/api/normalmodulefactory-hooks/#resolve">resolve </a></li><li class="sidebar-item__anchor" title="resolveForScheme "><a class="" href="/api/normalmodulefactory-hooks/#resolveforscheme">resolveForScheme </a></li><li class="sidebar-item__anchor" title="afterResolve "><a class="" href="/api/normalmodulefactory-hooks/#afterresolve">afterResolve </a></li><li class="sidebar-item__anchor" title="createModule "><a class="" href="/api/normalmodulefactory-hooks/#createmodule">createModule </a></li><li class="sidebar-item__anchor" title="module "><a class="" href="/api/normalmodulefactory-hooks/#module">module </a></li><li class="sidebar-item__anchor" title="createParser "><a class="" href="/api/normalmodulefactory-hooks/#createparser">createParser </a></li><li class="sidebar-item__anchor" title="parser "><a class="" href="/api/normalmodulefactory-hooks/#parser">parser </a></li><li class="sidebar-item__anchor" title="createGenerator "><a class="" href="/api/normalmodulefactory-hooks/#creategenerator">createGenerator </a></li><li class="sidebar-item__anchor" title="generator "><a class="" href="/api/normalmodulefactory-hooks/#generator">generator </a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="m9.2 4.5 4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0"></path></svg><a class="sidebar-item__title" href="/api/plugins/">Plugin API</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Tapable "><a class="" href="/api/plugins/#tapable">Tapable </a></li><li class="sidebar-item__anchor" title="插件类型 "><a class="" href="/api/plugins/#plugin-types">插件类型 </a></li><li class="sidebar-item__anchor" title="自定义钩子 "><a class="" href="/api/plugins/#custom-hooks">自定义钩子 </a></li><li class="sidebar-item__anchor" title="进度报告 "><a class="" href="/api/plugins/#reporting-progress">进度报告 </a></li><li class="sidebar-item__anchor" title="日志 "><a class="" href="/api/plugins/#logging">日志 </a></li><li class="sidebar-item__anchor" title="下一步 "><a class="" href="/api/plugins/#next-steps">下一步 </a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="m9.2 4.5 4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0"></path></svg><a class="sidebar-item__title" href="/api/resolvers/">解析器（Resolvers）</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="类型 "><a class="" href="/api/resolvers/#types">类型 </a></li><li class="sidebar-item__anchor" title="配置选项 "><a class="" href="/api/resolvers/#configuration-options">配置选项 </a></li></ul></div></div></div></nav><section class="page"><div class="markdown"><h1>Printable</h1><div id="md-content"><h1><span id="简介"></span>简介<a href="#%E7%AE%80%E4%BB%8B" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1>
<p>Webpack 提供了多种接口来自定义编译过程。
接口间存在一些重叠功能，例如配置选项可能通过 CLI 标志启用，
而其他仅存在于单个接口。
以下概念可以帮助你快速入门。</p><h2><span id="cli"></span>CLI<a href="#cli" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>命令行界面（CLI），
用于配置构建并与之交互。它在早期原型制作和性能分析的情况下特别有用。
大多数情况下，
CLI 只是用于通过配置文件和一些标志（例如<code>--env</code>）来启动进程。</p><p><a href="/api/cli">了解更多关于 CLI 的知识！</a></p><h2><span id="module"></span>模块<a href="#module" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>使用 webpack 处理模块时，
最重要的是理解不同的模块语法 -
特别是受支持的<a href="/api/module-methods">方法</a>和<a href="/api/module-variables">变量</a>。</p><p><a href="/api/module-methods">了解更多关于模块的知识！</a></p><h2><span id="node"></span>Node<a href="#node" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>尽管大多数用户可以借助 CLI 和配置文件控制编译，
通过 Node 接口可以实现更细粒度的控制。
这包括传递多个配置、
以程序的方式运行、查阅并收集统计信息。</p><p><a href="/api/node">了解更多关于 Node API 的知识！</a></p><h2><span id="loaders"></span>Loaders<a href="#loaders" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>Loaders 用于对模块的源代码进行转换。
它们被编写成一类将源代码作为参数传入，
并将编译转换后的新版本代码传出的函数体。</p><p><a href="/api/loaders">了解更多关于 loaders 的知识！</a></p><h2><span id="plugins"></span>插件<a href="#plugins" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>插件接口允许用户直接介入编译过程。
插件可以在不同时期运行的生命周期挂钩上注册回调函数。
在单个编译流程中，当每个钩子都被执行后，插件将拥有
当前编译流程的完整访问权限。</p><p><a href="/api/plugins">了解更多关于插件的知识！</a></p><h1><span id="命令行接口CLI"></span>命令行接口（CLI）<a href="#%E5%91%BD%E4%BB%A4%E8%A1%8C%E6%8E%A5%E5%8F%A3CLI" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1>
<p>为了更合适且方便地使用配置，可以在 <code>webpack.config.js</code> 中对 webpack 进行配置。CLI 中传入的任何参数会在配置文件中映射为对应的参数。</p><p>如果你还没有安装过 webpack 和 CLI，请先阅读 <a href="/guides/installation">安装指南</a>。</p><aside class="warning"><h6 class="warning__prefix">警告</h6><p>如果你想使用 <code>npx</code> 来运行 webpack，请确保你已经安装了 <code>webpack-cli</code>。</p></aside><h2><span id="commands"></span>命令<a href="#commands" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>webpack-cli 提供了许多命令来使 webpack 的工作变得更简单。默认情况下，webpack 提供了以下命令：</p><table><thead><tr><th>Command</th><th>Usage</th><th>Description</th></tr></thead><tbody><tr><td data-th="Command"><span><a href="#build"><code>build</code></a></span></td><td data-th="Usage"><span><code>build|bundle|b [entries...] [options]</code></span></td><td data-th="Description"><span>Run webpack (default command, can be omitted).</span></td></tr><tr><td data-th="Command"><span><a href="#configtest"><code>configtest</code></a></span></td><td data-th="Usage"><span><code>configtest|t [config-path]</code></span></td><td data-th="Description"><span>Validate a webpack configuration.</span></td></tr><tr><td data-th="Command"><span><a href="#help"><code>help</code></a></span></td><td data-th="Usage"><span><code>help|h [command] [option]</code></span></td><td data-th="Description"><span>Display help for commands and options.</span></td></tr><tr><td data-th="Command"><span><a href="#info"><code>info</code></a></span></td><td data-th="Usage"><span><code>info|i [options]</code></span></td><td data-th="Description"><span>Outputs information about your system.</span></td></tr><tr><td data-th="Command"><span><a href="#init"><code>init</code></a></span></td><td data-th="Usage"><span><code>init|create|c|new|n [generation-path] [options]</code></span></td><td data-th="Description"><span>Initialize a new webpack project.</span></td></tr><tr><td data-th="Command"><span><a href="#loader"><code>loader</code></a></span></td><td data-th="Usage"><span><code>loader|l [output-path] [options]</code></span></td><td data-th="Description"><span>Scaffold a loader.</span></td></tr><tr><td data-th="Command"><span><a href="#plugin"><code>plugin</code></a></span></td><td data-th="Usage"><span><code>plugin|p [output-path] [options]</code></span></td><td data-th="Description"><span>Scaffold a plugin.</span></td></tr><tr><td data-th="Command"><span><a href="#serve"><code>serve</code></a></span></td><td data-th="Usage"><span><code>serve|server|s [options]</code></span></td><td data-th="Description"><span>Run the <code>webpack-dev-server</code>.</span></td></tr><tr><td data-th="Command"><span><a href="#version"><code>version</code></a></span></td><td data-th="Usage"><span><code>version|v [commands...]</code></span></td><td data-th="Description"><span>Output the version number of <code>webpack</code>, <code>webpack-cli</code> and <code>webpack-dev-server</code>.</span></td></tr><tr><td data-th="Command"><span><a href="#watch"><code>watch</code></a></span></td><td data-th="Usage"><span><code>watch|w [entries...] [options]</code></span></td><td data-th="Description"><span>Run webpack and watch for files changes.</span></td></tr></tbody></table><h3><span id="build"></span>Build<a href="#build" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>运行 webpack（默认命令，可用输出文件）。</p><pre><code class="hljs language-bash">npx webpack build <span class="token punctuation">[</span>options<span class="token punctuation">]</span></code></pre><p><strong>示例</strong></p><pre><code class="hljs language-bash">npx webpack build --config ./webpack.config.js --stats verbose</code></pre><h3><span id="init"></span>Init<a href="#init" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>用于初始化一个新的 webpack 项目。</p><pre><code class="hljs language-bash">npx webpack init <span class="token punctuation">[</span>generation-path<span class="token punctuation">]</span> <span class="token punctuation">[</span>options<span class="token punctuation">]</span></code></pre><p><strong>example</strong></p><pre><code class="hljs language-bash">npx webpack init ./my-app --force --template<span class="token operator">=</span>default</code></pre><h4><span id="generation-path"></span>生成路径<a href="#generation-path" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4><p>生成配置的位置。默认为 <code>process.cwd()</code>。</p><h4><span id="options"></span>配置<a href="#options" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4><p><strong><code>-t</code>, <code>--template</code></strong></p><p><code>string = &#x27;default&#x27;</code></p><p>要生成的模板名称。</p><p><strong><code>-f</code>, <code>--force</code></strong></p><p><code>boolean</code></p><p>不输入配置项就生成一个项目。该配置启用时所有命令行配置项将使用默认值。</p><aside class="tip"><h6 class="tip__prefix">提示</h6><p>点击 <a href="https://github.com/webpack/webpack-cli/blob/master/packages/generators/INIT.md">这里</a> 获取 <code>webpack init</code> 命令的完整文档。</p></aside><h3><span id="loader"></span>Loader<a href="#loader" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>初始化一个 loader。</p><pre><code class="hljs language-bash">npx webpack loader <span class="token punctuation">[</span>output-path<span class="token punctuation">]</span> <span class="token punctuation">[</span>options<span class="token punctuation">]</span></code></pre><p><strong>示例</strong></p><pre><code class="hljs language-bash">npx webpack loader ./my-loader --template<span class="token operator">=</span>default</code></pre><h4><span id="outputpath"></span>Output Path<a href="#outputpath" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4><p>输出文件夹，例如 <code>./loader-name</code>。</p><h4><span id="options"></span>Options<a href="#options" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4><p><strong><code>-t</code>, <code>--template</code></strong></p><p><code>string = &#x27;default&#x27;</code></p><p>模板类型。</p><h3><span id="plugin"></span>Plugin<a href="#plugin" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>初始化一个插件。</p><pre><code class="hljs language-bash">npx webpack plugin <span class="token punctuation">[</span>output-path<span class="token punctuation">]</span> <span class="token punctuation">[</span>options<span class="token punctuation">]</span></code></pre><p><strong>示例</strong></p><pre><code class="hljs language-bash">npx webpack plugin ./my-plugin --template<span class="token operator">=</span>default</code></pre><h4><span id="outputpath"></span>Output Path<a href="#outputpath" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4><p>输出文件夹，例如 <code>./plugin-name</code>.</p><h4><span id="options"></span>Options<a href="#options" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4><p><strong><code>-t</code>, <code>--template</code></strong></p><p><code>string = &#x27;default&#x27;</code></p><p>模板类型。</p><h3><span id="info"></span>Info<a href="#info" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>输出你的系统信息。</p><pre><code class="hljs language-bash">npx webpack info <span class="token punctuation">[</span>options<span class="token punctuation">]</span></code></pre><p><strong>示例</strong></p><pre><code class="hljs language-bash">npx webpack info --output json --addition-package postcss</code></pre><h4><span id="optionsforinfo"></span>info 配置项<a href="#optionsforinfo" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4><p><strong><code>-a</code>, <code>--additional-package</code></strong></p><p><code>string</code></p><p>在输出信息中添加额外的包。</p><p><strong>example</strong></p><pre><code class="hljs language-bash">npx webpack info --additional-package postcss</code></pre><p><strong><code>-o</code>, <code>--output</code></strong></p><p><code>string : &#x27;json&#x27; | &#x27;markdown&#x27;</code></p><p>获取指定格式的输出。</p><p><strong>示例</strong></p><pre><code class="hljs language-bash">npx webpack info --output markdown</code></pre><h3><span id="configtest"></span>Configtest<a href="#configtest" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>校验 webpack 配置。</p><pre><code class="hljs language-bash">npx webpack configtest <span class="token punctuation">[</span>config-path<span class="token punctuation">]</span></code></pre><p><strong>示例</strong></p><pre><code class="hljs language-bash">npx webpack configtest ./webpack.config.js</code></pre><h4><span id="configpath"></span>Config Path<a href="#configpath" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4><p>你的 webpack 配置文件路径。默认为 <code>./webpack.config.js</code>。</p><h3><span id="serve"></span>Serve<a href="#serve" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>运行 webpack 开发服务器。</p><pre><code class="hljs language-bash">npx webpack serve <span class="token punctuation">[</span>options<span class="token punctuation">]</span></code></pre><p><strong>示例</strong></p><pre><code class="hljs language-bash">npx webpack serve --static --open</code></pre><aside class="tip"><h6 class="tip__prefix">提示</h6><p>查看 <a href="https://github.com/webpack/webpack-cli/blob/master/SERVE-OPTIONS-v4.md"><code>webpack serve</code> 命令的所有可用配置项</a> 和 <a href="/configuration/dev-server">webpack-dev-server 的相关文档</a>。</p></aside><h3><span id="watch"></span>Watch<a href="#watch" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>运行 webpack 并且监听文件变化。</p><pre><code class="hljs language-bash">npx webpack <span class="token function">watch</span> <span class="token punctuation">[</span>options<span class="token punctuation">]</span></code></pre><p><strong>示例</strong></p><pre><code class="hljs language-bash">npx webpack <span class="token function">watch</span> --mode development</code></pre><h2><span id="flags"></span>Flags<a href="#flags" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>默认情况下，webpack 提供了以下 flag：</p><table><thead><tr><th>Flag / 别名</th><th>类型</th><th>描述</th></tr></thead><tbody><tr><td data-th="Flag / 别名"><span><code>--entry</code></span></td><td data-th="类型"><span>string[]</span></td><td data-th="描述"><span>应用程序的入口文件，例如 <code>./src/main.js</code></span></td></tr><tr><td data-th="Flag / 别名"><span><code>--config, -c</code></span></td><td data-th="类型"><span>string[]</span></td><td data-th="描述"><span>提供 webpack 配置文件的路径，例如 <code>./webpack.config.js</code></span></td></tr><tr><td data-th="Flag / 别名"><span><code>--config-name</code></span></td><td data-th="类型"><span>string[]</span></td><td data-th="描述"><span>要使用的配置名</span></td></tr><tr><td data-th="Flag / 别名"><span><code>--name</code></span></td><td data-th="类型"><span>string</span></td><td data-th="描述"><span>配置名称，在加载多个配置时使用</span></td></tr><tr><td data-th="Flag / 别名"><span><code>--color</code></span></td><td data-th="类型"><span>boolean</span></td><td data-th="描述"><span>启用控制台颜色</span></td></tr><tr><td data-th="Flag / 别名"><span><code>--merge, -m</code></span></td><td data-th="类型"><span>boolean</span></td><td data-th="描述"><span>使用 webpack-merge 合并两个配置文件，例如 <code>-c ./webpack.config.js -c ./webpack.test.config.js</code></span></td></tr><tr><td data-th="Flag / 别名"><span><code>--env</code></span></td><td data-th="类型"><span>string[]</span></td><td data-th="描述"><span>当它是一个函数时，传递给配置的环境变量</span></td></tr><tr><td data-th="Flag / 别名"><span><code>--progress</code></span></td><td data-th="类型"><span>boolean, string</span></td><td data-th="描述"><span>在构建过程中打印编译进度</span></td></tr><tr><td data-th="Flag / 别名"><span><code>--help</code></span></td><td data-th="类型"><span>boolean</span></td><td data-th="描述"><span>输出所有支持的 flag 和命令</span></td></tr><tr><td data-th="Flag / 别名"><span><code>--output-path, -o</code></span></td><td data-th="类型"><span>string</span></td><td data-th="描述"><span>webpack 生成文件的输出位置，例如 <code>./dist</code></span></td></tr><tr><td data-th="Flag / 别名"><span><code>--target, -t</code></span></td><td data-th="类型"><span>string[]</span></td><td data-th="描述"><span>设置要构建的 target</span></td></tr><tr><td data-th="Flag / 别名"><span><code>--watch, -w</code></span></td><td data-th="类型"><span>boolean</span></td><td data-th="描述"><span>监听文件变化</span></td></tr><tr><td data-th="Flag / 别名"><span><code>--watch-options-stdin</code></span></td><td data-th="类型"><span>boolean</span></td><td data-th="描述"><span>stdin stream 结束时，停止监听</span></td></tr><tr><td data-th="Flag / 别名"><span><code>--hot, -h</code></span></td><td data-th="类型"><span>boolean</span></td><td data-th="描述"><span>启用 HMR</span></td></tr><tr><td data-th="Flag / 别名"><span><code>--devtool, -d</code></span></td><td data-th="类型"><span>string</span></td><td data-th="描述"><span>控制是否生成 source map，以及如何生成</span></td></tr><tr><td data-th="Flag / 别名"><span><code>--prefetch</code></span></td><td data-th="类型"><span>string</span></td><td data-th="描述"><span>预先发生请求</span></td></tr><tr><td data-th="Flag / 别名"><span><code>--json, -j</code></span></td><td data-th="类型"><span>boolean, string</span></td><td data-th="描述"><span>将结果打印成 JSON 格式或存储在文件中</span></td></tr><tr><td data-th="Flag / 别名"><span><code>--mode</code></span></td><td data-th="类型"><span>string</span></td><td data-th="描述"><span>定义 webpack 所需的 mode</span></td></tr><tr><td data-th="Flag / 别名"><span><code>--version, -v</code></span></td><td data-th="类型"><span>boolean</span></td><td data-th="描述"><span>获取当前 cli 版本</span></td></tr><tr><td data-th="Flag / 别名"><span><code>--stats</code></span></td><td data-th="类型"><span>boolean, string</span></td><td data-th="描述"><span>它告诉 webpack 如何处理 stats</span></td></tr><tr><td data-th="Flag / 别名"><span><code>--analyze</code></span></td><td data-th="类型"><span>boolean</span></td><td data-th="描述"><span>它调用 <code>webpack-bundle-analyzer</code> 插件来获取 bundle 信息</span></td></tr></tbody></table><h3><span id="negated-flags"></span>Negated Flags<a href="#negated-flags" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><table><thead><tr><th>Flag</th><th>描述</th></tr></thead><tbody><tr><td data-th="Flag"><span>--no-color</span></td><td data-th="描述"><span>禁用控制台颜色</span></td></tr><tr><td data-th="Flag"><span>--no-hot</span></td><td data-th="描述"><span>如果你通过配置启用了 HMR，则禁用它</span></td></tr><tr><td data-th="Flag"><span>--no-stats</span></td><td data-th="描述"><span>禁用任何由 webpack emit 出来的 stats</span></td></tr><tr><td data-th="Flag"><span>--no-watch</span></td><td data-th="描述"><span>禁用文件变更的监听</span></td></tr><tr><td data-th="Flag"><span>--no-devtool</span></td><td data-th="描述"><span>禁止生成 source maps</span></td></tr></tbody></table><h3><span id="core-flags"></span>核心 Flags<a href="#core-flags" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>从 CLI v4 和 webpack v5 开始，CLI 将采用从 webpack 的 core 中导入整个配置的模式，允许 CLI 调整几乎所有配置项。</p><p><strong>链接中是 webpack v5 和 CLI v4 支持的所有核心 flag 列表 - <a href="https://github.com/webpack/webpack-cli/blob/master/OPTIONS.md">详戳</a></strong></p><p>例如，如果你想在项目中启用性能提示，你需在配置中使用<a href="/configuration/performance/#performancehints">此</a>选项，而如果使用核心 flag，你可以这样做：</p><pre><code class="hljs language-bash">npx webpack --performance-hints warning</code></pre><h2><span id="usage"></span>用法<a href="#usage" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><h3><span id="with-configuration-file"></span>使用配置文件<a href="#with-configuration-file" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><pre><code class="hljs language-bash">npx webpack <span class="token punctuation">[</span>--config webpack.config.js<span class="token punctuation">]</span></code></pre><p>配置文件中的相关选项，请参阅<a href="/configuration">配置</a>。</p><h3><span id="without-configuration-file"></span>不使用配置文件<a href="#without-configuration-file" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><pre><code class="hljs language-bash">npx webpack --entry <span class="token operator">&lt;</span>entry<span class="token operator">&gt;</span> --output-path <span class="token operator">&lt;</span>output-path<span class="token operator">&gt;</span></code></pre><p><strong>example</strong></p><pre><code class="hljs language-bash">npx webpack --entry ./first.js --entry ./second.js --output-path /build</code></pre><h4><span id="entry"></span>entry<a href="#entry" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4><p>构建项目时入口可以配置一个文件名或一组被命名过的文件名。你可以传递多个入口（每个入口在启动时加载）。
如下是通过 CLI 指定 entry 的多种方式：</p><pre><code class="hljs language-bash">npx webpack ./first-entry.js</code></pre><pre><code class="hljs language-bash">npx webpack --entry ./first-entry.js</code></pre><pre><code class="hljs language-bash">npx webpack ./first-entry.js ./other-entry.js</code></pre><pre><code class="hljs language-bash">npx webpack --entry ./first-entry.js ./other-entry.js</code></pre><aside class="tip"><h6 class="tip__prefix">提示</h6><p>使用 <code>webpack [command] [entries...] [option]</code> 语法，主要是因为某些选项支持接受多个值。因此，你可以用 <code>webpack --target node ./entry.js</code> 表示 <code>target: [&#x27;node&#x27;, &#x27;./entry.js&#x27;]</code>。</p></aside><h4><span id="output-path"></span>output-path<a href="#output-path" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4><p>用于存储构建后的文件路径。它将映射到配置选项 <code>output.path</code>。</p><p><strong>示例</strong></p><p>假设你的项目结构像下面这样：</p><pre><code class="hljs language-bash"><span class="token builtin class-name">.</span>
├── dist
├── index.html
└── src
    ├── index.js
    ├── index2.js
    └── others.js</code></pre><pre><code class="hljs language-bash">npx webpack ./src/index.js --output-path dist</code></pre><p>这将对源码进行打包，其入口为 <code>index.js</code>，且 bundle 文件的输出路径为 <code>dist</code>。</p><pre><code class="hljs language-bash">asset main.js <span class="token number">142</span> bytes <span class="token punctuation">[</span>compared <span class="token keyword">for</span> emit<span class="token punctuation">]</span> <span class="token punctuation">[</span>minimized<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: main<span class="token punctuation">)</span>
./src/index.js <span class="token number">30</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
./src/others.js <span class="token number">1</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
webpack <span class="token number">5.1</span>.0 compiled successfully <span class="token keyword">in</span> <span class="token number">187</span> ms</code></pre><pre><code class="hljs language-bash">npx webpack ./src/index.js ./src/others2.js --output-path dist/</code></pre><p>以多个入口的方式打包文件</p><pre><code class="hljs language-bash">asset main.js <span class="token number">142</span> bytes <span class="token punctuation">[</span>compared <span class="token keyword">for</span> emit<span class="token punctuation">]</span> <span class="token punctuation">[</span>minimized<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: main<span class="token punctuation">)</span>
./src/index.js <span class="token number">30</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
./src/others2.js <span class="token number">1</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
./src/others.js <span class="token number">1</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
webpack <span class="token number">5.1</span>.0 compiled successfully <span class="token keyword">in</span> <span class="token number">198</span> ms</code></pre><h2><span id="default-configurations"></span>默认配置<a href="#default-configurations" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>CLI 会在你的项目路径中寻找默认配置，以下是 CLI 采集到的配置文件。</p><p>此处按顺序递增进行优先级查询：</p><blockquote><p>示例 —— 配置文件的查找顺序 .webpack/webpackfile &gt; .webpack/webpack.config.js &gt; webpack.config.js</p></blockquote><pre><code class="hljs language-txt">&#x27;webpack.config&#x27;,
&#x27;.webpack/webpack.config&#x27;,
&#x27;.webpack/webpackfile&#x27;,
</code></pre><h2><span id="common-options"></span>通用配置<a href="#common-options" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><aside class="warning"><h6 class="warning__prefix">警告</h6><p>注意，命令行接口（Command Line Interface）参数的优先级，高于配置文件参数。例如，如果将 <a href="/configuration/mode/#usage"><code>--mode=&quot;production&quot;</code></a> 传入 webpack CLI，而配置文件使用的是 <code>development</code>，最终会使用 <code>production</code>。</p></aside><h3><span id="help"></span>help<a href="#help" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><strong>列出命令行可用的基础命令和 flag</strong></p><p>通过 <code>webpack help [command] [option]</code> 以及 <code>webpack [command] --help</code> 均可获得帮助信息：</p><pre><code class="hljs language-bash">npx webpack --help

<span class="token comment"># or</span>

npx webpack <span class="token builtin class-name">help</span></code></pre><p><strong>列出所有 cli 支持的命令和 flag</strong></p><pre><code class="hljs language-bash">npx webpack --help<span class="token operator">=</span>verbose</code></pre><p><strong>查看特定命令或选项的帮助</strong>：</p><pre><code class="hljs language-bash">npx webpack <span class="token builtin class-name">help</span> --mode</code></pre><h3><span id="version"></span>version<a href="#version" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><strong>显示已安装的 package 以及子 package 的版本</strong>。</p><p>如需检查你正在使用的 <code>webpack</code> 和 <code>webpack-cli</code> 的版本，只需运行如下命令：</p><pre><code class="hljs language-bash">npx webpack --version

<span class="token comment"># or</span>

npx webpack version</code></pre><p>运行结果如下：</p><pre><code class="hljs language-bash">webpack <span class="token number">5.31</span>.2
webpack-cli <span class="token number">4.6</span>.0</code></pre><p>若已安装 <code>webpack-dev-server</code>，其版本信息会一并输出：</p><pre><code class="hljs language-bash">webpack <span class="token number">5.31</span>.2
webpack-cli <span class="token number">4.6</span>.0
webpack-dev-server <span class="token number">3.11</span>.2</code></pre><p>如需检查 <code>webpack-cli</code> 子包的版本（如 <code>@webpack-cli/info</code>），只需运行如下命令：</p><pre><code class="hljs language-bash">npx webpack info --version</code></pre><p>运行结果如下：</p><pre><code class="hljs language-bash">@webpack-cli/info <span class="token number">1.2</span>.3
webpack <span class="token number">5.31</span>.2
webpack-cli <span class="token number">4.6</span>.0
webpack-dev-server <span class="token number">3.11</span>.2</code></pre><h3><span id="config"></span>config<a href="#config" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><strong>使用配置文件进行构建</strong></p><p>配置文件默认为 <code>webpack.config.js</code>，还可以指定其它的<a href="/configuration">配置</a>文件。</p><pre><code class="hljs language-bash">npx webpack --config example.config.js</code></pre><h3><span id="config-name"></span>config-name<a href="#config-name" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>如果你的配置文件导出了多个配置，你可以使用 <code>--config-name</code> 来指定要运行的配置。</p><p>如果你的 <code>webpack.config.js</code> 如下：</p><pre><code class="hljs language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    output<span class="token operator">:</span> <span class="token punctuation">{</span>
      filename<span class="token operator">:</span> <span class="token string">&#x27;./dist-first.js&#x27;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token string">&#x27;first&#x27;</span><span class="token punctuation">,</span>
    entry<span class="token operator">:</span> <span class="token string">&#x27;./src/first.js&#x27;</span><span class="token punctuation">,</span>
    mode<span class="token operator">:</span> <span class="token string">&#x27;development&#x27;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    output<span class="token operator">:</span> <span class="token punctuation">{</span>
      filename<span class="token operator">:</span> <span class="token string">&#x27;./dist-second.js&#x27;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token string">&#x27;second&#x27;</span><span class="token punctuation">,</span>
    entry<span class="token operator">:</span> <span class="token string">&#x27;./src/second.js&#x27;</span><span class="token punctuation">,</span>
    mode<span class="token operator">:</span> <span class="token string">&#x27;development&#x27;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    output<span class="token operator">:</span> <span class="token punctuation">{</span>
      filename<span class="token operator">:</span> <span class="token string">&#x27;./dist-third.js&#x27;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token string">&#x27;third&#x27;</span><span class="token punctuation">,</span>
    entry<span class="token operator">:</span> <span class="token string">&#x27;./src/third.js&#x27;</span><span class="token punctuation">,</span>
    mode<span class="token operator">:</span> <span class="token string">&#x27;none&#x27;</span><span class="token punctuation">,</span>
    stats<span class="token operator">:</span> <span class="token string">&#x27;verbose&#x27;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span></code></pre><p>并且只想运行第二个配置项：</p><pre><code class="hljs language-bash">npx webpack --config-name second</code></pre><p>你也可以传递多个值来实现：</p><pre><code class="hljs language-bash">npx webpack --config-name first --config-name second</code></pre><h3><span id="merge"></span>merge<a href="#merge" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>你可以通过 <code>--merge</code> 选项来合并两个或多个不同的 webpack 配置：</p><pre><code class="hljs language-bash">npx webpack --config ./first.js --config ./second.js --merge</code></pre><h3><span id="json"></span>json<a href="#json" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><strong>以 JSON 格式输出 webpack 的运行结果</strong></p><pre><code class="hljs language-bash">npx webpack --json</code></pre><p><strong>如果你想把 stats 数据存储为 JSON 而非输出，你可以使用：</strong></p><pre><code class="hljs language-bash">npx webpack --json stats.json</code></pre><p>在其他情况下，webpack 会打印出 bundle、chunk 以及 timing 细节的 stats 信息。使用此选项，会输出 JSON 对象。这个输出结果可以被 webpack 的 <a href="https://webpack.github.io/analyse/">analyse 工具</a>，或者 chrisbateman 的 <a href="https://chrisbateman.github.io/webpack-visualizer/">webpack-visualizer</a>，再或者 th0r 的 <a href="https://github.com/webpack-contrib/webpack-bundle-analyzer">webpack-bundle-analyzer</a> 所识别。analyse 工具会接收 JSON，并以图形的形式展示所有构建的细节。</p><aside class="tip"><h6 class="tip__prefix">提示</h6><p>请查阅 <a href="/api/stats">stats 数据 api</a>，了解更多关于生成的 stats 数据。</p></aside><h2><span id="environment-options"></span>Environment 选项<a href="#environment-options" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>当 webpack 配置<a href="/configuration/configuration-types/#exporting-a-function">导出为函数时</a>，会接收到一个 &quot;environment&quot; 的参数。</p><h3><span id="env"></span>env<a href="#env" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><pre><code class="hljs language-bash">npx webpack --env production    <span class="token comment"># env.production = true</span></code></pre><p><code>--env</code> 参数可以接收多个值：</p><table><thead><tr><th>Invocation</th><th>Resulting environment</th></tr></thead><tbody><tr><td data-th="Invocation"><span><code>npx webpack --env prod</code></span></td><td data-th="Resulting environment"><span><code>{ prod: true }</code></span></td></tr><tr><td data-th="Invocation"><span><code>npx webpack --env prod --env min</code></span></td><td data-th="Resulting environment"><span><code>{ prod: true, min: true }</code></span></td></tr><tr><td data-th="Invocation"><span><code>npx webpack --env platform=app --env production</code></span></td><td data-th="Resulting environment"><span><code>{ platform: &quot;app&quot;, production: true }</code></span></td></tr><tr><td data-th="Invocation"><span><code>npx webpack --env foo=bar=app</code></span></td><td data-th="Resulting environment"><span><code>{ foo: &quot;bar=app&quot;}</code></span></td></tr><tr><td data-th="Invocation"><span><code>npx webpack --env app.platform=&quot;staging&quot; --env app.name=&quot;test&quot;</code></span></td><td data-th="Resulting environment"><span><code>{ app: { platform: &quot;staging&quot;, name: &quot;test&quot; }</code></span></td></tr></tbody></table><aside class="tip"><h6 class="tip__prefix">提示</h6><p>如果你想将一个变量设置为空字符串（<code>&quot;&quot;</code>），你可能需要在终端上转义字符，就像这样：<code>npx webpack --env foo=\&quot;\&quot;</code></p></aside><aside class="tip"><h6 class="tip__prefix">提示</h6><p>请查阅 <a href="/guides/environment-variables/">environment 变量指南</a>了解更多信息及用法。</p></aside><p>除了上面所说的自定义 <code>env</code> 变量，在你的 webpack 配置中也使用了一些 <code>env</code> 内置变量：</p><table><thead><tr><th>变量名</th><th>描述</th></tr></thead><tbody><tr><td data-th="变量名"><span><code>WEBPACK_SERVE</code></span></td><td data-th="描述"><span>如果使用了 <code>serve|server|s</code>，则为 <code>true</code>。</span></td></tr><tr><td data-th="变量名"><span><code>WEBPACK_BUILD</code></span></td><td data-th="描述"><span>如果使用了 <code>build|bundle|b</code>，则为 <code>true</code>。</span></td></tr><tr><td data-th="变量名"><span><code>WEBPACK_WATCH</code></span></td><td data-th="描述"><span>如果使用了 <code>--watch|watch|w</code>，则为 <code>true</code>。</span></td></tr></tbody></table><p>请注意你不能在 bundle 代码中使用这些内置环境变量。</p><pre><code class="hljs language-javascript">module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">env<span class="token punctuation">,</span> argv</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    mode<span class="token operator">:</span> env<span class="token punctuation">.</span><span class="token constant">WEBPACK_SERVE</span> <span class="token operator">?</span> <span class="token string">&#x27;development&#x27;</span> <span class="token operator">:</span> <span class="token string">&#x27;production&#x27;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><h3><span id="node-env"></span>node-env<a href="#node-env" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>你可以使用 <code>--node-env</code> 选项来设置 <code>process.env.NODE_ENV</code>:</p><pre><code class="hljs language-bash">npx webpack --node-env production   <span class="token comment"># process.env.NODE_ENV = &#x27;production&#x27;</span></code></pre><aside class="tip"><h6 class="tip__prefix">提示</h6><p>如果你不明确的设置 mode，<code>mode</code> 选项的值会被 <code>--node-env</code> 覆盖。例如 <code>--node-env production</code> 时，会把 <code>process.env.NODE_ENV</code> 和 <code>mode</code> 均设置为 <code>&#x27;production&#x27;</code>。</p></aside><h2><span id="configuration-options"></span>配置选项<a href="#configuration-options" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><table><thead><tr><th>参数</th><th>说明</th><th>输入类型</th><th>默认值</th></tr></thead><tbody><tr><td data-th="参数"><span><code>--config</code></span></td><td data-th="说明"><span>配置文件的路径</span></td><td data-th="输入类型"><span>string[]</span></td><td data-th="默认值"><span><a href="/api/cli/#default-configurations">默认配置</a></span></td></tr><tr><td data-th="参数"><span><code>--config-name</code></span></td><td data-th="说明"><span>要使用的配置名</span></td><td data-th="输入类型"><span>string[]</span></td><td></td></tr><tr><td data-th="参数"><span><code>--env</code></span></td><td data-th="说明"><span>当配置文件为函数时，environment 将作为参数传递给配置</span></td><td data-th="输入类型"><span>string[]</span></td><td></td></tr></tbody></table><h2><span id="analyzing-bundle"></span>分析 Bundle<a href="#analyzing-bundle" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>你可以使用 <code>webpack-bundle-analyzer</code> 插件来分析你 webpack 输出的 bundle。你还可以通过 CLI 的 <code>--analyze</code> flag 调用它</p><pre><code class="hljs language-bash">npx webpack --analyze</code></pre><aside class="warning"><h6 class="warning__prefix">警告</h6><p>请确保你的项目中安装了 <code>webpack-bundle-analyzer</code>，否则 CLI 会提示你安装它。</p></aside><h2><span id="progress"></span>Progress<a href="#progress" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>如需查看 webpack 的编译进度，你可以使用 <code>--progress</code> flag。</p><pre><code class="hljs language-bash">npx webpack --progress</code></pre><p>如需收集编译过程中每一步的 profile 数据，你可以将 <code>profile</code> 作为值传递给 <code>--progress</code> flag。</p><pre><code class="hljs language-bash">npx webpack --progress<span class="token operator">=</span>profile</code></pre><h2><span id="pass-cli-arguments-to-nodejs"></span>将 CLI 参数传递给 Node.js<a href="#pass-cli-arguments-to-nodejs" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>将参数直接传递给 Node.js 进程，你可以使用 <code>NODE_OPTIONS</code> 选项。</p><p>例如，将 Node.js 进程的内存限制增加到 4 GB。</p><pre><code class="hljs language-bash"><span class="token assign-left variable">NODE_OPTIONS</span><span class="token operator">=</span><span class="token string">&quot;--max-old-space-size=4096&quot;</span> webpack</code></pre><p>此外，你也可以将多个选项传递给 Node.js 进程。</p><pre><code class="hljs language-bash"><span class="token assign-left variable">NODE_OPTIONS</span><span class="token operator">=</span><span class="token string">&quot;--max-old-space-size=4096 -r /path/to/preload/file.js&quot;</span> webpack</code></pre><h2><span id="exit-codes-and-their-meanings"></span>退出代码及其含义<a href="#exit-codes-and-their-meanings" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><table><thead><tr><th>退出代码</th><th>描述</th></tr></thead><tbody><tr><td data-th="退出代码"><span><code>0</code></span></td><td data-th="描述"><span>成功</span></td></tr><tr><td data-th="退出代码"><span><code>1</code></span></td><td data-th="描述"><span>webpack Error</span></td></tr><tr><td data-th="退出代码"><span><code>2</code></span></td><td data-th="描述"><span>配置/选项问题，或者内部错误</span></td></tr></tbody></table><h2><span id="cli-environment-variables"></span>CLI 环境变量<a href="#cli-environment-variables" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><table><thead><tr><th>环境变量</th><th>描述</th></tr></thead><tbody><tr><td data-th="环境变量"><span><code>WEBPACK_CLI_SKIP_IMPORT_LOCAL</code></span></td><td data-th="描述"><span>设置为 <code>true</code> 时将不会使用 <code>webpack-cli</code> 本地实例。</span></td></tr><tr><td data-th="环境变量"><span><code>WEBPACK_CLI_FORCE_LOAD_ESM_CONFIG</code></span></td><td data-th="描述"><span>设置为 <code>true</code> 则强制加载 ESM 配置。</span></td></tr><tr><td data-th="环境变量"><span><a href="#webpack_package"><code>WEBPACK_PACKAGE</code></a></span></td><td data-th="描述"><span>在 CLI 中使用自定义 webpack 版本。</span></td></tr><tr><td data-th="环境变量"><span><code>WEBPACK_DEV_SERVER_PACKAGE</code></span></td><td data-th="描述"><span>在 CLI 中使用自定义 webpack-dev-server 版本。</span></td></tr><tr><td data-th="环境变量"><span><code>WEBPACK_CLI_HELP_WIDTH</code></span></td><td data-th="描述"><span>用于帮助输出的自定义宽度。</span></td></tr></tbody></table><pre><code class="hljs language-bash"><span class="token assign-left variable">WEBPACK_CLI_FORCE_LOAD_ESM_CONFIG</span><span class="token operator">=</span>true npx webpack --config ./webpack.config.esm</code></pre><h3><span id="webpack_package"></span>WEBPACK_PACKAGE<a href="#webpack_package" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>在 CLI 中使用自定义 webpack 版本。在你的 <code>package.json</code> 中配置以下内容：</p><pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">&quot;webpack&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^4.0.0&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;webpack-5&quot;</span><span class="token operator">:</span> <span class="token string">&quot;npm:webpack@^5.32.0&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;webpack-cli&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^4.5.0&quot;</span>
<span class="token punctuation">}</span></code></pre><p>使用 <code>webpack v4.0.0</code>：</p><pre><code class="hljs language-bash">npx webpack</code></pre><p>使用 <code>webpack v5.32.0</code>：</p><pre><code class="hljs language-bash"><span class="token assign-left variable">WEBPACK_PACKAGE</span><span class="token operator">=</span>webpack-5 npx webpack</code></pre><h2><span id="Troubleshooting"></span>Troubleshooting<a href="#Troubleshooting" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><h3><span id="TypeError-ERR_UNKNOWN_FILE_EXTENSION-Unknown-file-extension-ts-for-webpackconfigts"></span>TypeError [ERR_UNKNOWN_FILE_EXTENSION]: Unknown file extension &quot;.ts&quot; for ./webpack.config.ts<a href="#TypeError-ERR_UNKNOWN_FILE_EXTENSION-Unknown-file-extension-ts-for-webpackconfigts" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>You might encounter this error in the case of using native ESM in TypeScript (i.e. <code>type: &quot;module&quot;</code> in <code>package.json</code>).</p><p><code>webpack-cli</code> supports configuration in both <code>CommonJS</code> and <code>ESM</code> format, at first it tries to load a configuration using <code>require()</code>, once it fails with an error code of <code>&#x27;ERR_REQUIRE_ESM&#x27;</code> (a special code for this case) it would try to load the configuration using <code>import()</code>.
However, the <code>import()</code> method won&#x27;t work with <code>ts-node</code> without <a href="https://nodejs.org/api/esm.html#esm_experimental_loaders">loader hooks</a> enabled (described at <a href="https://github.com/TypeStrong/ts-node/issues/1007"><code>TypeStrong/ts-node#1007</code></a>).</p><p>To fix the error above use the following command:</p><pre><code class="hljs language-bash"><span class="token assign-left variable">NODE_OPTIONS</span><span class="token operator">=</span><span class="token string">&quot;--loader ts-node/esm&quot;</span> npx webpack --entry ./src/index.js --mode production</code></pre><p>For more information, see our documentation on <a href="/configuration/configuration-languages/#typescript">writing a webpack configuration in <code>TypeScript</code></a>.</p><h1><span id="Node-接口"></span>Node 接口<a href="#Node-%E6%8E%A5%E5%8F%A3" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1>
<p>Webpack 提供了 Node.js API，可以在 Node.js 运行时下直接使用。</p><p>当你需要自定义构建或开发流程时，Node.js API 非常有用，因为此时所有的报告和错误处理都必须自行实现，webpack 仅仅负责编译的部分。所以 <a href="/configuration/stats"><code>stats</code></a> 配置选项不会在 <code>webpack()</code> 调用中生效。</p><h2><span id="installation"></span>安装(Installation)<a href="#installation" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>开始使用 webpack 的 Node.js API 之前，首先你需要安装 webpack：</p><pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev webpack</code></pre><p>在 Node.js 文件中，引入 webpack 模块:</p><pre><code class="hljs language-js"><span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;webpack&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>或者如果你更喜欢 ES2015:</p><pre><code class="hljs language-js"><span class="token keyword">import</span> webpack <span class="token keyword">from</span> <span class="token string">&#x27;webpack&#x27;</span><span class="token punctuation">;</span></code></pre><h2><span id="webpack"></span>webpack()<a href="#webpack" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>导入的 <code>webpack</code> 函数会将 <a href="/configuration/">配置对象</a> 传给 webpack，如果同时传入回调函数会在 webpack compiler 运行时被执行:</p><pre><code class="hljs language-js"><span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;webpack&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">webpack</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> stats</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>err <span class="token operator">||</span> stats<span class="token punctuation">.</span><span class="token function">hasErrors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 处理完成</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><aside class="tip"><h6 class="tip__prefix">提示</h6><p><code>err</code>对象 <strong>不包含</strong> 编译错误，必须使用 <code>stats.hasErrors()</code> 单独处理，文档的 <a href="#error-handling">错误处理</a> 将对这部分进行详细介绍。<code>err</code> 对象只包含 webpack 相关的问题，例如配置错误等。</p></aside><aside class="tip"><h6 class="tip__prefix">提示</h6><p>你也可以为 <code>webpack</code> 函数提供一个配置数组。更多详细信息，请查看 <a href="#multicompiler">MultiCompiler</a> 章节。</p></aside><h2><span id="compiler-instance"></span>Compiler 实例（Compiler Instance）<a href="#compiler-instance" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>如果你不向 <code>webpack</code> 传入可执行的回调函数，
它会返回一个 webpack <code>Compiler</code> 实例。
你可以通过手动执行它或者为它的构建时添加一个监听器，
就像 <a href="/api/cli/">CLI</a> 类似。<code>Compiler</code> 实例提供了以下方法:</p><ul><li><code>.run(callback)</code></li><li><code>.watch(watchOptions, handler)</code></li></ul><p>通常情况下，仅会创建一个主要 <code>Compiler</code> 实例，
虽然可以创建一些子 compiler 来代理到特定任务。
<code>Compiler</code> 基本上只是执行最低限度的功能，以维持生命周期运行的功能。
它将所有的加载、打包和写入工作，
都委托到注册过的插件上。</p><p><code>Compiler</code> 实例上的 <code>hooks</code> 属性，用于将一个插件注册
到 <code>Compiler</code> 的生命周期中的所有钩子事件上。
<code>webpack</code> 使用
<a href="https://github.com/webpack/webpack/blob/master/lib/WebpackOptionsDefaulter.js"><code>WebpackOptionsDefaulter</code></a>
和 <a href="https://github.com/webpack/webpack/blob/master/lib/WebpackOptionsApply.js"><code>WebpackOptionsApply</code></a>
来配置 <code>Compiler</code> 实例以及所有内置插件。</p><p>使用 <code>run</code> 方法启动所有编译工作。
完成之后，执行传入的的 <code>callback</code> 函数。
最终记录下来的概括信息（stats）和错误（errors），都应在这个 callback 函数中获取。</p><aside class="warning"><h6 class="warning__prefix">警告</h6><p>这个 API 一次仅支持一个编译。当使用 <code>run</code> 或者
<code>watch</code> 时，调用 <code>close</code>，并等待它完成后再次执行 <code>run</code> 或者 <code>watch</code>。
并发编译将破坏输出文件。</p></aside><h2><span id="run"></span>执行（Run）<a href="#run" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>调用 <code>Compiler</code> 实例的 <code>run</code> 方法跟上文提到的
快速执行方法很类似：</p><pre><code class="hljs language-js"><span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;webpack&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> compiler <span class="token operator">=</span> <span class="token function">webpack</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

compiler<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> stats</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>

  compiler<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">closeErr</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><aside class="warning"><h6 class="warning__prefix">警告</h6><p>不要忘记关闭编译器，这样低优先级的工作（比如持久缓存）就有机会完成。</p></aside><h2><span id="watching"></span>监听(Watching)<a href="#watching" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>调用 <code>watch</code> 方法会触发 webpack 执行，但之后会监听变更（很像 CLI 命令: <code>webpack --watch</code>），
一旦 webpack 检测到文件变更，就会重新执行编译。
该方法返回一个 <code>Watching</code> 实例。</p><pre><code class="hljs language-js"><span class="token function">watch</span><span class="token punctuation">(</span>watchOptions<span class="token punctuation">,</span> callback<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><pre><code class="hljs language-js"><span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;webpack&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> compiler <span class="token operator">=</span> <span class="token function">webpack</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> watching <span class="token operator">=</span> compiler<span class="token punctuation">.</span><span class="token function">watch</span><span class="token punctuation">(</span>
  <span class="token punctuation">{</span>
    <span class="token comment">// 示例</span>
    aggregateTimeout<span class="token operator">:</span> <span class="token number">300</span><span class="token punctuation">,</span>
    poll<span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> stats</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 这里打印 watch/build 结果...</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>stats<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><code>Watching</code> 配置选项的细节可以在
<a href="/configuration/watch/#watchoptions">这里</a>查询。</p><aside class="warning"><h6 class="warning__prefix">警告</h6><p>文件系统不正确的问题，可能会对单次修改触发多次构建。
因此，在上面的示例中，一次修改可能会多次触发 <code>console.log</code> 语句。
用户应该预知此行为，
并且可能需要检查 <code>stats.hash</code> 来查看文件哈希是否确实变更。</p></aside><h3><span id="close-watching"></span>关闭 <code>Watching</code> (Close <code>Watching</code>)<a href="#close-watching" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>watch</code> 方法返回一个 <code>Watching</code> 实例，该实例会暴露一个 <code>.close(callback)</code> 方法。
调用该方法将会结束监听:</p><pre><code class="hljs language-js">watching<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">closeErr</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#x27;Watching Ended.&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><aside class="warning"><h6 class="warning__prefix">警告</h6><p>不允许在监听器关闭或者失效前
再次监听或执行。</p></aside><h3><span id="invalidate-watching"></span>Invalidate <code>Watching</code><a href="#invalidate-watching" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>使用 <code>watching.invalidate</code>，你可以手动使当前编译循环（compiling round）无效，
而不会停止监听进程（process）：</p><pre><code class="hljs language-js">watching<span class="token punctuation">.</span><span class="token function">invalidate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h2><span id="stats-object"></span>Stats 对象(Stats Object)<a href="#stats-object" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p><code>stats</code> 对象会被作为 <a href="#webpack"><code>webpack()</code></a> 回调函数的第二个参数传递，
可以通过它获取到代码编译过程中的有用信息，
包括：</p><ul><li>错误和警告(如果有的话)</li><li>计时信息</li><li>module 和 chunk 信息</li></ul><p><a href="/api/cli">webpack CLI</a> 正是基于这些信息在控制台
展示友好的格式输出。</p><aside class="tip"><h6 class="tip__prefix">提示</h6><p>当使用 <a href="#multicompiler"><code>MultiCompiler</code></a> 时，
会返回一个 <code>MultiStats</code> 实例，
它实现与 <code>stats</code> 相同的接口，也就是下面描述的方法。</p></aside><p><code>stats</code> 对象暴露了以下方法:</p><h3><span id="statshaserrors"></span>stats.hasErrors()<a href="#statshaserrors" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>可以用来检查编译期是否有错误，
返回值为 <code>true</code> 或 <code>false</code>。</p><h3><span id="statshaswarnings"></span>stats.hasWarnings()<a href="#statshaswarnings" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>可以用来检查编译期是否有警告，
返回值为 <code>true</code> 或 <code>false</code>。</p><h3><span id="statstojsonoptions"></span>stats.toJson(options)<a href="#statstojsonoptions" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>以 JSON 对象形式返回编译信息。
<code>options</code> 可以是一个字符串（预设值）或是颗粒化控制的对象:</p><pre><code class="hljs language-js">stats<span class="token punctuation">.</span><span class="token function">toJson</span><span class="token punctuation">(</span><span class="token string">&#x27;minimal&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><pre><code class="hljs language-js">stats<span class="token punctuation">.</span><span class="token function">toJson</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  assets<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  hash<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>所有可用的配置选项和预设值都可查询 stats <a href="/configuration/stats">文档</a>。</p><blockquote><p>这里有</p></blockquote><p>该函数输出的</p><blockquote><p><a href="https://raw.githubusercontent.com/webpack/analyse/master/app/pages/upload/example2.json">示例</a>。</p></blockquote><h3><span id="statstostringoptions"></span>stats.toString(options)<a href="#statstostringoptions" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>以格式化的字符串形式返回描述编译信息
（类似 <a href="/api/cli">CLI</a> 的输出）。</p><p>配置对象与 <a href="/api/node/#statstojsonoptions"><code>stats.toJson(options)</code></a> 一致，除了额外增加的一个选项:</p><pre><code class="hljs language-js">stats<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// 增加控制台颜色开关</span>
  colors<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>下面是 <code>stats.toString()</code> 用法的示例:</p><pre><code class="hljs language-js"><span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;webpack&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">webpack</span><span class="token punctuation">(</span>
  <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> stats</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>
      stats<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        chunks<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 使构建过程更静默无输出</span>
        colors<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>  <span class="token comment">// 在控制台展示颜色</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h2><span id="multicompiler"></span>MultiCompiler<a href="#multicompiler" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p><code>MultiCompiler</code> 模块可以让 webpack 同时执行多个配置。
如果传给 webpack 的 Node.js API 的 <code>options</code> 参数，
该参数由是由多个配置对象构成的数组，webpack 会相应地创建多个 compiler 实例，
并且在所有 compiler 执行完毕后调用 <code>callback</code> 方法。</p><pre><code class="hljs language-js"><span class="token keyword">var</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;webpack&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">webpack</span><span class="token punctuation">(</span>
  <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> entry<span class="token operator">:</span> <span class="token string">&#x27;./index1.js&#x27;</span><span class="token punctuation">,</span> output<span class="token operator">:</span> <span class="token punctuation">{</span> filename<span class="token operator">:</span> <span class="token string">&#x27;bundle1.js&#x27;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> entry<span class="token operator">:</span> <span class="token string">&#x27;./index2.js&#x27;</span><span class="token punctuation">,</span> output<span class="token operator">:</span> <span class="token punctuation">{</span> filename<span class="token operator">:</span> <span class="token string">&#x27;bundle2.js&#x27;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> stats</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    process<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>stats<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#x27;\n&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><aside class="warning"><h6 class="warning__prefix">警告</h6><p>多个配置对象在执行时，<strong>不会并行执行</strong>。
每个配置都只会在前一个处理结束后，
才进行处理。</p></aside><h2><span id="error-handling"></span>错误处理(Error Handling)<a href="#error-handling" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>完备的错误处理中需要考虑以下三种类型的错误:</p><ul><li>致命的 wepback 错误（配置出错等）</li><li>编译错误（缺失的 module，语法错误等）</li><li>编译警告</li></ul><p>下面是一个覆盖这些场景的示例:</p><pre><code class="hljs language-js"><span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;webpack&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">webpack</span><span class="token punctuation">(</span>
  <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> stats</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>stack <span class="token operator">||</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">.</span>details<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>details<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">const</span> info <span class="token operator">=</span> stats<span class="token punctuation">.</span><span class="token function">toJson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>stats<span class="token punctuation">.</span><span class="token function">hasErrors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>info<span class="token punctuation">.</span>errors<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>stats<span class="token punctuation">.</span><span class="token function">hasWarnings</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span>info<span class="token punctuation">.</span>warnings<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Log result...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h2><span id="custom-file-systems"></span>自定义文件系统(Custom File Systems)<a href="#custom-file-systems" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>默认情况下，webpack 使用普通文件系统来读取文件并将文件写入磁盘。
但是，还可以使用不同类型的文件系统（内存(memory), webDAV 等）来更改输入或输出行为。
为了实现这一点，
可以改变 <code>inputFileSystem</code> 或 <code>outputFileSystem</code>。
例如，可以使用 <a href="https://github.com/streamich/memfs"><code>memfs</code></a> 替换默认的 <code>outputFileSystem</code>，
以将文件写入到内存中，
而不是写入到磁盘:</p><pre><code class="hljs language-js"><span class="token keyword">const</span> <span class="token punctuation">{</span> createFsFromVolume<span class="token punctuation">,</span> Volume <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;memfs&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;webpack&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">createFsFromVolume</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Volume</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> compiler <span class="token operator">=</span> <span class="token function">webpack</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">/* options */</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

compiler<span class="token punctuation">.</span>outputFileSystem <span class="token operator">=</span> fs<span class="token punctuation">;</span>
compiler<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> stats</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 之后读取输出:</span>
  <span class="token keyword">const</span> content <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">&#x27;...&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  compiler<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">closeErr</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>值得一提的是，被
<a href="https://github.com/webpack/webpack-dev-server">webpack-dev-server</a>
及众多其他包依赖的
<a href="https://github.com/webpack/webpack-dev-middleware">webpack-dev-middleware</a> 就是通过这种方式，
将你的文件神秘地隐藏起来，但却仍然可以用它们为浏览器提供服务！</p><aside class="tip"><h6 class="tip__prefix">提示</h6><p>你指定的输出文件系统需要
兼容 Node 自身的 <a href="https://nodejs.org/api/fs.html"><code>fs</code></a> 模块接口，
接口需要提供 <code>mkdirp</code> 和 <code>join</code> 工具方法。</p></aside><h1><span id="Stats-Data"></span>Stats Data<a href="#Stats-Data" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1>
<p>使用 <code>webpack</code> 编译源码时，用户可以生成一个包含模块统计信息的 <code>JSON</code> 文件。这些统计信息可以用来分析应用中的依赖关系图，从而优化 <code>webpack</code> 的编译速度。该文件通常由以下 <code>CLI</code> 命令生成：</p><pre><code class="hljs language-bash">npx webpack --profile --json<span class="token operator">=</span>compilation-stats.json</code></pre><p><code>--json=compilation-stats.json</code> 标志告诉 <code>webpack</code> 生成一个包含依赖关系图和其他各种构建信息的 <code>compilation-stats.json</code> 文件。通常情况下，<code>--profile</code> 标志也会被添加，这样的话每个 <a href="#module-objects"><code>module</code> objects</a> 都会增加一个 <code>profile</code> 部分，它包含了特定模块的统计信息。</p><h2><span id="structure"></span>配置结构（Structure）<a href="#structure" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>输出 JSON 文件的顶层结构相当简单，但是也包含部分嵌套的数据结构。为了让文档更易于使用，每个嵌套的数据结构都有对应的一小节来讲，注意，你可以点击如下的链接，跳转到相关章节查看文档：</p><pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;5.9.0&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 用来编译的 webpack 版本</span>
  <span class="token property">&quot;hash&quot;</span><span class="token operator">:</span> <span class="token string">&quot;11593e3b3ac85436984a&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 编译的特定哈希值</span>
  <span class="token property">&quot;time&quot;</span><span class="token operator">:</span> <span class="token number">2469</span><span class="token punctuation">,</span> <span class="token comment">// 编译时间（毫秒）</span>
  <span class="token property">&quot;publicPath&quot;</span><span class="token operator">:</span> <span class="token string">&quot;auto&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;outputPath&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> <span class="token comment">// webpack 的输出目录路径</span>
  <span class="token property">&quot;assetsByChunkName&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 输出资源对应的 Chunk 名称</span>
    <span class="token property">&quot;main&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">&quot;web.js?h=11593e3b3ac85436984a&quot;</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;named-chunk&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">&quot;named-chunk.web.js&quot;</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;other-chunk&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">&quot;other-chunk.js&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;other-chunk.css&quot;</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;assets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// asset objects 列表</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;chunks&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// chunk objects 列表</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;modules&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// module objects 列表</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;entryPoints&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// entry objects 列表</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;errors&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// error objects 列表</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;errorsCount&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// 错误个数</span>
  <span class="token property">&quot;warnings&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// warning objects 列表</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;warningsCount&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// 告警个数</span>
<span class="token punctuation">}</span></code></pre><h3><span id="asset-objects"></span>Asset 对象<a href="#asset-objects" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>每个 <code>assets</code> 对象表示编译过程中生成的 <code>output</code> 文件。它们都遵循类似的结构：</p><pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">&quot;chunkNames&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 该资源文件包含的 chunks</span>
  <span class="token property">&quot;chunks&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">6</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 该资源文件包含的 chunk ID</span>
  <span class="token property">&quot;comparedForEmit&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 指定是否对该资源文件和输出文件系统上相同文件进行比较</span>
  <span class="token property">&quot;emitted&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 指定资源文件是否要生成到 `output` 目录中</span>
  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;10.web.js&quot;</span><span class="token punctuation">,</span> <span class="token comment">// `output` 文件名</span>
  <span class="token property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">1058</span><span class="token punctuation">,</span> <span class="token comment">// 文件大小（字节为单位）</span>
  <span class="token property">&quot;info&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;immutable&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 指定 asset 是否可以长期缓存的标志位（包括哈希值）</span>
    <span class="token property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">1058</span><span class="token punctuation">,</span> <span class="token comment">// 单位大小为字节，只有在资源文件生成之后才可以使用</span>
    <span class="token property">&quot;development&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 指定 asset 是否只用于 development 环境，而不面向用户的标志位</span>
    <span class="token property">&quot;hotModuleReplacement&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 指定 asset 是否加载用于更新现有应用程序 (HMR) 的数据标志位</span>
    <span class="token property">&quot;sourceFilename&quot;</span><span class="token operator">:</span> <span class="token string">&quot;originalfile.js&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 从源文件创建资产时（可能转换）sourceFilename</span>
    <span class="token property">&quot;javascriptModule&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">// 当 asset 是 javascript 和 ESM 时为 true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><aside class="tip"><h6 class="tip__prefix">提示</h6><p>从 webpack v4.40.0 版本开始，Asset 的 <code>info</code> 属性可用</p></aside><h3><span id="chunk-objects"></span>Chunk 对象<a href="#chunk-objects" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>每个 <code>chunks</code> 对象代表一组名为 <a href="/glossary/#c">chunk</a> 的模块。每个对象都遵循如下结构：</p><pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">&quot;entry&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 指定 webpack 运行时是否包含 chunk</span>
  <span class="token property">&quot;files&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// 包含 chunk 的文件名字符数组</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;filteredModules&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// 查看关于 [top-level structure](#structure) 描述</span>
  <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// chunk 对应的 ID</span>
  <span class="token property">&quot;initial&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 指定 chunk 是在页面初始化时加载还是[按需加载](/guides/lazy-loading)</span>
  <span class="token property">&quot;modules&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// [module objects](#module-objects) 列表</span>
    <span class="token string">&quot;web.js?h=11593e3b3ac85436984a&quot;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;names&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// 包含当前 chunk 的 chunk 名称列表</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;origins&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// 查看后面的描述...</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;parents&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 父级 chunk ID</span>
  <span class="token property">&quot;rendered&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 指定 chunk 是否经过代码生成</span>
  <span class="token property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">188057</span> <span class="token comment">// chunk 大小，单位字节</span>
<span class="token punctuation">}</span></code></pre><p><code>chunks</code> 对象还包含一个 <code>origins</code> 列表，它描述来给定的 chunk 每个 <code>origins</code> 对象都遵循以下模式：</p><pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">&quot;loc&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 生成当前 chunk 的代码行</span>
  <span class="token property">&quot;module&quot;</span><span class="token operator">:</span> <span class="token string">&quot;(webpack)\\test\\browsertest\\lib\\index.web.js&quot;</span><span class="token punctuation">,</span> <span class="token comment">// module的路径</span>
  <span class="token property">&quot;moduleId&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// module 对应的 ID</span>
  <span class="token property">&quot;moduleIdentifier&quot;</span><span class="token operator">:</span> <span class="token string">&quot;(webpack)\\test\\browsertest\\lib\\index.web.js&quot;</span><span class="token punctuation">,</span> <span class="token comment">// module 对应的路径</span>
  <span class="token property">&quot;moduleName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./lib/index.web.js&quot;</span><span class="token punctuation">,</span> <span class="token comment">// module对应的相对路径</span>
  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;main&quot;</span><span class="token punctuation">,</span> <span class="token comment">// chunk 名称</span>
  <span class="token property">&quot;reasons&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// 在 [module objects](#module-objects) 中找到相同的 `reason` 列表</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span></code></pre><h3><span id="module-objects"></span>Module 对象<a href="#module-objects" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>假如不描述编译后的应用程序的实际模块，这些统计的数据有什么作用？其依赖关系图中的每个模块用如下结构表示：</p><pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">&quot;assets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// [asset objects](#asset-objects) 列表</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;built&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 指定该模块经过 [Loaders](/concepts/loaders)、解析和代码生成</span>
  <span class="token property">&quot;cacheable&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 是否可以缓存</span>
  <span class="token property">&quot;chunks&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// 当前模块包含的 chunk ID</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;errors&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// 解析或处理模块时的错误个数</span>
  <span class="token property">&quot;failed&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 当前模块编译是否失败</span>
  <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// 模块 ID (类似于 [`module.id`](/api/module-variables/#moduleid-commonjs))</span>
  <span class="token property">&quot;identifier&quot;</span><span class="token operator">:</span> <span class="token string">&quot;(webpack)\\test\\browsertest\\lib\\index.web.js&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 内部使用的唯一 ID</span>
  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./lib/index.web.js&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 实际文件的路径</span>
  <span class="token property">&quot;optional&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 对当前模块的所有请求都带上 `try... catch` blocks (与 ESM 无关)</span>
  <span class="token property">&quot;prefetched&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 指定模块是否被 [prefetched](/plugins/prefetch-plugin)</span>
  <span class="token property">&quot;profile&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 对应于 [`--profile` 标志位](/api/cli/#profiling) 的模块特定编译统计（以毫秒为单位）</span>
    <span class="token property">&quot;building&quot;</span><span class="token operator">:</span> <span class="token number">73</span><span class="token punctuation">,</span> <span class="token comment">// 加载和解析</span>
    <span class="token property">&quot;dependencies&quot;</span><span class="token operator">:</span> <span class="token number">242</span><span class="token punctuation">,</span> <span class="token comment">// 构建依赖</span>
    <span class="token property">&quot;factory&quot;</span><span class="token operator">:</span> <span class="token number">11</span> <span class="token comment">// 解析依赖关系</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;reasons&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// 查看下面的描述...</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">3593</span><span class="token punctuation">,</span> <span class="token comment">// 预估模块大小，单位为字节</span>
  <span class="token property">&quot;source&quot;</span><span class="token operator">:</span> <span class="token string">&quot;// 不要改变它...\r\nif(typeof...&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 字符串的原始源头</span>
  <span class="token property">&quot;warnings&quot;</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token comment">// 解析或处理模块时的警告数</span>
<span class="token punctuation">}</span></code></pre><p>每个模块还包含了一个 <code>reasons</code> 列表，它描述了为什么该模块会被包含在依赖关系图中。每个 <code>reason</code> 都类似于上面的 <a href="#chunk-objects">chunk objects</a> 章节的 <code>origins</code>：</p><pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">&quot;loc&quot;</span><span class="token operator">:</span> <span class="token string">&quot;33:24-93&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 当前模块包含的代码行数</span>
  <span class="token property">&quot;module&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./lib/index.web.js&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 基于 [context](/configuration/entry-context/#context) 的模块相对路径</span>
  <span class="token property">&quot;moduleId&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// 模块对应的 ID</span>
  <span class="token property">&quot;moduleIdentifier&quot;</span><span class="token operator">:</span> <span class="token string">&quot;(webpack)\\test\\browsertest\\lib\\index.web.js&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 模块对应路径</span>
  <span class="token property">&quot;moduleName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./lib/index.web.js&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 可读性更高的模块名称</span>
  <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;require.context&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 使用的 [请求类型](/api/module-methods)</span>
  <span class="token property">&quot;userRequest&quot;</span><span class="token operator">:</span> <span class="token string">&quot;../../cases&quot;</span> <span class="token comment">// 用于 `import` 或者 `require` 请求的原始字符串</span>
<span class="token punctuation">}</span></code></pre><h3><span id="entry-objects"></span>Entry 对象<a href="#entry-objects" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><pre><code class="hljs language-json"><span class="token property">&quot;main&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;main&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;chunks&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token number">179</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;assets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;main.js&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">22</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;filteredAssets&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">&quot;assetsSize&quot;</span><span class="token operator">:</span> <span class="token number">22</span><span class="token punctuation">,</span>
  <span class="token property">&quot;auxiliaryAssets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;filteredAuxiliaryAssets&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">&quot;auxiliaryAssetsSize&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">&quot;children&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;childAssets&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;isOverSizeLimit&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span></code></pre><h3><span id="errors-and-warnings"></span>错误和告警信息<a href="#errors-and-warnings" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>包含 <code>errors</code> and <code>warnings</code> 属性的一个对象列表。每个对象包含一条消息，一个堆栈跟踪信息和其他各种属性：</p><pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">&quot;moduleIdentifier&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\Repos\\webpack\\test\\cases\\context\\issue-5750\\index.js&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;moduleName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;(webpack)/test/cases/context/issue-5750/index.js&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;loc&quot;</span><span class="token operator">:</span> <span class="token string">&quot;3:8-47&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Critical dependency: Contexts can&#x27;t use RegExps with the &#x27;g&#x27; or &#x27;y&#x27; flags.&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;moduleId&quot;</span><span class="token operator">:</span> <span class="token number">29595</span><span class="token punctuation">,</span>
  <span class="token property">&quot;moduleTrace&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;originIdentifier&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\Repos\\webpack\\test\\cases|sync|/^\\.\\/[^/]+\\/[^/]+\\/index\\.js$/&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;originName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;(webpack)/test/cases sync ^\\.\\/[^/]+\\/[^/]+\\/index\\.js$&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;moduleIdentifier&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\Repos\\webpack\\test\\cases\\context\\issue-5750\\index.js&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;moduleName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;(webpack)/test/cases/context/issue-5750/index.js&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;dependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;loc&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./context/issue-5750/index.js&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">&quot;originId&quot;</span><span class="token operator">:</span> <span class="token number">32582</span><span class="token punctuation">,</span>
      <span class="token property">&quot;moduleId&quot;</span><span class="token operator">:</span> <span class="token number">29595</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;originIdentifier&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\Repos\\webpack\\testCases.js&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;originName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;(webpack)/testCases.js&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;moduleIdentifier&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\Repos\\webpack\\test\\cases|sync|/^\\.\\/[^/]+\\/[^/]+\\/index\\.js$/&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;moduleName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;(webpack)/test/cases sync ^\\.\\/[^/]+\\/[^/]+\\/index\\.js$&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;dependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;loc&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1:0-70&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">&quot;originId&quot;</span><span class="token operator">:</span> <span class="token number">8198</span><span class="token punctuation">,</span>
      <span class="token property">&quot;moduleId&quot;</span><span class="token operator">:</span> <span class="token number">32582</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;details&quot;</span><span class="token operator">:</span> <span class="token string">&quot;at RequireContextDependency.getWarnings (C:\\Repos\\webpack\\lib\\dependencies\\ContextDependency.js:79:5)\n    at Compilation.reportDependencyErrorsAndWarnings (C:\\Repos\\webpack\\lib\\Compilation.js:1727:24)\n    at C:\\Repos\\webpack\\lib\\Compilation.js:1467:10\n    at _next2 (&lt;anonymous&gt;:16:1)\n    at eval (&lt;anonymous&gt;:42:1)\n    at C:\\Repos\\webpack\\node_modules\\neo-async\\async.js:2830:7\n    at Object.each (C:\\Repos\\webpack\\node_modules\\neo-async\\async.js:2850:39)\n    at C:\\Repos\\webpack\\lib\\FlagDependencyExportsPlugin.js:219:18\n    at C:\\Repos\\webpack\\node_modules\\neo-async\\async.js:2830:7\n    at Object.each (C:\\Repos\\webpack\\node_modules\\neo-async\\async.js:2850:39)\n    at C:\\Repos\\webpack\\lib\\FlagDependencyExportsPlugin.js:40:16\n    at Hook.eval [as callAsync] (&lt;anonymous&gt;:38:1)\n    at Hook.CALL_ASYNC_DELEGATE [as _callAsync] (C:\\Repos\\tapable\\lib\\Hook.js:18:14)\n    at Compilation.finish (C:\\Repos\\webpack\\lib\\Compilation.js:1462:28)\n    at C:\\Repos\\webpack\\lib\\Compiler.js:909:18\n    at processTicksAndRejections (internal/process/task_queues.js:75:11)\n&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;stack&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ModuleDependencyWarning: Critical dependency: Contexts can&#x27;t use RegExps with the &#x27;g&#x27; or &#x27;y&#x27; flags.\n    at Compilation.reportDependencyErrorsAndWarnings (C:\\Repos\\webpack\\lib\\Compilation.js:1732:23)\n    at C:\\Repos\\webpack\\lib\\Compilation.js:1467:10\n    at _next2 (&lt;anonymous&gt;:16:1)\n    at eval (&lt;anonymous&gt;:42:1)\n    at C:\\Repos\\webpack\\node_modules\\neo-async\\async.js:2830:7\n    at Object.each (C:\\Repos\\webpack\\node_modules\\neo-async\\async.js:2850:39)\n    at C:\\Repos\\webpack\\lib\\FlagDependencyExportsPlugin.js:219:18\n    at C:\\Repos\\webpack\\node_modules\\neo-async\\async.js:2830:7\n    at Object.each (C:\\Repos\\webpack\\node_modules\\neo-async\\async.js:2850:39)\n    at C:\\Repos\\webpack\\lib\\FlagDependencyExportsPlugin.js:40:16\n    at Hook.eval [as callAsync] (&lt;anonymous&gt;:38:1)\n    at Hook.CALL_ASYNC_DELEGATE [as _callAsync] (C:\\Repos\\tapable\\lib\\Hook.js:18:14)\n    at Compilation.finish (C:\\Repos\\webpack\\lib\\Compilation.js:1462:28)\n    at C:\\Repos\\webpack\\lib\\Compiler.js:909:18\n    at processTicksAndRejections (internal/process/task_queues.js:75:11)\n&quot;</span>
<span class="token punctuation">}</span></code></pre><aside class="warning"><h6 class="warning__prefix">警告</h6><p>注意，当 <code>errorStack: false</code> 传递给 <code>toJson</code> 方法时，堆栈跟踪信息会被删除。<code>errorStack</code> 选项默认设置为 <code>true</code>。</p></aside><h1><span id="webpack-dev-server-API"></span>webpack-dev-server API<a href="#webpack-dev-server-API" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1>
<p><code>webpack-dev-server</code> provides a Node.js API which can be used directly in Node.js runtime.</p><h2><span id="Installation"></span>Installation<a href="#Installation" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>To start using the <code>webpack-dev-server</code> Node.js API, first install <code>webpack</code> and <code>webpack-dev-server</code> if you haven’t yet:</p><pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev webpack webpack-dev-server</code></pre><p>Then require the modules in your Node.js script:</p><pre><code class="hljs language-js"><span class="token keyword">const</span> Webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;webpack&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> WebpackDevServer <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;webpack-dev-server&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h2><span id="start"></span>start<a href="#start" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>It instructs <code>webpack-dev-server</code> instance to start the server.</p><p><strong>server.js</strong></p><pre><code class="hljs language-js"><span class="token keyword">const</span> Webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;webpack&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> WebpackDevServer <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;webpack-dev-server&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> webpackConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;./webpack.config.js&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> compiler <span class="token operator">=</span> <span class="token function">Webpack</span><span class="token punctuation">(</span>webpackConfig<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> devServerOptions <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>webpackConfig<span class="token punctuation">.</span>devServer<span class="token punctuation">,</span> open<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> server <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebpackDevServer</span><span class="token punctuation">(</span>devServerOptions<span class="token punctuation">,</span> compiler<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">runServer</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#x27;Starting server...&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> server<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">runServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>And then run the server with the following command:</p><pre><code class="hljs language-bash">node server.js</code></pre><h2><span id="startCallbackcallback"></span>startCallback(callback)<a href="#startCallbackcallback" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>It instructs <code>webpack-dev-server</code> instance to start the server and then run the callback function.</p><p><strong>server.js</strong></p><pre><code class="hljs language-js"><span class="token keyword">const</span> Webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;webpack&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> WebpackDevServer <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;webpack-dev-server&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> webpackConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;./webpack.config.js&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> compiler <span class="token operator">=</span> <span class="token function">Webpack</span><span class="token punctuation">(</span>webpackConfig<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> devServerOptions <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>webpackConfig<span class="token punctuation">.</span>devServer<span class="token punctuation">,</span> open<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> server <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebpackDevServer</span><span class="token punctuation">(</span>devServerOptions<span class="token punctuation">,</span> compiler<span class="token punctuation">)</span><span class="token punctuation">;</span>

server<span class="token punctuation">.</span><span class="token function">startCallback</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#x27;Successfully started server on http://localhost:8080&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>And then run the server with the following command:</p><pre><code class="hljs language-bash">node server.js</code></pre><h2><span id="stop"></span>stop<a href="#stop" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>It instructs <code>webpack-dev-server</code> instance to stop the server.</p><p><strong>server.js</strong></p><pre><code class="hljs language-js"><span class="token keyword">const</span> Webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;webpack&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> WebpackDevServer <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;webpack-dev-server&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> webpackConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;./webpack.config.js&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> compiler <span class="token operator">=</span> <span class="token function">Webpack</span><span class="token punctuation">(</span>webpackConfig<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> devServerOptions <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>webpackConfig<span class="token punctuation">.</span>devServer<span class="token punctuation">,</span> open<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> server <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebpackDevServer</span><span class="token punctuation">(</span>devServerOptions<span class="token punctuation">,</span> compiler<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">runServer</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#x27;Starting server...&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> server<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">stopServer</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#x27;Stopping server...&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> server<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">runServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span>stopServer<span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>And then run the server with the following command:</p><pre><code class="hljs language-bash">node server.js</code></pre><h2><span id="stopCallbackcallback"></span>stopCallback(callback)<a href="#stopCallbackcallback" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>It instructs <code>webpack-dev-server</code> instance to stop the server and then run the callback function.</p><p><strong>server.js</strong></p><pre><code class="hljs language-js"><span class="token keyword">const</span> Webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;webpack&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> WebpackDevServer <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;webpack-dev-server&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> webpackConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;./webpack.config.js&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> compiler <span class="token operator">=</span> <span class="token function">Webpack</span><span class="token punctuation">(</span>webpackConfig<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> devServerOptions <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>webpackConfig<span class="token punctuation">.</span>devServer<span class="token punctuation">,</span> open<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> server <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebpackDevServer</span><span class="token punctuation">(</span>devServerOptions<span class="token punctuation">,</span> compiler<span class="token punctuation">)</span><span class="token punctuation">;</span>

server<span class="token punctuation">.</span><span class="token function">startCallback</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#x27;Successfully started server on http://localhost:8080&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">stopServer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
  server<span class="token punctuation">.</span><span class="token function">stopCallback</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#x27;Server stopped.&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span>stopServer<span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>And then run the server with the following command:</p><pre><code class="hljs language-bash">node server.js</code></pre><h2><span id="internalIPfamily-v4--v6"></span>internalIP(family: &quot;v4&quot; | &quot;v6&quot;)<a href="#internalIPfamily-v4--v6" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>Returns the internal <code>IPv4</code>/<code>IPv6</code> address asynchronously.</p><p><strong>server.js</strong></p><pre><code class="hljs language-js"><span class="token keyword">const</span> WebpackDevServer <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;webpack-dev-server&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">logInternalIPs</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> localIPv4 <span class="token operator">=</span> <span class="token keyword">await</span> WebpackDevServer<span class="token punctuation">.</span><span class="token function">internalIP</span><span class="token punctuation">(</span><span class="token string">&#x27;v4&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> localIPv6 <span class="token operator">=</span> <span class="token keyword">await</span> WebpackDevServer<span class="token punctuation">.</span><span class="token function">internalIP</span><span class="token punctuation">(</span><span class="token string">&#x27;v6&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#x27;Local IPv4 address:&#x27;</span><span class="token punctuation">,</span> localIPv4<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#x27;Local IPv6 address:&#x27;</span><span class="token punctuation">,</span> localIPv6<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">logInternalIPs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h2><span id="internalIPSyncfamily-v4--v6"></span>internalIPSync(family: &quot;v4&quot; | &quot;v6&quot;)<a href="#internalIPSyncfamily-v4--v6" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>Returns the internal <code>IPv4</code>/<code>IPv6</code> address synchronously.</p><p><strong>server.js</strong></p><pre><code class="hljs language-js"><span class="token keyword">const</span> WebpackDevServer <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;webpack-dev-server&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> localIPv4 <span class="token operator">=</span> WebpackDevServer<span class="token punctuation">.</span><span class="token function">internalIPSync</span><span class="token punctuation">(</span><span class="token string">&#x27;v4&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> localIPv6 <span class="token operator">=</span> WebpackDevServer<span class="token punctuation">.</span><span class="token function">internalIPSync</span><span class="token punctuation">(</span><span class="token string">&#x27;v6&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#x27;Local IPv4 address:&#x27;</span><span class="token punctuation">,</span> localIPv4<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#x27;Local IPv6 address:&#x27;</span><span class="token punctuation">,</span> localIPv6<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h1><span id="Hot-Module-Replacement"></span>Hot Module Replacement<a href="#Hot-Module-Replacement" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1>
<p>如果已经通过 <a href="/plugins/hot-module-replacement-plugin"><code>HotModuleReplacementPlugin</code></a> 启用了 <a href="/concepts/hot-module-replacement">Hot Module Replacement</a>, 则它的接口将被暴露在 <a href="/api/module-variables/#modulehot-webpack-specific"><code>module.hot</code></a> 以及 <a href="/api/module-variables/#importmetawebpackHot"><code>import.meta.webpackHot</code></a> 属性下。请注意，只有 <code>import.meta.webpackHot</code> 可以在 <a href="/guides/ecma-script-modules/#flagging-modules-as-esm">strict ESM</a> 中使用。</p><p>通常，用户先要检查这个接口是否可访问, 再使用它。你可以这样使用 <code>accept</code> 操作一个更新的模块：</p><pre><code class="hljs language-js"><span class="token keyword">if</span> <span class="token punctuation">(</span>module<span class="token punctuation">.</span>hot<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  module<span class="token punctuation">.</span>hot<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token string">&#x27;./library.js&#x27;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 对更新过的 library 模块做些事情...</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// or</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>webpackHot<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>webpackHot<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token string">&#x27;./library.js&#x27;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Do something with the updated library module…</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>支持以下方法……</p><h2><span id="module-api"></span>模块 API<a href="#module-api" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><h3><span id="accept"></span>accept<a href="#accept" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>接受(accept)给定 <code>依赖模块(dependencies)</code> 的更新，并触发一个 <code>回调函数</code> 来响应更新，除此之外，你可以附加一个可选的 error 处理程序：</p><pre><code class="hljs language-js">module<span class="token punctuation">.</span>hot<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span>
  dependencies<span class="token punctuation">,</span> <span class="token comment">// 可以是一个字符串或字符串数组</span>
  callback <span class="token comment">// 用于在模块更新后触发的函数</span>
  errorHandler <span class="token comment">// (err, {moduleId, dependencyId}) =&gt; {}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// or</span>
<span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>webpackHot<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span>
  dependencies<span class="token punctuation">,</span> <span class="token comment">// 可以是一个字符串或字符串数组</span>
  callback<span class="token punctuation">,</span> <span class="token comment">// 用于在模块更新后触发的函数</span>
  errorHandler <span class="token comment">// (err, {moduleId, dependencyId}) =&gt; {}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>当使用 ESM <code>import</code> 时，所有从 <code>dependencies</code> 中导入的符号都会自动更新。注意：依赖项字符串必须与 <code>import</code> 中的 <code>from</code> 字符串完全匹配。在某些情况下， 甚至可以省略 <code>callback</code>。在 <code>callback</code> 中使用的 <code>require()</code> 在这里没有任何意义。</p><p>在使用 CommonJS 时，你应该通过 <code>callback</code> 中的 <code>require()</code> 手动更新依赖模块。省略 <code>callback</code> 在这里没有任何意义。</p><h4><span id="errorhandlerforaccept"></span>errorHandler for accept<a href="#errorhandlerforaccept" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4><p><code>(err, {moduleId, dependencyId}) =&gt; {}</code></p><ul><li><code>err</code>: 当使用 ESM 依赖项时，回调函数在第二个参数中或在依赖项执行期间抛出的错误。</li><li><code>moduleId</code>: 当前模块 id。</li><li><code>dependencyId</code>: (第一个)被更改依赖项的模块 id。</li></ul><h3><span id="accept-self"></span>accept (self)<a href="#accept-self" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>接受自身更新。</p><pre><code class="hljs language-js">module<span class="token punctuation">.</span>hot<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span>
  errorHandler <span class="token comment">// 在计算新版本时处理错误的函数</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// or</span>
<span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>webpackHot<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span>
  errorHandler <span class="token comment">// Function to handle errors when evaluating the new version</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>在此模块或依赖模块更新时，可以在不通知父依赖的情况下，对此模块处理和重新取值。如果此模块没有导出（或以其他方式更新的导出），这是有意义的。</p><p>当执行此模块（或依赖模块）抛出异常时，会触发 <code>errorHandler</code>。</p><h4><span id="errorhandlerforselfaccept"></span>errorHandler for self accept<a href="#errorhandlerforselfaccept" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4><p><code>(err, {moduleId, module}) =&gt; {}</code></p><ul><li><code>err</code>: 计算新版本时的错误。</li><li><code>moduleId</code>: 当前模块 id。</li><li><code>module</code>: 当前模块实例。<ul><li><code>module.hot</code>: 允许访问出错模块实例的 HMR API。一个常见的场景是再次自我接收（accept）。添加一个 dispose 处理程序来传递数据也是有意义的。注意，错误的模块可能已经部分执行，所以请确保不要进入不一致的状态。你可以使用 <code>module.hot.data</code> 存储部分状态。</li><li><code>module.exports</code>: 可以被重载，但是要小心，因为属性名在生产模式下可能会被破坏。</li></ul></li></ul><h3><span id="decline"></span>decline<a href="#decline" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>拒绝给定<code>依赖模块</code>的更新，使用 <code>&#x27;decline&#x27;</code> 方法强制更新失败。</p><pre><code class="hljs language-js">module<span class="token punctuation">.</span>hot<span class="token punctuation">.</span><span class="token function">decline</span><span class="token punctuation">(</span>
  dependencies <span class="token comment">// 可以是一个字符串或字符串数组</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// or</span>
<span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>webpackHot<span class="token punctuation">.</span><span class="token function">decline</span><span class="token punctuation">(</span>
  dependencies <span class="token comment">// Either a string or an array of strings</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>将依赖模块标记为不可更新(not-update-able)。在处理「依赖的导出正在更新」或「尚未实现处理」时，这是有意义的。取决于你的 HMR 管理代码，
此依赖模块（或其未接受的依赖模块）更新，通常会导致页面被完全重新加载。</p><h3><span id="decline-self"></span>decline (self)<a href="#decline-self" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>拒绝自身更新。</p><pre><code class="hljs language-js">module<span class="token punctuation">.</span>hot<span class="token punctuation">.</span><span class="token function">decline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// or</span>
<span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>webpackHot<span class="token punctuation">.</span><span class="token function">decline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>将依赖模块标记为不可更新(not-update-able)。当此模块具有无法避免的外部作用(side-effect)，或者尚未对此模块进行 HMR 处理时，这是有意义的。取决于你的 HMR 管理代码，此依赖模块（或其未接受的依赖模块）更新，通常会导致页面被完全重新加载。</p><h3><span id="dispose-or-adddisposehandler"></span>dispose (or addDisposeHandler)<a href="#dispose-or-adddisposehandler" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>添加一个处理函数，在当前模块代码被替换时执行。此函数应该用于移除你声明或创建的任何持久资源。如果要将状态传入到更新过的模块，请添加给定 <code>data</code> 参数。更新后，此对象在更新之后可通过 <code>module.hot.data</code> 调用。</p><pre><code class="hljs language-js">module<span class="token punctuation">.</span>hot<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 清理并将 data 传递到更新后的模块...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// or</span>
<span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>webpackHot<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// Clean up and pass data to the updated module...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3><span id="invalidate"></span>invalidate<a href="#invalidate" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>调用此方法将使当前模块无效，而当前模块将在应用 HMR 更新时进行部署并重新创建。这个模块的更新像冒泡一样，拒绝自身更新。</p><p>在 <code>idle</code> 状态下调用时，将创建一个包含此模块的新 HMR 更新。HMR 将进入 <code>ready</code> 状态。</p><p>在 <code>ready</code> 或 <code>prepare</code> 状态下调用时，此模块将添加到当前 HMR 的更新中。</p><p>在 <code>check</code> 状态期间被调用时，如果有可用更新，则此模块将添加到更新中。如果没有可用的更新，它将创建一个新更新。HMR 将进入 <code>ready</code> 状态。</p><p>在 <code>dispose</code> 或 <code>apply</code> 状态下调用时，HMR 将在退出这些状态后将其拾取。</p><h4><span id="use-cases"></span>用例<a href="#use-cases" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4><p><strong>Conditional Accepting</strong></p><p>一个模块可以接受一个依赖，但是当依赖的改变无法处理时，可以调用 <code>invalidate</code>：</p><pre><code class="hljs language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;./dep&#x27;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> processX<span class="token punctuation">,</span> processY <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;anotherDep&#x27;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> oldY <span class="token operator">=</span> y<span class="token punctuation">;</span>

<span class="token function">processX</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">processY</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>hot<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token string">&#x27;./dep&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>y <span class="token operator">!==</span> oldY<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 无法处理，冒泡给父级</span>
    module<span class="token punctuation">.</span>hot<span class="token punctuation">.</span><span class="token function">invalidate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 可以处理</span>
  <span class="token function">processX</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><strong>Conditional self accept</strong></p><p>模块可以自我接受，但是当更改无法处理时可以使自身失效：</p><pre><code class="hljs language-javascript"><span class="token keyword">const</span> <span class="token constant">VALUE</span> <span class="token operator">=</span> <span class="token string">&#x27;constant&#x27;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token constant">VALUE</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>
  module<span class="token punctuation">.</span>hot<span class="token punctuation">.</span>data <span class="token operator">&amp;&amp;</span>
  module<span class="token punctuation">.</span>hot<span class="token punctuation">.</span>data<span class="token punctuation">.</span>value <span class="token operator">&amp;&amp;</span>
  module<span class="token punctuation">.</span>hot<span class="token punctuation">.</span>data<span class="token punctuation">.</span>value <span class="token operator">!==</span> <span class="token constant">VALUE</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  module<span class="token punctuation">.</span>hot<span class="token punctuation">.</span><span class="token function">invalidate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  module<span class="token punctuation">.</span>hot<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    data<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token constant">VALUE</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  module<span class="token punctuation">.</span>hot<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p><strong>Triggering custom HMR updates</strong></p><pre><code class="hljs language-javascript"><span class="token keyword">const</span> moduleId <span class="token operator">=</span> <span class="token function">chooseAModule</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> code <span class="token operator">=</span> __webpack_modules__<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
__webpack_modules__<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">eval</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">makeChanges</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>require<span class="token punctuation">.</span>cache<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  require<span class="token punctuation">.</span>cache<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span><span class="token punctuation">.</span>hot<span class="token punctuation">.</span><span class="token function">invalidate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  module<span class="token punctuation">.</span><span class="token function">hot</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><aside class="tip"><h6 class="tip__prefix">提示</h6><p>当调用 <code>invalidate</code> 时，将最终调用 <a href="#dispose-or-adddisposehandler"><code>dispose</code></a> 处理函数并填充 <code>module.hot.data</code>。如果未注册 <a href="#dispose-or-adddisposehandler"><code>dispose</code></a> 处理程序, 则将空对象提供给 <code>module.hot.data</code>.</p></aside><aside class="warning"><h6 class="warning__prefix">警告</h6><p>通过一次次的调用 <code>invalidate</code>，不要陷入 <code>invalidate</code> 循环。这将导致栈溢出并且 HMR 进入 <code>fail</code> 状态。</p></aside><h3><span id="removedisposehandler"></span>removeDisposeHandler<a href="#removedisposehandler" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>删除由 <code>dispose</code> 或 <code>addDisposeHandler</code> 添加的回调函数。</p><pre><code class="hljs language-js">module<span class="token punctuation">.</span>hot<span class="token punctuation">.</span><span class="token function">removeDisposeHandler</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// or</span>
<span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>webpackHot<span class="token punctuation">.</span><span class="token function">removeDisposeHandler</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h2><span id="management-api"></span>API 管理<a href="#management-api" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><h3><span id="status"></span>status<a href="#status" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>获取当前模块热替换进程的状态。</p><pre><code class="hljs language-js">module<span class="token punctuation">.</span>hot<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 返回以下字符串之一...</span>

<span class="token comment">// 或者</span>
<span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>webpackHot<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><table><thead><tr><th>Status</th><th>Description</th></tr></thead><tbody><tr><td data-th="Status"><span>idle</span></td><td data-th="Description"><span>该进程正在等待调用 <code>check</code>（见下文）</span></td></tr><tr><td data-th="Status"><span>check</span></td><td data-th="Description"><span>该进程正在检查以更新</span></td></tr><tr><td data-th="Status"><span>prepare    </span></td><td data-th="Description"><span>该进程正在准备更新（例如，下载已更新的模块）</span></td></tr><tr><td data-th="Status"><span>ready</span></td><td data-th="Description"><span>此更新已准备并可用</span></td></tr><tr><td data-th="Status"><span>dispose</span></td><td data-th="Description"><span>该进程正在调用将被替换模块的 <code>dispose</code> 处理函数</span></td></tr><tr><td data-th="Status"><span>apply</span></td><td data-th="Description"><span>该进程正在调用 <code>accept</code> 处理函数，并重新执行自我接受(self-accepted)的模块</span></td></tr><tr><td data-th="Status"><span>abort</span></td><td data-th="Description"><span>更新已中止，但系统仍处于之前的状态</span></td></tr><tr><td data-th="Status"><span>fail</span></td><td data-th="Description"><span>更新已抛出异常，系统状态已被破坏</span></td></tr></tbody></table><h3><span id="check"></span>check<a href="#check" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>测试所有加载的模块以进行更新，如果有更新，则 <code>apply</code> 它们。</p><pre><code class="hljs language-js">module<span class="token punctuation">.</span>hot
  <span class="token punctuation">.</span><span class="token function">check</span><span class="token punctuation">(</span>autoApply<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">outdatedModules</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 超时的模块...</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 捕获错误</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// or</span>
<span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>webpackHot
  <span class="token punctuation">.</span><span class="token function">check</span><span class="token punctuation">(</span>autoApply<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">outdatedModules</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// outdated modules...</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// catch errors</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>当被调用时，传递给 <code>apply</code> 方法的 <code>autoApply</code> 参数可以是布尔值，也可以是 <code>options</code>，</p><h3><span id="apply"></span>apply<a href="#apply" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>继续更新进程（当 <code>module.hot.status() === &#x27;ready&#x27;</code> 时）。</p><pre><code class="hljs language-js">module<span class="token punctuation">.</span><span class="token function">hot</span>
  <span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">outdatedModules</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 超时的模块...</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 捕获错误</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// or</span>
<span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span><span class="token function">webpackHot</span>
  <span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">outdatedModules</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// outdated modules...</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// catch errors</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>可选的 <code>options</code> 对象可以包含以下属性：</p><ul><li><code>ignoreUnaccepted</code> (boolean): 忽略对不可接受的模块所做的更改。</li><li><code>ignoreDeclined</code> (boolean): 忽略对已拒绝的模块所做的更改。</li><li><code>ignoreErrored</code> (boolean): 忽略在接受处理程序、错误处理程序以及重新评估模块时抛出的错误。</li><li><code>onDeclined</code> (function(info)): 拒绝模块的通知者。</li><li><code>onUnaccepted</code> (function(info)): 不可接受的模块的通知程序。</li><li><code>onAccepted</code> (function(info)): 可接受模块的通知者。</li><li><code>onDisposed</code> (function(info)): 废弃模块的通知者。</li><li><code>onErrored</code> (function(info)): 错误通知者。</li></ul><p><code>info</code> 参数将是一个包含以下某些值的对象：</p><pre><code class="hljs language-ts"><span class="token punctuation">{</span>
  <span class="token keyword">type</span><span class="token operator">:</span> <span class="token string">&#x27;self-declined&#x27;</span> <span class="token operator">|</span> <span class="token string">&#x27;declined&#x27;</span> <span class="token operator">|</span>
        <span class="token string">&#x27;unaccepted&#x27;</span> <span class="token operator">|</span> <span class="token string">&#x27;accepted&#x27;</span> <span class="token operator">|</span>
        <span class="token string">&#x27;disposed&#x27;</span> <span class="token operator">|</span> <span class="token string">&#x27;accept-errored&#x27;</span> <span class="token operator">|</span>
        <span class="token string">&#x27;self-accept-errored&#x27;</span> <span class="token operator">|</span> <span class="token string">&#x27;self-accept-error-handler-errored&#x27;</span><span class="token punctuation">,</span>
  moduleId<span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token comment">// 有问题的模块。</span>
  dependencyId<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token comment">// 对于错误：拥有接受处理程序的模块 ID。</span>
  chain<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 对于拒绝/接受/不接受：传播更新的 `chain`。</span>
  parentId<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token comment">// 对于拒绝：下降的父模块 ID。</span>
  outdatedModules<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 对于接受：已过时且将被处置的模块。</span>
  outdatedDependencies<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// 对于接受：将处理更新的接受处理程序的位置。</span>
    <span class="token number">5</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  error<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 对于错误：抛出错误</span>
  originalError<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span> <span class="token comment">// 对于自我接受错误处理程序错误：</span>
                                <span class="token comment">// 在错误处理程序尝试处理该模块之前，该模块引发的错误。</span>
<span class="token punctuation">}</span></code></pre><h3><span id="addstatushandler"></span>addStatusHandler<a href="#addstatushandler" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>注册一个函数来监听 <code>status</code> 的变化。</p><pre><code class="hljs language-js">module<span class="token punctuation">.</span>hot<span class="token punctuation">.</span><span class="token function">addStatusHandler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">status</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 响应当前状态...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// or</span>
<span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>webpackHot<span class="token punctuation">.</span><span class="token function">addStatusHandler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">status</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// React to the current status...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>请记住，当 status 处理函数返回一个 <code>Promise</code> 时，HMR 系统将会在继续之前等待 <code>Promise</code> resolve。</p><h3><span id="removestatushandler"></span>removeStatusHandler<a href="#removestatushandler" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>移除一个注册的状态处理函数。</p><pre><code class="hljs language-js">module<span class="token punctuation">.</span>hot<span class="token punctuation">.</span><span class="token function">removeStatusHandler</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// or</span>
<span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>webpackHot<span class="token punctuation">.</span><span class="token function">removeStatusHandler</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h1><span id="Loader-Interface"></span>Loader Interface<a href="#Loader-Interface" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1>
<p>loader 本质上是导出为函数的 JavaScript 模块。<a href="https://github.com/webpack/loader-runner">loader runner</a> 会调用此函数，然后将上一个 loader 产生的结果或者资源文件传入进去。函数中的 <code>this</code> 作为上下文会被 webpack 填充，并且 <a href="https://github.com/webpack/loader-runner">loader runner</a> 中包含一些实用的方法，比如可以使 loader 调用方式变为异步，或者获取 query 参数。</p><p>起始 loader 只有一个入参：资源文件的内容。compiler 预期得到最后一个 loader 产生的处理结果。这个处理结果应该为 <code>String</code> 或者 <code>Buffer</code>（能够被转换为 string）类型，代表了模块的 JavaScript 源码。另外，还可以传递一个可选的 SourceMap 结果（格式为 JSON 对象）。</p><p>如果是单个处理结果，可以在 <a href="#synchronous-loaders">同步模式</a> 中直接返回。如果有多个处理结果，则必须调用 <code>this.callback()</code>。在 <a href="#asynchronous-loaders">异步模式</a> 中，必须调用 <code>this.async()</code> 来告知 <a href="https://github.com/webpack/loader-runner">loader runner</a> 等待异步结果，它会返回 <code>this.callback()</code> 回调函数。随后 loader 必须返回 <code>undefined</code> 并且调用该回调函数。</p><pre><code class="hljs language-js"><span class="token comment">/**
 *
 * @param {string|Buffer} content 源文件的内容
 * @param {object} [map] 可以被 https://github.com/mozilla/source-map 使用的 SourceMap 数据
 * @param {any} [meta] meta 数据，可以是任何内容
 */</span>
<span class="token keyword">function</span> <span class="token function">webpackLoader</span><span class="token punctuation">(</span><span class="token parameter">content<span class="token punctuation">,</span> map<span class="token punctuation">,</span> meta</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 你的 webpack loader 代码</span>
<span class="token punctuation">}</span></code></pre><h2><span id="examples"></span>示例<a href="#examples" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>以下部分提供了不同类型的 loader 的一些基本示例。注意，<code>map</code> 和 <code>meta</code> 参数是可选的，查看下面的 <a href="#thiscallback"><code>this.callback</code></a>。</p><h3><span id="synchronous-loaders"></span>同步 Loaders<a href="#synchronous-loaders" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>无论是 <code>return</code> 还是 <code>this.callback</code> 都可以同步地返回转换后的 <code>content</code> 值：</p><p><strong>sync-loader.js</strong></p><pre><code class="hljs language-javascript">module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">content<span class="token punctuation">,</span> map<span class="token punctuation">,</span> meta</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">someSyncOperation</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p><code>this.callback</code> 方法则更灵活，因为它允许传递多个参数，而不仅仅是 <code>content</code>。</p><p><strong>sync-loader-with-multiple-results.js</strong></p><pre><code class="hljs language-javascript">module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">content<span class="token punctuation">,</span> map<span class="token punctuation">,</span> meta</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token function">someSyncOperation</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">,</span> map<span class="token punctuation">,</span> meta<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span><span class="token punctuation">;</span> <span class="token comment">// 当调用 callback() 函数时，总是返回 undefined</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><h3><span id="asynchronous-loaders"></span>异步 Loaders<a href="#asynchronous-loaders" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>对于异步 loader，使用 <a href="#thisasync"><code>this.async</code></a> 来获取 <code>callback</code> 函数：</p><p><strong>async-loader.js</strong></p><pre><code class="hljs language-javascript">module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">content<span class="token punctuation">,</span> map<span class="token punctuation">,</span> meta</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> callback <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">async</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">someAsyncOperation</span><span class="token punctuation">(</span>content<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">callback</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> result<span class="token punctuation">,</span> map<span class="token punctuation">,</span> meta<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p><strong>async-loader-with-multiple-results.js</strong></p><pre><code class="hljs language-javascript">module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">content<span class="token punctuation">,</span> map<span class="token punctuation">,</span> meta</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> callback <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">async</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">someAsyncOperation</span><span class="token punctuation">(</span>content<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result<span class="token punctuation">,</span> sourceMaps<span class="token punctuation">,</span> meta</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">callback</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> result<span class="token punctuation">,</span> sourceMaps<span class="token punctuation">,</span> meta<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><aside class="tip"><h6 class="tip__prefix">提示</h6><p>loader 最初被设计为可以在同步 loader pipelines（如 Node.js ，使用 <a href="https://github.com/webpack/enhanced-require">enhanced-require</a>)，<em>以及</em> 在异步 pipelines（如 webpack）中运行。然而，由于同步计算过于耗时，在 Node.js 这样的单线程环境下进行此操作并不是好的方案，我们建议尽可能地使你的 loader 异步化。但如果计算量很小，同步 loader 也是可以的。</p></aside><h3><span id="raw-loader"></span>&quot;Raw&quot; Loader<a href="#raw-loader" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>默认情况下，资源文件会被转化为 UTF-8 字符串，然后传给 loader。通过设置 <code>raw</code> 为 <code>true</code>，loader 可以接收原始的 <code>Buffer</code>。每一个 loader 都可以用 <code>String</code> 或者 <code>Buffer</code> 的形式传递它的处理结果。complier 将会把它们在 loader 之间相互转换。</p><p><strong>raw-loader.js</strong></p><pre><code class="hljs language-javascript">module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">content</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">assert</span><span class="token punctuation">(</span>content <span class="token keyword">instanceof</span> <span class="token class-name">Buffer</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">someSyncOperation</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 返回值也可以是一个 `Buffer`</span>
  <span class="token comment">// 即使不是 &quot;raw&quot;，loader 也没问题</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports<span class="token punctuation">.</span>raw <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span></code></pre><h3><span id="pitching-loader"></span>Pitching Loader<a href="#pitching-loader" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>loader <strong>总是</strong> 从右到左被调用。有些情况下，loader 只关心 request 后面的 <strong>元数据(metadata)</strong>，并且忽略前一个 loader 的结果。在实际（从右到左）执行 loader 之前，会先 <strong>从左到右</strong> 调用 loader 上的 <code>pitch</code> 方法。</p><aside class="tip"><h6 class="tip__prefix">提示</h6><p>loader 可以通过 request 添加或者禁用内联前缀，这将影响到 pitch 和执行的顺序。更多详情请查阅 <a href="/configuration/module/#ruleenforce"><code>Rule.enforce</code></a>。</p></aside><p>对于以下 <a href="/configuration/module/#ruleuse"><code>use</code></a> 配置：</p><pre><code class="hljs language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">//...</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token comment">//...</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#x27;a-loader&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;b-loader&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;c-loader&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>将会发生这些步骤：</p><pre><code class="hljs language-diff">|- a-loader `pitch`
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> |- b-loader `pitch`
</span><span class="token prefix unchanged"> </span><span class="token line">   |- c-loader `pitch`
</span><span class="token prefix unchanged"> </span><span class="token line">     |- requested module is picked up as a dependency
</span><span class="token prefix unchanged"> </span><span class="token line">   |- c-loader normal execution
</span><span class="token prefix unchanged"> </span><span class="token line"> |- b-loader normal execution
</span></span>|- a-loader normal execution</code></pre><p>那么，为什么 loader 可以利用 &quot;pitching&quot; 阶段呢？</p><p>首先，传递给 <code>pitch</code> 方法的 <code>data</code>，在执行阶段也会暴露在 <code>this.data</code> 之下，并且可以用于在循环时，捕获并共享前面的信息。</p><pre><code class="hljs language-javascript">module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">content</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">someSyncOperation</span><span class="token punctuation">(</span>content<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports<span class="token punctuation">.</span><span class="token function-variable function">pitch</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">remainingRequest<span class="token punctuation">,</span> precedingRequest<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  data<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>其次，如果某个 loader 在 <code>pitch</code> 方法中给出一个结果，那么这个过程会回过身来，并跳过剩下的 loader。在我们上面的例子中，如果 <code>b-loader</code> 的 <code>pitch</code> 方法返回了一些东西：</p><pre><code class="hljs language-javascript">module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">content</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">someSyncOperation</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports<span class="token punctuation">.</span><span class="token function-variable function">pitch</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">remainingRequest<span class="token punctuation">,</span> precedingRequest<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">someCondition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token string">&#x27;module.exports = require(&#x27;</span> <span class="token operator">+</span>
      <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token string">&#x27;-!&#x27;</span> <span class="token operator">+</span> remainingRequest<span class="token punctuation">)</span> <span class="token operator">+</span>
      <span class="token string">&#x27;);&#x27;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>上面的步骤将被缩短为：</p><pre><code class="hljs language-diff">|- a-loader `pitch`
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> |- b-loader `pitch` returns a module
</span></span>|- a-loader normal execution</code></pre><h2><span id="the-loader-context"></span>The Loader Context<a href="#the-loader-context" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>loader context 表示在 loader 内使用 <code>this</code> 可以访问的一些方法或属性。</p><h3><span id="example-for-the-loader-context"></span>loader 上下文示例<a href="#example-for-the-loader-context" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>下面提供一个例子，将使用 require 进行调用：</p><p>在 <code>/abc/file.js</code> 中：</p><pre><code class="hljs language-javascript"><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;./loader1?xyz!loader2!./resource?rrr&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3><span id="thisaddcontextdependency"></span>this.addContextDependency<a href="#thisaddcontextdependency" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><pre><code class="hljs language-typescript"><span class="token function">addContextDependency</span><span class="token punctuation">(</span>directory<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span></code></pre><p>添加目录作为 loader 结果的依赖。</p><h3><span id="thisadddependency"></span>this.addDependency<a href="#thisadddependency" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><pre><code class="hljs language-typescript"><span class="token function">addDependency</span><span class="token punctuation">(</span>file<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span>
<span class="token function">dependency</span><span class="token punctuation">(</span>file<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token comment">// shortcut</span></code></pre><p>添加一个文件作为产生 loader 结果的依赖，使它们的任何变化可以被监听到。例如，<a href="https://github.com/webpack-contrib/sass-loader"><code>sass-loader</code></a>, <a href="https://github.com/webpack-contrib/less-loader"><code>less-loader</code></a> 就使用了这个技巧，当它发现无论何时导入的 <code>css</code> 文件发生变化时就会重新编译。</p><h3><span id="thisaddmissingdependency"></span>this.addMissingDependency<a href="#thisaddmissingdependency" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><pre><code class="hljs language-typescript"><span class="token function">addMissingDependency</span><span class="token punctuation">(</span>file<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span></code></pre><p>添加一个不存在的文件作为 loader 结果的依赖项，以使它们可监听。类似于 <code>addDependency</code>，但是会在正确附加观察者之前处理在编译期间文件的创建。</p><h3><span id="thisasync"></span>this.async<a href="#thisasync" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>告诉 <a href="https://github.com/webpack/loader-runner">loader-runner</a> 这个 loader 将会异步地回调。返回 <code>this.callback</code>。</p><h3><span id="thiscacheable"></span>this.cacheable<a href="#thiscacheable" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>设置是否可缓存标志的函数：</p><pre><code class="hljs language-typescript"><span class="token function">cacheable</span><span class="token punctuation">(</span>flag <span class="token operator">=</span> <span class="token boolean">true</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">)</span></code></pre><p>默认情况下，loader 的处理结果会被标记为可缓存。调用这个方法然后传入 <code>false</code>，可以关闭 loader 处理结果的缓存能力。</p><p>一个可缓存的 loader 在输入和相关依赖没有变化时，必须返回相同的结果。这意味着 loader 除了 <code>this.addDependency</code> 里指定的以外，不应该有其它任何外部依赖。</p><h3><span id="thiscallback"></span>this.callback<a href="#thiscallback" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>可以同步或者异步调用的并返回多个结果的函数。预期的参数是：</p><pre><code class="hljs language-ts"><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">callback</span><span class="token punctuation">(</span>
  err<span class="token operator">:</span> Error <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
  content<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> Buffer<span class="token punctuation">,</span>
  sourceMap<span class="token operator">?</span><span class="token operator">:</span> SourceMap<span class="token punctuation">,</span>
  meta<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">any</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><ol><li>第一个参数必须是 <code>Error</code> 或者 <code>null</code></li><li>第二个参数是一个 <code>string</code> 或者 <a href="https://nodejs.org/api/buffer.html"><code>Buffer</code></a>。</li><li>可选的：第三个参数必须是一个可以被 <a href="https://github.com/mozilla/source-map">this module</a> 解析的 source map。</li><li>可选的：第四个参数，会被 webpack 忽略，可以是任何东西（例如一些元数据）。</li></ol><aside class="tip"><h6 class="tip__prefix">提示</h6><p>如果希望在 loader 之间共享公共的 AST，可以将抽象语法树 AST（例如 <a href="https://github.com/estree/estree"><code>ESTree</code></a>）作为第四个参数（<code>meta</code>）传递，以加快构建时间。</p></aside><p>如果这个函数被调用的话，你应该返回 undefined 从而避免含糊的 loader 结果。</p><h3><span id="thiscleardependencies"></span>this.clearDependencies<a href="#thiscleardependencies" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><pre><code class="hljs language-typescript"><span class="token function">clearDependencies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>移除 loader 结果的所有依赖，甚至自己和其它 loader 的初始依赖。考虑使用 <code>pitch</code>。</p><h3><span id="thiscontext"></span>this.context<a href="#thiscontext" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><strong>模块所在的目录</strong> 可以用作解析其他模块成员的上下文。</p><p>在我们的 <a href="#example-for-the-loader-context">例子</a> 中：因为 <code>resource.js</code> 在这个目录中，这个属性的值为 <code>/abc</code></p><h3><span id="thisdata"></span>this.data<a href="#thisdata" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>在 pitch 阶段和 normal 阶段之间共享的 data 对象。</p><h3><span id="thisemiterror"></span>this.emitError<a href="#thisemiterror" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><pre><code class="hljs language-typescript"><span class="token function">emitError</span><span class="token punctuation">(</span>error<span class="token operator">:</span> Error<span class="token punctuation">)</span></code></pre><p>emit 一个错误，也可以在输出中显示。</p><pre><code class="hljs language-bash">ERROR <span class="token keyword">in</span> ./src/lib.js <span class="token punctuation">(</span>./src/loader.js<span class="token operator">!</span>./src/lib.js<span class="token punctuation">)</span>
Module Error <span class="token punctuation">(</span>from ./src/loader.js<span class="token punctuation">)</span>:
Here is an Error<span class="token operator">!</span>
 @ ./src/index.js <span class="token number">1</span>:0-25</code></pre><aside class="tip"><h6 class="tip__prefix">提示</h6><p>与抛出错误中断运行不同，它不会中断当前模块的编译过程。</p></aside><h3><span id="thisemitfile"></span>this.emitFile<a href="#thisemitfile" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><pre><code class="hljs language-typescript"><span class="token function">emitFile</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> content<span class="token operator">:</span> Buffer<span class="token operator">|</span><span class="token builtin">string</span><span class="token punctuation">,</span> sourceMap<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p>产生一个文件。这是 webpack 特有的。</p><h3><span id="thisemitwarning"></span>this.emitWarning<a href="#thisemitwarning" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><pre><code class="hljs language-typescript"><span class="token function">emitWarning</span><span class="token punctuation">(</span>warning<span class="token operator">:</span> Error<span class="token punctuation">)</span></code></pre><p>发出一个警告，在输出中显示如下：</p><pre><code class="hljs language-bash">WARNING <span class="token keyword">in</span> ./src/lib.js <span class="token punctuation">(</span>./src/loader.js<span class="token operator">!</span>./src/lib.js<span class="token punctuation">)</span>
Module Warning <span class="token punctuation">(</span>from ./src/loader.js<span class="token punctuation">)</span>:
Here is a Warning<span class="token operator">!</span>
 @ ./src/index.js <span class="token number">1</span>:0-25</code></pre><aside class="tip"><h6 class="tip__prefix">提示</h6><p>请注意，如果 <code>stats.warnings</code> 设置为 <code>false</code>，警告信息将不会显示。或者其他一些省略设置被用做 <code>status</code>，例如 <code>none</code> 或者 <code>errors-only</code>。</p></aside><h3><span id="thisfs"></span>this.fs<a href="#thisfs" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>用于访问 compilation 的 inputFileSystem 属性。</p><h3><span id="thisgetoptionsschema"></span>this.getOptions(schema)<a href="#thisgetoptionsschema" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>提取给定的 loader 选项，接受一个可选的 JSON schema 作为参数</p><aside class="tip"><h6 class="tip__prefix">提示</h6><p>从 webpack 5 开始，<code>this.getOptions</code> 可以获取到 loader 上下文对象。它用来替代来自 <a href="https://github.com/webpack/loader-utils#getoptions">loader-utils</a> 中的 <code>getOptions</code> 方法。</p></aside><h3><span id="thisgetresolve"></span>this.getResolve<a href="#thisgetresolve" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><pre><code class="hljs language-typescript"><span class="token function">getResolve</span><span class="token punctuation">(</span>options<span class="token operator">:</span> ResolveOptions<span class="token punctuation">)</span><span class="token operator">:</span> resolve

<span class="token function">resolve</span><span class="token punctuation">(</span>context<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> request<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token function-variable function">callback</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> result<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">resolve</span><span class="token punctuation">(</span>context<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> request<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;</span></code></pre><p>创建一个类似于 <a href="#thisresolve"><code>this.resolve</code></a> 的解析函数。</p><p>在 webpack <a href="/configuration/resolve/#resolve"><code>resolve</code> 选项</a> 下的任意配置项都是可能的。他们会被合并进 <code>resolve</code> 配置项中。请注意，<code>&quot;...&quot;</code> 可以在数组中使用，用于拓展 <code>resolve</code> 配置项的值。例如：<code>{ extensions: [&quot;.sass&quot;, &quot;...&quot;] }</code>。</p><p><code>options.dependencyType</code> 是一个额外的配置。它允许我们指定依赖类型，用于从 <code>resolve</code> 配置项中解析 <code>byDependency</code>。</p><p>解析操作的所有依赖项都会自动作为依赖项添加到当前模块中。</p><h3><span id="thishot"></span>this.hot<a href="#thishot" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>loaders 的 HMR（模块热替换）相关信息。</p><pre><code class="hljs language-javascript">module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">source</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>hot<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true if HMR is enabled via --hot flag or webpack configuration</span>
  <span class="token keyword">return</span> source<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><h3><span id="thisimportmodule"></span>this.importModule<a href="#thisimportmodule" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><span class="badge">5.32.0+</span><p><code>this.importModule(request, options, [callback]): Promise</code></p><p>一种可以选择的轻量级解决方案，用于子编译器在构建时编译和执行请求。</p><ul><li><code>request</code>: 加载模块的请求字符串</li><li><code>options</code>:<ul><li><code>layer</code>：指定该模块放置/编译的层</li><li><code>publicPath</code>：用于构建模块的公共路径</li></ul></li><li><code>callback</code>：一个可选的 Node.js 风格的回调，返回模块的 exports 或 ESM 的命名空间对象。如果没有提供回调，<code>importModule</code>将返回一个 Promise。</li></ul><p><strong>webpack.config.js</strong></p><pre><code class="hljs language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex">/stylesheet\.js$/i</span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#x27;./a-pitching-loader.js&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        type<span class="token operator">:</span> <span class="token string">&#x27;asset/source&#x27;</span><span class="token punctuation">,</span> <span class="token comment">// 我们将 type 设置为 &#x27;asset/source&#x27;，其会返回一个字符串。</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p><strong>a-pitching-loader.js</strong></p><pre><code class="hljs language-js">exports<span class="token punctuation">.</span><span class="token function-variable function">pitch</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">remaining</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">importModule</span><span class="token punctuation">(</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>resourcePath <span class="token operator">+</span> <span class="token string">&#x27;.webpack[javascript/auto]&#x27;</span> <span class="token operator">+</span> <span class="token string">&#x27;!=!&#x27;</span> <span class="token operator">+</span> remaining
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> result<span class="token punctuation">.</span>default <span class="token operator">||</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p><strong>src/stylesheet.js</strong></p><pre><code class="hljs language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> green<span class="token punctuation">,</span> red <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;./colors.js&#x27;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">body { background: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>red<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">; color: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>green<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">; }</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span></code></pre><p><strong>src/colors.js</strong></p><pre><code class="hljs language-js"><span class="token keyword">export</span> <span class="token keyword">const</span> red <span class="token operator">=</span> <span class="token string">&#x27;#f00&#x27;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> green <span class="token operator">=</span> <span class="token string">&#x27;#0f0&#x27;</span><span class="token punctuation">;</span></code></pre><p><strong>src/index.js</strong></p><pre><code class="hljs language-js"><span class="token keyword">import</span> stylesheet <span class="token keyword">from</span> <span class="token string">&#x27;./stylesheet.js&#x27;</span><span class="token punctuation">;</span>
<span class="token comment">// stylesheet 在构建时会成为一个字符串：`body { background: #f00; color: #0f0; }`。</span></code></pre><p>在上面的例子中你可能会注意到一些东西：</p><ol><li>我们有一个 <a href="#pitching-loader">pitching loader</a>，</li><li>我们在 pitching loader 中使用 <code>!=!</code> 语法来为请求设置 <a href="#inline-matchresource">matchResource</a>，例如，我们将使用 <code>this.resourcePath + &#x27;.webpack[javascript/auto]&#x27;</code> 而不是原始资源匹配 <a href="/configuration/module/#modulerules"><code>module.rules</code></a>，</li><li><code>.webpack[javascript/auto]</code> 是 <code>.webpack[type]</code> 模式的伪拓展，当没有指定其他模块类型时，我们使用它指定一个默认 <a href="/configuration/module/#ruletype">模块类型</a>，它通常和 <code>!=!</code> 语法一起使用。</li></ol><p>注意，上面的示例是一个简化的示例，你可以查看 <a href="https://github.com/webpack/webpack/tree/master/test/configCases/loader-import-module/css">webpack 仓库的完整示例</a>。</p><h3><span id="thisloaderindex"></span>this.loaderIndex<a href="#thisloaderindex" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>当前 loader 在 loader 数组中的索引。</p><p>在<a href="#example-for-the-loader-context">示例</a>中：loader1 中得到：<code>0</code>，loader2 中得到：<code>1</code></p><h3><span id="thisloadmodule"></span>this.loadModule<a href="#thisloadmodule" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><pre><code class="hljs language-typescript"><span class="token function">loadModule</span><span class="token punctuation">(</span>request<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token function-variable function">callback</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> source<span class="token punctuation">,</span> sourceMap<span class="token punctuation">,</span> <span class="token keyword">module</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>解析给定的 request 到模块，应用所有配置的 loader，并且在回调函数中传入生成的 source、sourceMap 和模块实例（通常是 <a href="https://github.com/webpack/webpack/blob/master/lib/NormalModule.js"><code>NormalModule</code></a> 的一个实例）。如果你需要获取其他模块的源代码来生成结果的话，你可以使用这个函数。</p><p><code>this.loadModule</code> 在 loader 上下文中默认使用 CommonJS 来解析规则。用一个合适的 <code>dependencyType</code> 使用 <code>this.getResolve</code>。例如，在使用不同的语义之前使用 <code>&#x27;esm&#x27;</code>、<code>&#x27;commonjs&#x27;</code> 或者一个自定义的。</p><h3><span id="thisloaders"></span>this.loaders<a href="#thisloaders" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>所有 loader 组成的数组。它在 pitch 阶段的时候是可以写入的。</p><pre><code class="hljs language-ts">loaders <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>request<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> path<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> query<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token function-variable function">module</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">}</span><span class="token punctuation">]</span></code></pre><p>在此<a href="#example-for-the-loader-context">示例</a>中：</p><pre><code class="hljs language-javascript"><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    request<span class="token operator">:</span> <span class="token string">&#x27;/abc/loader1.js?xyz&#x27;</span><span class="token punctuation">,</span>
    path<span class="token operator">:</span> <span class="token string">&#x27;/abc/loader1.js&#x27;</span><span class="token punctuation">,</span>
    query<span class="token operator">:</span> <span class="token string">&#x27;?xyz&#x27;</span><span class="token punctuation">,</span>
    module<span class="token operator">:</span> <span class="token punctuation">[</span>Function<span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    request<span class="token operator">:</span> <span class="token string">&#x27;/abc/node_modules/loader2/index.js&#x27;</span><span class="token punctuation">,</span>
    path<span class="token operator">:</span> <span class="token string">&#x27;/abc/node_modules/loader2/index.js&#x27;</span><span class="token punctuation">,</span>
    query<span class="token operator">:</span> <span class="token string">&#x27;&#x27;</span><span class="token punctuation">,</span>
    module<span class="token operator">:</span> <span class="token punctuation">[</span>Function<span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span></code></pre><h3><span id="thismode"></span>this.mode<a href="#thismode" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>当 webpack 运行时读取 <a href="/configuration/mode/"><code>mode</code></a> 的值</p><p>可能的值为：<code>&#x27;production&#x27;</code>, <code>&#x27;development&#x27;</code>, <code>&#x27;none&#x27;</code></p><h3><span id="thisquery"></span>this.query<a href="#thisquery" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><ol><li>如果这个 loader 配置了 <a href="/configuration/module/#useentry"><code>options</code></a> 对象的话，this 就指向这个对象。</li><li>如果 loader 中没有 <code>options</code>，而是以 query 字符串作为参数调用时，this.query 就是一个以 <code>?</code> 开头的字符串。</li></ol><h3><span id="thisrequest"></span>this.request<a href="#thisrequest" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>被解析出来的 request 字符串。</p><p>在我们的<a href="#example-for-the-loader-context">示例</a>中：<code>&#x27;/abc/loader1.js?xyz!/abc/node_modules/loader2/index.js!/abc/resource.js?rrr&#x27;</code></p><h3><span id="thisresolve"></span>this.resolve<a href="#thisresolve" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><pre><code class="hljs language-typescript"><span class="token function">resolve</span><span class="token punctuation">(</span>context<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> request<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token function-variable function">callback</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> result<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>像 require 表达式一样解析一个 request。</p><ul><li><code>context</code> 必须是一个目录的绝对路径。此目录用作解析的起始位置。</li><li><code>request</code> 是要被解析的 request。通常情况下，像 <code>./relative</code> 的相对请求或者像 <code>module/path</code> 的模块请求会被使用，但是像 <code>/some/path</code> 也有可能被当做 request。</li><li><code>callback</code> 是一个给出解析路径的 Node.js 风格的回调函数。</li></ul><p>解析操作的所有依赖项都会自动作为依赖项添加到当前模块中。</p><h3><span id="thisresource"></span>this.resource<a href="#thisresource" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>request 中的资源部分，包括 query 参数。</p><p>在<a href="#example-for-the-loader-context">示例</a>中：<code>&#x27;/abc/resource.js?rrr&#x27;</code></p><h3><span id="thisresourcepath"></span>this.resourcePath<a href="#thisresourcepath" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>资源文件的路径。</p><p>在【示例](#example-for-the-loader-context)中：<code>&#x27;/abc/resource.js&#x27;</code></p><h3><span id="thisresourcequery"></span>this.resourceQuery<a href="#thisresourcequery" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>资源的 query 参数。</p><p>在<a href="#example-for-the-loader-context">示例</a>中：<code>&#x27;?rrr&#x27;</code></p><h3><span id="thisrootcontext"></span>this.rootContext<a href="#thisrootcontext" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>从 webpack 4 开始，原先的 <code>this.options.context</code> 被改为 <code>this.rootContext</code>。</p><h3><span id="thissourcemap"></span>this.sourceMap<a href="#thissourcemap" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>是否应该生成一个 source map。因为生成 source map 可能会非常耗时，你应该确认 source map 确实需要。</p><h3><span id="thistarget"></span>this.target<a href="#thistarget" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>compilation 的目标。从配置选项中传递。</p><p>示例：&#x27;<code>web&#x27;</code>, <code>&#x27;node&#x27;</code></p><h3><span id="thisutils"></span>this.utils<a href="#thisutils" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><span class="badge">5.27.0+</span><p>可以访问 <code>contextify</code> 与 <code>absolutify</code> 功能。</p><ul><li><code>contextify</code>: 返回一个新的请求字符串，尽可能避免使用绝对路径。</li><li><code>absolutify</code>: 尽可能使用相对路径返回一个新的请求字符串。</li></ul><p><strong>my-sync-loader.js</strong></p><pre><code class="hljs language-js">module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">content</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">contextify</span><span class="token punctuation">(</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">,</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">absolutify</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">,</span> <span class="token string">&#x27;./index.js&#x27;</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">absolutify</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>resourcePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// …</span>
  <span class="token keyword">return</span> content<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><h3><span id="thisversion"></span>this.version<a href="#thisversion" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><strong>loader API 的版本号</strong> 目前是 <code>2</code>。这对于向后兼容性有一些用处。通过这个版本号，你可以自定义逻辑或者降级处理。</p><h3><span id="thiswebpack"></span>this.webpack<a href="#thiswebpack" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>如果是由 webpack 编译的，这个布尔值会被设置为 true。</p><aside class="tip"><h6 class="tip__prefix">提示</h6><p>loader 最初被设计为可以同时当 Babel transform 用。如果你编写了一个 loader 可以同时兼容二者，那么可以使用这个属性了解是否存在可用的 loaderContext 和 webpack 特性。</p></aside><h2><span id="webpack-specific-properties"></span>Webpack 特有属性<a href="#webpack-specific-properties" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>loader 接口提供所有模块的相关信息。然而，在极少数情况下，你可能需要访问 compiler api 本身。</p><aside class="warning"><h6 class="warning__prefix">警告</h6><p>请注意，使用这些 webpack 特定的属性会对 loader 的兼容性产生负面影响。</p></aside><p>因此，你应该把它们作为最后的手段。使用它们将降低 loader 的可移植性。</p><h3><span id="this_compilation"></span>this._compilation<a href="#this_compilation" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>用于访问 webpack 的当前 Compilation 对象。</p><h3><span id="this_compiler"></span>this._compiler<a href="#this_compiler" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>用于访问 webpack 的当前 Compiler 对象。</p><h2><span id="deprecated-context-properties"></span>过时的上下文属性<a href="#deprecated-context-properties" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>由于我们计划将这些属性从上下文中移除，因此不鼓励使用这些属性。它们仍然列在这里，以备参考。</p><h3><span id="thisdebug"></span>this.debug<a href="#thisdebug" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>一个布尔值，当处于 debug 模式时为 true。</p><h3><span id="thisinputvalue"></span>this.inputValue<a href="#thisinputvalue" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>从上一个 loader 那里传递过来的值。如果你会以模块的方式处理输入参数，建议预先读入这个变量（为了性能因素）。</p><h3><span id="thisminimize"></span>this.minimize<a href="#thisminimize" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>决定处理结果是否应该被压缩。</p><h3><span id="thisvalue"></span>this.value<a href="#thisvalue" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>向下一个 loader 传值。如果你知道了作为模块执行后的结果，请在这里赋值（以元素数组的形式）。</p><h3><span id="this_module"></span>this._module<a href="#this_module" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>一种 hack 写法。用于访问当前加载的 Module 对象。</p><h2><span id="error-reporting"></span>错误报告<a href="#error-reporting" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>您可以通过以下方式从 loader 内部报告错误：</p><ul><li>使用 <a href="/api/loaders/#thisemiterror">this.emitError</a>. 将在不中断模块编译的情况下报告错误。</li><li>使用 <code>throw</code>（或其他未捕获的意外异常）。loader 运行时引发错误将导致当前模块编译失败。</li><li>使用 <code>callback</code>（异步模式）。向回调传递错误也会导致模块编译失败。</li></ul><p>示例：</p><p><strong>./src/index.js</strong></p><pre><code class="hljs language-javascript"><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;./loader!./lib&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>从 loader 当中抛出错误：</p><p><strong>./src/loader.js</strong></p><pre><code class="hljs language-javascript">module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">source</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&#x27;This is a Fatal Error!&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>或者在异步模式下，传入一个错误给 callback：</p><p><strong>./src/loader.js</strong></p><pre><code class="hljs language-javascript">module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">source</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> callback <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">async</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//...</span>
  <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&#x27;This is a Fatal Error!&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> source<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>这个模块将获取像下面的 bundle：</p><pre><code class="hljs language-text">/***/ &quot;./src/loader.js!./src/lib.js&quot;:
/*!************************************!*\
  !*** ./src/loader.js!./src/lib.js ***!
  \************************************/
/*! no static exports found */
/***/ (function(module, exports) {

throw new Error(&quot;Module build failed (from ./src/loader.js):\nError: This is a Fatal Error!\n    at Object.module.exports (/workspace/src/loader.js:3:9)&quot;);

/***/ })
</code></pre><p>然后构建输出结果将显示错误，与 <code>this.emitError</code> 相似:</p><pre><code class="hljs language-bash">ERROR <span class="token keyword">in</span> ./src/lib.js <span class="token punctuation">(</span>./src/loader.js<span class="token operator">!</span>./src/lib.js<span class="token punctuation">)</span>
Module build failed <span class="token punctuation">(</span>from ./src/loader.js<span class="token punctuation">)</span>:
Error: This is a Fatal Error<span class="token operator">!</span>
    at Object.module.exports <span class="token punctuation">(</span>/workspace/src/loader.js:2:9<span class="token punctuation">)</span>
 @ ./src/index.js <span class="token number">1</span>:0-25</code></pre><p>如下所示，不仅有错误消息，还提供了有关所涉及的 loader 和模块的详细信息：</p><ul><li>模块路径：<code>ERROR in ./src/lib.js</code></li><li>request 字符串：<code>(./src/loader.js!./src/lib.js)</code></li><li>loader 路径：<code>(from ./src/loader.js)</code></li><li>调用路径：<code>@ ./src/index.js 1:0-25</code></li></ul><aside class="warning"><h6 class="warning__prefix">警告</h6><p>从 webpack 4.12 开始，loader 路径将在报错信息中显示。</p></aside><aside class="tip"><h6 class="tip__prefix">提示</h6><p>所有的报错和警告信息将被记录到 <code>stats</code> 当中。详情请查看 <a href="/api/stats/#errors-and-warnings">Stats Data</a>。</p></aside><h2><span id="inline-matchresource"></span>Inline matchResource<a href="#inline-matchresource" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>在 webpack v4 中引入了一种新的内联请求语法。前缀为 <code>&lt;match-resource&gt;!=!</code> 将为此请求设置 <code>matchResource</code>。</p><aside class="warning"><h6 class="warning__prefix">警告</h6><p>不建议在应用程序代码中使用此语法。
内联请求语法仅用于 loader 生成的代码。
不遵循此建议将使您的代码不遵循 webpack 标准和规范。</p></aside><aside class="tip"><h6 class="tip__prefix">提示</h6><p>相对的 <code>matchResource</code> 将相对包含模块的当前上下文进行解析。</p></aside><p>当 <code>matchResource</code> 被设置时，它将会被用作匹配 <a href="/configuration/module/#modulerules"><code>module.rules</code></a> 而不是源文件。如果需要对资源应用进一步的 loader，或者需要更改模块类型，这可能会很有用。 它也显示在统计数据中，用于匹配 <a href="/configuration/module/#ruleissuer"><code>Rule.issuer</code></a> 和 <a href="/plugins/split-chunks-plugin/#splitchunkscachegroupscachegrouptest"><code>test</code> in <code>splitChunks</code></a>。</p><p>示例：</p><p><strong>file.js</strong></p><pre><code class="hljs language-javascript"><span class="token comment">/* STYLE: body { background: red; } */</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#x27;yep&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>loader 可以将文件转换为以下文件，并使用 <code>matchResource</code> 应用用户指定的 CSS 处理规则：</p><p><strong>file.js</strong> (transformed by loader)</p><pre><code class="hljs language-javascript"><span class="token keyword">import</span> <span class="token string">&#x27;./file.js.css!=!extract-style-loader/getStyles!./file.js&#x27;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#x27;yep&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>这将会向 <code>extract-style-loader/getStyles!./file.js</code> 中添加一个依赖，并将结果视为 <code>file.js.css</code>。因为 <a href="/configuration/module/#modulerules"><code>module.rules</code></a> 有一条匹配 <code>/\.css$/</code> 的规则，并且将会应用到依赖中。</p><p>这个 loader 就像是这样：</p><p><strong>extract-style-loader/index.js</strong></p><pre><code class="hljs language-javascript"><span class="token keyword">const</span> getStylesLoader <span class="token operator">=</span> require<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&#x27;./getStyles&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">source</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">STYLES_REGEXP</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    source <span class="token operator">=</span> source<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token constant">STYLES_REGEXP</span><span class="token punctuation">,</span> <span class="token string">&#x27;&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">import </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">contextify</span><span class="token punctuation">(</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>context <span class="token operator">||</span> <span class="token keyword">this</span><span class="token punctuation">.</span>rootContext<span class="token punctuation">,</span>
        <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>resource<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.css!=!</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>getStylesLoader<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">!</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>remainingRequest<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
      <span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>source<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> source<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p><strong>extract-style-loader/getStyles.js</strong></p><pre><code class="hljs language-javascript">module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">source</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> match <span class="token operator">=</span> source<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token constant">STYLES_REGEXP</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> match<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><h2><span id="logging"></span>Logging<a href="#logging" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>自 webpack 4.37 发布以来，Logging API 就可用了。当 <a href="/configuration/stats/#statslogging"><code>stats configuration</code></a> 或者 <a href="/configuration/other-options/#infrastructurelogging"><code>infrastructure logging</code></a> 中启用 <code>logging</code> 时，loader 可以记录消息，这些消息将以相应的日志格式（stats，infrastructure）打印出来。</p><ul><li>Loaders 最好使用 <code>this.getLogger()</code> 进行日志记录，这是指向 <code>compilation.getLogger()</code> 具有 loader 路径和已处理的文件。这种日志记录被存储到 Stats 中并相应地格式化。它可以被 webpack 用户过滤和导出。</li><li>Loaders 可以使用 <code>this.getLogger(&#x27;name&#x27;)</code> 获取具有子名称的独立记录器。仍会添加 loader 路径和已处理的文件。</li><li>Loaders 可以使用特殊的回退逻辑来检测日志支持 <code>this.getLogger() ? this.getLogger() : console</code>。在使用不支持 <code>getLogger</code> 方法的旧 webpack 版本时提供回退方法。</li></ul><h1><span id="Logger-接口"></span>Logger 接口<a href="#Logger-%E6%8E%A5%E5%8F%A3" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1>
<p>使用 Logger 输出消息是一种向用户展示信息的有效方式。</p><p>Webpack Logger 可以用在 <a href="/loaders/">loader</a> 和 <a href="/api/plugins/#logging">plugin</a>。生成的 Logger 将作为 <a href="/api/stats/">统计信息</a> 的一部分进行输出，并且用户可以在 <a href="/configuration/">webpack 配置文件</a> 中对 Logger 进行配置。</p><p>在 Webpack 中使用自定义 Logger API 的优点：</p><ul><li>可以 <a href="/configuration/stats/#statslogging">配置</a> 日志的展示级别</li><li>日志内容可作为 <code>stats.json</code> 的一部分输出</li><li>统计预设会影响日志的输出</li><li>使用 plugin 可以影响日志的捕获与展示级别</li><li>当使用多个 plugin 和 loader 时，提供更加通用的日志记录解决方案</li><li>基于 Webpack 开发的 CLI、UI 工具等可能会选择不同的方式来展示日志</li><li>Webpack 核心可以触发日志输出，例如：timing data</li></ul><p>通过引入 Webpack Logger API，我们希望统一 Webpack plugins 和 loaders 生成日志的方式，并提供更好的方法来检查构建问题。 集成的 Logging 解决方案可以帮助 plugins 和 loader 的开发人员提升他们的开发经验。同时为非 CLI 形式的 Webpack 解决方案构建铺平了道路，例如 dashboard 或其他 UI。</p><aside class="warning"><h6 class="warning__prefix">警告</h6><p><strong>避免在日志中输出无效信息！</strong> 请记住，多个 plugin 和 loader 经常一起使用。loader 通常处理多个文件，并且每个文件都会调用，所以尽可能选择较低的日志级别以保证 log 的信息量。</p></aside><h2><span id="examples-of-how-to-get-and-use-webpack-logger-in-loaders-and-plugins"></span>Examples of how to get and use webpack logger in loaders and plugins<a href="#examples-of-how-to-get-and-use-webpack-logger-in-loaders-and-plugins" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p><strong>my-webpack-plugin.js</strong></p><pre><code class="hljs language-js"><span class="token keyword">const</span> <span class="token constant">PLUGIN_NAME</span> <span class="token operator">=</span> <span class="token string">&#x27;my-webpack-plugin&#x27;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">MyWebpackPlugin</span> <span class="token punctuation">{</span>
  <span class="token function">apply</span><span class="token punctuation">(</span><span class="token parameter">compiler</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// you can access Logger from compiler</span>
    <span class="token keyword">const</span> logger <span class="token operator">=</span> compiler<span class="token punctuation">.</span><span class="token function">getInfrastructureLogger</span><span class="token punctuation">(</span><span class="token constant">PLUGIN_NAME</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    logger<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#x27;log from compiler&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>compilation<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token constant">PLUGIN_NAME</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">compilation</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// you can also access Logger from compilation</span>
      <span class="token keyword">const</span> logger <span class="token operator">=</span> compilation<span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token constant">PLUGIN_NAME</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&#x27;log from compilation&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><p><strong>my-webpack-loader.js</strong></p><pre><code class="hljs language-js">module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">source</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// you can get Logger with `this.getLogger` in your webpack loaders</span>
  <span class="token keyword">const</span> logger <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token string">&#x27;my-webpack-loader&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&#x27;hello Logger&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> source<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>从上面的 <code>my-webpack-plugin.js</code> 例子中你可以看到，有两种打印日志的方法，</p><ol><li><code>compilation.getLogger</code></li><li><code>compiler.getInfrastructureLogger</code></li></ol><p>当 plugin/logging 与编译相关时，建议使用 <code>compilation.getLogger</code>，它们将存储在 stats 中。对于在编译周期之外发生的日志记录，请改用 <code>compiler.getInfrastructureLogger</code>。</p><h2><span id="logger-methods"></span>Logger methods<a href="#logger-methods" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><ul><li><code>logger.error(...)</code>：用于输出错误信息</li><li><code>logger.warn(...)</code>：用于输出警告信息</li><li><code>logger.info(...)</code>：用于输出<strong>重要</strong>信息。默认情况下会显示这些信息，所以仅用于输出用户真正需要查看的消息</li><li><code>logger.log(...)</code>：用于输出<strong>不重要</strong>的信息。只有当用户选择查看时，才会显示</li><li><code>logger.debug(...)</code>：用于输出调试信息。只有当用户选择查看特定模块的调试日志时，才会显示</li><li><code>logger.trace()</code>：显示堆栈跟踪信息，展示形式类似于 <code>logger.debug</code></li><li><code>logger.group(...)</code>：将消息进行分组，展示形式类似于 <code>logger.log</code></li><li><code>logger.groupEnd()</code>：结束消息分组</li><li><code>logger.groupCollapsed(...)</code>：将消息进行分组。默认显示为折叠 <code>logger.log</code> 日志，当日志记录级别设置为 <code>&#x27;verbose&#x27;</code> 或 <code>&#x27;debug&#x27;</code> 时，显示展开的日志</li><li><code>logger.status</code>：写入一条临时消息，并且设置新状态，覆盖上一个状态</li><li><code>logger.clear()</code>：打印水平线。展示形式类似于 <code>logger.log</code></li><li><code>logger.profile(...)</code>，<code>logger.profileEnd(...)</code>：捕获配置文件。当支持 <code>console.profile</code> API 时，使用其进行输出</li></ul><h2><span id="runtime-logger-api"></span>Runtime Logger API<a href="#runtime-logger-api" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>Runtime logger API 仅应该用作开发工具，不应该包含在 <a href="/configuration/mode/#mode-production">生产模式</a>中。</p><ul><li><code>const logging = require(&#x27;webpack/lib/logging/runtime&#x27;)</code>：直接从 Webpack 中引入即可使用 logger API</li><li><code>logging.getLogger(&#x27;name&#x27;)</code>：根据名称获取一个 logger 的实例</li><li><code>logging.configureDefaultLogger(...)</code>：重写 logger 的默认配置</li></ul><pre><code class="hljs language-javascript"><span class="token keyword">const</span> logging <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;webpack/lib/logging/runtime&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
logging<span class="token punctuation">.</span><span class="token function">configureDefaultLogger</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  level<span class="token operator">:</span> <span class="token string">&#x27;log&#x27;</span><span class="token punctuation">,</span>
  debug<span class="token operator">:</span> <span class="token regex">/something/</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><ul><li><code>logging.hooks.log</code>：向 logger 中添加 Plugins</li></ul><h1><span id="模块方法"></span>模块方法<a href="#%E6%A8%A1%E5%9D%97%E6%96%B9%E6%B3%95" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1>
<p>本章节涵盖了使用 webpack 编译代码的所有方法。在 webpack 打包应用程序时，你可以选择各种模块语法风格，包括 <a href="https://en.wikipedia.org/wiki/ECMAScript#6th_Edition_-_ECMAScript_2015">ES6</a>，<a href="https://en.wikipedia.org/wiki/CommonJS">CommonJS</a> 和 <a href="https://en.wikipedia.org/wiki/Asynchronous_module_definition">AMD</a>。</p><p>尽管 webpack 支持多种模块语法，但我们还是建议尽量使用一致的语法，以此避免一些奇怪的行为和 bug。事实上，当距离最近的 <code>package.json</code> 文件中包含值为 <code>&quot;module&quot;</code> 或 <code>&quot;commonjs&quot;</code> 的 <code>&quot;type&quot;</code> 字段时，webpack 会启用语法一致性检查。请大家在阅读前，注意此情况：</p><ul><li>在 <code>package.json</code> 中为 <code>.mjs</code> 或 <code>.js</code> 设置 <code>&quot;type&quot;: &quot;module&quot;</code><ul><li>不允许使用 CommonJS，例如，你不能使用 <code>require</code>，<code>module.exports</code> 或 <code>exports</code></li><li>当引入文件时，强制编写扩展名，例如，你应使用 <code>import &#x27;./src/App.mjs&#x27;</code>，而非 <code>import &#x27;./src/App&#x27;</code>（你可以通过设置 <a href="/configuration/module/#resolve-fully-specified"><code>Rule.resolve.fullySpecified</code></a> 来禁用此规则)</li></ul></li><li>在 <code>package.json</code> 中为 <code>.cjs</code> 或 <code>.js</code> 设置 <code>&quot;type&quot;: &quot;commonjs&quot;</code><ul><li><code>import</code> 和 <code>export</code> 均不可用</li></ul></li><li>在 <code>package.json</code> 中为 <code>.wasm</code> 设置 <code>&quot;type&quot;: &quot;module&quot;</code><ul><li>引入 wasm 文件时，必须编写文件扩展名</li></ul></li></ul><h2><span id="es6-recommended"></span>ES6 (推荐)<a href="#es6-recommended" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>webpack 2 支持原生的 ES6 模块语法，意味着你无须额外引入 babel 这样的工具，就可以使用 <code>import</code> 和 <code>export</code>。但是注意，如果使用其他的 ES6+ 特性，仍然需要引入 babel。webpack 支持以下的方法：</p><h3><span id="import"></span>import<a href="#import" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>通过 <code>import</code> 以静态的方式导入另一个通过 <code>export</code> 导出的模块。</p><pre><code class="hljs language-javascript"><span class="token keyword">import</span> MyModule <span class="token keyword">from</span> <span class="token string">&#x27;./my-module.js&#x27;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> NamedExport <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;./other-module.js&#x27;</span><span class="token punctuation">;</span></code></pre><aside class="warning"><h6 class="warning__prefix">警告</h6><p>这里的关键词是<strong>静态的</strong>。标准的 <code>import</code> 语句中，模块语句中不能以「具有逻辑或含有变量」的动态方式去引入其他模块。关于 import 的更多信息和 <code>import()</code> 动态用法，请查看这里的<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import">说明</a>。</p></aside><p>你也通过 <code>import</code> 来引入 Data URI：</p><pre><code class="hljs language-javascript"><span class="token keyword">import</span> <span class="token string">&#x27;data:text/javascript;charset=utf-8;base64,Y29uc29sZS5sb2coJ2lubGluZSAxJyk7&#x27;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
  number<span class="token punctuation">,</span>
  fn<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;data:text/javascript;charset=utf-8;base64,ZXhwb3J0IGNvbnN0IG51bWJlciA9IDQyOwpleHBvcnQgY29uc3QgZm4gPSAoKSA9PiAiSGVsbG8gd29ybGQiOw==&#x27;</span><span class="token punctuation">;</span></code></pre><h3><span id="export"></span>export<a href="#export" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>默认</code>导出整个模块或具名导出模块。</p><pre><code class="hljs language-javascript"><span class="token comment">// 具名导出</span>
<span class="token keyword">export</span> <span class="token keyword">var</span> Count <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">Multiply</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> a <span class="token operator">*</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 默认导出</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token comment">// Some data...</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><h3><span id="import"></span>import()<a href="#import" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>function(string path):Promise</code></p><p>动态的加载模块。调用 <code>import</code> 的之处，被视为分割点，意思是，被请求的模块和它引用的所有子模块，会分割到一个单独的 chunk 中。</p><aside class="tip"><h6 class="tip__prefix">提示</h6><p><a href="https://whatwg.github.io/loader/">ES2015 Loader 规范</a> 定义了 <code>import()</code> 方法，可以在运行时动态地加载 ES2015 模块。</p></aside><pre><code class="hljs language-javascript"><span class="token keyword">if</span> <span class="token punctuation">(</span>module<span class="token punctuation">.</span>hot<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&#x27;lodash&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">_</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// Do something with lodash (a.k.a &#x27;_&#x27;)...</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><aside class="warning"><h6 class="warning__prefix">警告</h6><p>import() 特性依赖于内置的 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise"><code>Promise</code></a>。如果想在低版本浏览器中使用 <code>import()</code>，记得使用像 <a href="https://github.com/stefanpenner/es6-promise">es6-promise</a> 或者 <a href="https://github.com/taylorhakes/promise-polyfill">promise-polyfill</a> 这样 polyfill 库，来预先填充(shim) <code>Promise</code> 环境。</p></aside><h3><span id="dynamic-expressions-in-import"></span>import() 中的表达式<a href="#dynamic-expressions-in-import" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>不能使用完全动态的 import 语句，例如 <code>import(foo)</code>。是因为 <code>foo</code> 可能是系统或项目中任何文件的任何路径。</p><p><code>import()</code> 必须至少包含一些关于模块的路径信息。打包可以限定于一个特定的目录或文件集，以便于在使用动态表达式时 - 包括可能在 <code>import()</code> 调用中请求的每个模块。例如， <code>import(`./locale/${language}.json`)</code> 会把 <code>.locale</code> 目录中的每个 <code>.json</code> 文件打包到新的 chunk 中。在运行时，计算完变量 <code>language</code> 后，就可以使用像 <code>english.json</code> 或 <code>german.json</code> 的任何文件。</p><pre><code class="hljs language-javascript"><span class="token comment">// 想象我们有一个从 cookies 或其他存储中获取语言的方法</span>
<span class="token keyword">const</span> language <span class="token operator">=</span> <span class="token function">detectVisitorLanguage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">import</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">./locale/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>language<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.json</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">module</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// do something with the translations</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><aside class="tip"><h6 class="tip__prefix">提示</h6><p>使用 <a href="/api/module-methods/#magic-comments"><code>webpackInclude</code> and <code>webpackExclude</code></a> 选项可让你添加正则表达式模式，以减少 webpack 打包导入的文件数量。</p></aside><h4><span id="magic-comments"></span>Magic Comments<a href="#magic-comments" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4><p>内联注释使这一特性得以实现。通过在 import 中添加注释，我们可以进行诸如给 chunk 命名或选择不同模式的操作。</p><pre><code class="hljs language-js"><span class="token comment">// 单个目标</span>
<span class="token keyword">import</span><span class="token punctuation">(</span>
  <span class="token comment">/* webpackChunkName: &quot;my-chunk-name&quot; */</span>
  <span class="token comment">/* webpackMode: &quot;lazy&quot; */</span>
  <span class="token comment">/* webpackExports: [&quot;default&quot;, &quot;named&quot;] */</span>
  <span class="token string">&#x27;module&#x27;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 多个可能的目标</span>
<span class="token keyword">import</span><span class="token punctuation">(</span>
  <span class="token comment">/* webpackInclude: /\.json$/ */</span>
  <span class="token comment">/* webpackExclude: /\.noimport\.json$/ */</span>
  <span class="token comment">/* webpackChunkName: &quot;my-chunk-name&quot; */</span>
  <span class="token comment">/* webpackMode: &quot;lazy&quot; */</span>
  <span class="token comment">/* webpackPrefetch: true */</span>
  <span class="token comment">/* webpackPreload: true */</span>
  <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">./locale/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>language<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><pre><code class="hljs language-js"><span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackIgnore: true */</span> <span class="token string">&#x27;ignored-module.js&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><code>webpackIgnore</code>：设置为 true 时，禁用动态导入解析。</p><aside class="warning"><h6 class="warning__prefix">警告</h6><p>注意：将 <code>webpackIgnore</code> 设置为 <code>true</code> 则不进行代码分离。</p></aside><p><code>webpackChunkName</code>: 新 chunk 的名称。 从 webpack 2.6.0 开始，占位符 <code>[index]</code> 和 <code>[request]</code> 分别支持递增的数字或实际的解析文件名。 添加此注释后，将单独的给我们的 chunk 命名为 [my-chunk-name].js 而不是 [id].js。</p><p><code>webpackMode</code>：从 webpack 2.6.0 开始，可以指定以不同的模式解析动态导入。支持以下选项：</p><ul><li><code>&#x27;lazy&#x27;</code> (默认值)：为每个 <code>import()</code> 导入的模块生成一个可延迟加载（lazy-loadable）的 chunk。</li><li><code>&#x27;lazy-once&#x27;</code>：生成一个可以满足所有 <code>import()</code> 调用的单个可延迟加载（lazy-loadable）的 chunk。此 chunk 将在第一次 <code>import()</code> 时调用时获取，随后的 <code>import()</code> 则使用相同的网络响应。注意，这种模式仅在部分动态语句中有意义，例如 <code>import(`./locales/${language}.json`)</code>，其中可能含有多个被请求的模块路径。</li><li><code>&#x27;eager&#x27;</code>：不会生成额外的 chunk。所有的模块都被当前的 chunk 引入，并且没有额外的网络请求。但是仍会返回一个 resolved 状态的 <code>Promise</code>。与静态导入相比，在调用 <code>import()</code> 完成之前，该模块不会被执行。</li><li><code>&#x27;weak&#x27;</code>：尝试加载模块，如果该模块函数已经以其他方式加载，（即另一个 chunk 导入过此模块，或包含模块的脚本被加载）。仍会返回 <code>Promise</code>， 但是只有在客户端上已经有该 chunk 时才会成功解析。如果该模块不可用，则返回 rejected 状态的 <code>Promise</code>，且网络请求永远都不会执行。当需要的 chunks 始终在（嵌入在页面中的）初始请求中手动提供，而不是在应用程序导航在最初没有提供的模块导入的情况下触发，这对于通用渲染（SSR）是非常有用的。</li></ul><p><code>webpackPrefetch</code>：告诉浏览器将来可能需要该资源来进行某些导航跳转。查看指南，了解有关更多信息 <a href="/guides/code-splitting/#prefetchingpreloading-modules">how webpackPrefetch works</a>。</p><p><code>webpackPreload</code>：告诉浏览器在当前导航期间可能需要该资源。 查阅指南，了解有关的更多信息 <a href="/guides/code-splitting/#prefetchingpreloading-modules">how webpackPreload works</a>。</p><aside class="tip"><h6 class="tip__prefix">提示</h6><p>注意：所有选项都可以像这样组合 <code>/* webpackMode: &quot;lazy-once&quot;, webpackChunkName: &quot;all-i18n-data&quot; */</code>。这会按没有花括号的 JSON5 对象去解析。它会被包裹在 JavaScript 对象中，并使用 <a href="https://nodejs.org/dist/latest-v8.x/docs/api/vm.html">node VM</a> 执行。所以你不需要添加花括号。</p></aside><p><code>webpackInclude</code>：在导入解析（import resolution）过程中，用于匹配的正则表达式。只有匹配到的模块<strong>才会被打包</strong>。</p><p><code>webpackExclude</code>：在导入解析（import resolution）过程中，用于匹配的正则表达式。所有匹配到的模块<strong>都不会被打包</strong>。</p><aside class="tip"><h6 class="tip__prefix">提示</h6><p>注意，<code>webpackInclude</code> 和 <code>webpackExclude</code> 不会影响到前缀，例如 <code>./locale</code>。</p></aside><p><code>webpackExports</code>: 告知 webpack 只构建指定出口的动态 <code>import()</code> 模块。它可以减小 chunk 的大小。从 <a href="https://github.com/webpack/webpack/releases/tag/v5.0.0-beta.18">webpack 5.0.0-beta.18</a> 起可用。</p><h2><span id="commonjs"></span>CommonJS<a href="#commonjs" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>CommonJS 的目标是为浏览器之外的 JavaScript 指定一个生态系统。webpack 支持以下 CommonJS 的方法：</p><h3><span id="require"></span><code>require</code><a href="#require" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><pre><code class="hljs language-typescript"><span class="token keyword">require</span><span class="token punctuation">(</span>dependency<span class="token operator">:</span> String<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>以同步的方式检索其他模块的导出。编译器（compiler）会确保依赖项在输出 bundle 中可用。</p><pre><code class="hljs language-javascript"><span class="token keyword">var</span> $ <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;jquery&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> myModule <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;my-module&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>也可以为 <code>require</code> 启用魔法注释，请参阅 <a href="/configuration/module/#moduleparserjavascriptcommonjsmagiccomments"><code>module.parser.javascript.commonjsMagicComments</code></a> 了解更多。</p><aside class="warning"><h6 class="warning__prefix">警告</h6><p>以异步的方式使用，可能不会达到预期效果。</p></aside><h3><span id="requireresolve"></span>require.resolve<a href="#requireresolve" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><pre><code class="hljs language-typescript"><span class="token keyword">require</span><span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>dependency<span class="token operator">:</span> String<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>以同步的方式获取模块的 ID。编译器（compiler）会确保依赖项在最终输出 bundle 中可用。建议将其视为不透明值，只能与 <code>require.cache[id]</code> 或 <code>__webpack_require__(id)</code> 配合使用（最好避免这种用法）。</p><aside class="warning"><h6 class="warning__prefix">警告</h6><p>模块 ID 的类型可以是 <code>number</code> 或 <code>string</code>，具体取决于 <a href="/configuration/optimization/#optimizationmoduleids"><code>optimization.moduleIds</code></a> 配置。</p></aside><p>有关更多模块的信息，详见 <a href="/api/module-variables/#moduleid-commonjs"><code>module.id</code></a>。</p><h3><span id="requirecache"></span>require.cache<a href="#requirecache" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>多处引用同一模块，最终只会产生一次模块执行和一次导出。所以，会在运行时（runtime）中会保存一份缓存。删除此缓存，则会产生新的模块执行和新的导出。</p><aside class="warning"><h6 class="warning__prefix">警告</h6><p>仅在极少数情况下才需要考虑兼容性！</p></aside><pre><code class="hljs language-javascript"><span class="token keyword">var</span> d1 <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;dependency&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;dependency&#x27;</span><span class="token punctuation">)</span> <span class="token operator">===</span> d1<span class="token punctuation">;</span>
<span class="token keyword">delete</span> require<span class="token punctuation">.</span>cache<span class="token punctuation">[</span>require<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&#x27;dependency&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;dependency&#x27;</span><span class="token punctuation">)</span> <span class="token operator">!==</span> d1<span class="token punctuation">;</span></code></pre><pre><code class="hljs language-javascript"><span class="token comment">// in file.js</span>
require<span class="token punctuation">.</span>cache<span class="token punctuation">[</span>module<span class="token punctuation">.</span>id<span class="token punctuation">]</span> <span class="token operator">===</span> module<span class="token punctuation">;</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;./file.js&#x27;</span><span class="token punctuation">)</span> <span class="token operator">===</span> module<span class="token punctuation">.</span>exports<span class="token punctuation">;</span>
<span class="token keyword">delete</span> require<span class="token punctuation">.</span>cache<span class="token punctuation">[</span>module<span class="token punctuation">.</span>id<span class="token punctuation">]</span><span class="token punctuation">;</span>
require<span class="token punctuation">.</span>cache<span class="token punctuation">[</span>module<span class="token punctuation">.</span>id<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;./file.js&#x27;</span><span class="token punctuation">)</span> <span class="token operator">!==</span> module<span class="token punctuation">.</span>exports<span class="token punctuation">;</span> <span class="token comment">// 理论上是不相等的；实际运行中，则会导致堆栈溢出</span>
require<span class="token punctuation">.</span>cache<span class="token punctuation">[</span>module<span class="token punctuation">.</span>id<span class="token punctuation">]</span> <span class="token operator">!==</span> module<span class="token punctuation">;</span></code></pre><h3><span id="requireensure"></span>require.ensure<a href="#requireensure" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><aside class="warning"><h6 class="warning__prefix">警告</h6><p><code>require.ensure()</code> 是 webpack 特有的，已被 <code>import()</code> 取代。</p></aside><pre><code class="hljs language-ts"><span class="token keyword">require</span><span class="token punctuation">.</span><span class="token function">ensure</span><span class="token punctuation">(</span>
  dependencies<span class="token operator">:</span> String<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token function-variable function">callback</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token keyword">require</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function-variable function">errorCallback</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">,</span>
  chunkName<span class="token operator">:</span> String
<span class="token punctuation">)</span></code></pre><p>给定 <code>dependencies</code> 参数，将其对应的文件拆分到一个单独的 bundle 中，此 bundle 会被异步加载。当使用 CommonJS 模块语法时，这是动态加载依赖项的唯一方法。这意味着，可以在模块执行时才允许代码，只有在满足特定条件时才会加载 <code>dependencies</code>。</p><aside class="warning"><h6 class="warning__prefix">警告</h6><p>这个特性依赖内置的 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise"><code>Promise</code></a>。如果你在低版本浏览器中使用 <code>require.ensure</code>，记得使用像 <a href="https://github.com/stefanpenner/es6-promise">es6-promise</a> 或 <a href="https://github.com/taylorhakes/promise-polyfill">promise-polyfill</a> 这样的 polyfill 库，预先填充（shim）<code>Promise</code> 环境。</p></aside><pre><code class="hljs language-javascript"><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;normal-dep&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>module<span class="token punctuation">.</span>hot<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  require<span class="token punctuation">.</span><span class="token function">ensure</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#x27;b&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">require</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;c&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Do something special...</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>按照上面指定的顺序，<code>require.ensure</code> 支持以下参数：</p><ul><li><code>dependencies</code>：字符串数组，声明 <code>callback</code> 回调函数中所需要的所有模块。</li><li><code>callback</code>：当依赖项加载完成后，webpack 将会执行此函数，<code>require</code> 函数的实现，作为参数传入此函数中。当程序运行需要依赖时，可以使用 <code>require()</code> 来加载依赖。函数体可以使用此参数，来进一步执行 <code>require()</code> 模块。</li><li><code>errorCallback</code>：当 webpack 加载依赖失败时会执行此函数。</li><li><code>chunkName</code>：由 <code>require.ensure</code> 创建的 chunk 的名称。通过将相同 <code>chunkName</code> 传递给不同的 <code>require.ensure</code> 调用，我们可以将其代码合并到一个单独的 chunk 中，从而只产生一个浏览器必须加载的 bundle。</li></ul><aside class="warning"><h6 class="warning__prefix">警告</h6><p>虽然将 <code>require</code> 的实现作为参数（可以使用任意名称）传递给 <code>callback</code> 函数，例如，<code>require.ensure([], function(request) { request(&#x27;someModule&#x27;); })</code> 则不能被 webpack 静态解析器处理，因此还是使用 <code>require</code> 作为参数名，例如，<code>require.ensure([], function(require) { require(&#x27;someModule&#x27;) })</code>。</p></aside><h2><span id="amd"></span>AMD<a href="#amd" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>AMD（Asynchronous Module Definition）是一种定义了用于编写和加载模块接口的 JavaScript 规范。</p><h3><span id="define-with-factory"></span>define (with factory)<a href="#define-with-factory" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><pre><code class="hljs language-ts"><span class="token function">define</span><span class="token punctuation">(</span><span class="token punctuation">[</span>name<span class="token operator">:</span> String<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>dependencies<span class="token operator">:</span> String<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function-variable function">factoryMethod</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>如果提供了 <code>dependencies</code> 参数，就会调用 <code>factoryMethod</code> 方法，并（以相同的顺序）导出每个依赖项。如果未提供 <code>dependencies</code> 参数，调用 <code>factoryMethod</code> 方法时会传入 <code>require</code> , <code>exports</code> 和 <code>module</code>（用于兼容！）。如果此方法返回一个值，则返回值会作为此模块的导出。由编译器（compiler）来确保依赖项在最终输出的 bundle 中可用。</p><aside class="warning"><h6 class="warning__prefix">警告</h6><p>注意：webpack 会忽略 <code>name</code> 参数。</p></aside><pre><code class="hljs language-javascript"><span class="token function">define</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#x27;jquery&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;my-module&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">$<span class="token punctuation">,</span> myModule</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 使用 $ 和 myModule 做一些操作...</span>

  <span class="token comment">// 导出一个函数</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><aside class="warning"><h6 class="warning__prefix">警告</h6><p>上面的写法不能在异步函数中使用。</p></aside><h3><span id="define-with-value"></span>define (with value)<a href="#define-with-value" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><pre><code class="hljs language-ts"><span class="token function">define</span><span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token operator">!</span><span class="token builtin">Function</span><span class="token punctuation">)</span></code></pre><p>这种方式只将提供的 <code>value</code> 导出。这里的 <code>value</code> 可以是除函数以外的任何值。</p><pre><code class="hljs language-javascript"><span class="token function">define</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  answer<span class="token operator">:</span> <span class="token number">42</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><aside class="warning"><h6 class="warning__prefix">警告</h6><p>上面的写法不能在异步函数中使用。</p></aside><h3><span id="require-amd-version"></span>require (amd-version)<a href="#require-amd-version" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><pre><code class="hljs language-ts"><span class="token keyword">require</span><span class="token punctuation">(</span>dependencies<span class="token operator">:</span> String<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token function-variable function">callback</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre><p>与 <code>require.ensure</code> 类似，给定 <code>dependencies</code> 参数，将其对应的文件拆分到一个单独的 bundle 中，此 bundle 会被异步加载。然后会调用 <code>callback</code> 回调函数，并传入 <code>dependencies</code> 数组中的每个项导出。</p><aside class="warning"><h6 class="warning__prefix">警告</h6><p>这个特性依赖内置的 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise"><code>Promise</code></a>。如果你在低版本浏览器中使用 <code>require.ensure</code>，记得使用像 <a href="https://github.com/stefanpenner/es6-promise">es6-promise</a> 或 <a href="https://github.com/taylorhakes/promise-polyfill">promise-polyfill</a> 这样的 polyfill 库，预先填充（shim）<code>Promise</code> 环境。</p></aside><pre><code class="hljs language-javascript"><span class="token function">require</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#x27;b&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;c&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><aside class="warning"><h6 class="warning__prefix">警告</h6><p>这里没有提供命名 bundle 名称的选项。</p></aside><h2><span id="labeled-modules"></span>标签模块(Labeled Modules)<a href="#labeled-modules" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>webpack 内置的 <code>LabeledModulesPlugin</code> 插件，允许你使用下面的方法导出和导入模块：</p><h3><span id="export-label"></span>export label<a href="#export-label" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>导出给定的 <code>value</code>。标签可以出现在函数声明或变量声明之前。函数名或变量名是导出值的标识符。</p><pre><code class="hljs language-ts"><span class="token keyword">export</span><span class="token operator">:</span> <span class="token keyword">var</span> answer <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span>
<span class="token function-variable function">export</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token function">method</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Do something...</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><aside class="warning"><h6 class="warning__prefix">警告</h6><p>在异步函数中使用，可能不会达到预期的效果。</p></aside><h3><span id="require-label"></span>require label<a href="#require-label" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>在当前作用域下，依赖项的所有导出均可用。<code>require</code> 标签可以放置在一个字符串之前。依赖模块必须使用 <code>export</code> 标签导出值。CommonJS 或 AMD 模块无法通过这种方式使用。</p><p><strong>some-dependency.js</strong></p><pre><code class="hljs language-ts"><span class="token keyword">export</span><span class="token operator">:</span> <span class="token keyword">var</span> answer <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span>
<span class="token function-variable function">export</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token function">method</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Do something...</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><pre><code class="hljs language-ts"><span class="token keyword">require</span><span class="token operator">:</span> <span class="token string">&#x27;some-dependency&#x27;</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>answer<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">method</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h2><span id="webpack"></span>Webpack<a href="#webpack" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>除了上述模块语法之外，还允许使用一些 webpack 特定的方法：</p><h3><span id="requirecontext"></span>require.context<a href="#requirecontext" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><pre><code class="hljs language-ts"><span class="token keyword">require</span><span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span>
  <span class="token punctuation">(</span>directory<span class="token operator">:</span> String<span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span>includeSubdirs<span class="token operator">:</span> Boolean<span class="token punctuation">)</span> <span class="token comment">/* 可选的，默认值是 true */</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span>filter<span class="token operator">:</span> RegExp<span class="token punctuation">)</span> <span class="token comment">/* 可选的，默认值是 /^\.\/.*$/，所有文件 */</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span>mode<span class="token operator">:</span> String<span class="token punctuation">)</span>  <span class="token comment">/* 可选的， &#x27;sync&#x27; | &#x27;eager&#x27; | &#x27;weak&#x27; | &#x27;lazy&#x27; | &#x27;lazy-once&#x27;，默认值是 &#x27;sync&#x27; */</span>
<span class="token punctuation">)</span></code></pre><p>指定一系列依赖项，通过使用 <code>directory</code> 的路径，以及 <code>includeSubdirs</code> ，<code>filter</code> 选项，进行更细粒度的模块引入，使用 <code>mode</code> 定义加载方式。以此可以很容易的解析模块：</p><pre><code class="hljs language-javascript"><span class="token keyword">var</span> context <span class="token operator">=</span> require<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span><span class="token string">&#x27;components&#x27;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token regex">/\.html$/</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> componentA <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&#x27;componentA&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>如果 <code>mode</code> 设置为 <code>lazy</code>，基础模块将以异步方式加载：</p><pre><code class="hljs language-javascript"><span class="token keyword">var</span> context <span class="token operator">=</span> require<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span><span class="token string">&#x27;locales&#x27;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token regex">/\.json$/</span><span class="token punctuation">,</span> <span class="token string">&#x27;lazy&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">context</span><span class="token punctuation">(</span><span class="token string">&#x27;localeA&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">locale</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// do something with locale</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><code>mode</code> 的可用模式及说明的完整列表在 <a href="#import"><code>import()</code></a> 文档中进行了描述。</p><h3><span id="requireinclude"></span>require.include<a href="#requireinclude" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><pre><code class="hljs language-ts"><span class="token keyword">require</span><span class="token punctuation">.</span><span class="token function">include</span><span class="token punctuation">(</span><span class="token punctuation">(</span>dependency<span class="token operator">:</span> String<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>引入一个不需要执行的 <code>dependency</code>，这样可以用于优化输出 chunk 中依赖模块的位置。</p><pre><code class="hljs language-javascript">require<span class="token punctuation">.</span><span class="token function">include</span><span class="token punctuation">(</span><span class="token string">&#x27;a&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
require<span class="token punctuation">.</span><span class="token function">ensure</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#x27;a&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;b&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">require</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">/* ... */</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
require<span class="token punctuation">.</span><span class="token function">ensure</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#x27;a&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;c&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">require</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">/* ... */</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>这会产生以下输出：</p><ul><li>entry chunk: <code>file.js</code> and <code>a</code></li><li>anonymous chunk: <code>b</code></li><li>anonymous chunk: <code>c</code></li></ul><p>不使用 <code>require.include(&#x27;a&#x27;)</code>，输出的两个匿名 chunk 都会有模块 a。</p><h3><span id="requireresolveweak"></span>require.resolveWeak<a href="#requireresolveweak" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>与 <code>require.resolve</code> 类似，但是不会把 <code>module</code> 引入到 bundle 中。这就是所谓的“弱（weak）”依赖。</p><pre><code class="hljs language-javascript"><span class="token keyword">if</span> <span class="token punctuation">(</span>__webpack_modules__<span class="token punctuation">[</span>require<span class="token punctuation">.</span><span class="token function">resolveWeak</span><span class="token punctuation">(</span><span class="token string">&#x27;module&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 当模块可用时，执行一些操作……</span>
<span class="token punctuation">}</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>require<span class="token punctuation">.</span>cache<span class="token punctuation">[</span>require<span class="token punctuation">.</span><span class="token function">resolveWeak</span><span class="token punctuation">(</span><span class="token string">&#x27;module&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 在模块加载完成之前，执行一些操作……</span>
<span class="token punctuation">}</span>

<span class="token comment">// 你可以像执行其他 require/import 方法一样，</span>
<span class="token comment">// 执行动态解析上下文 resolves (&quot;context&quot;)。</span>
<span class="token keyword">const</span> page <span class="token operator">=</span> <span class="token string">&#x27;Foo&#x27;</span><span class="token punctuation">;</span>
__webpack_modules__<span class="token punctuation">[</span>require<span class="token punctuation">.</span><span class="token function">resolveWeak</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">./page/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>page<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span></code></pre><aside class="tip"><h6 class="tip__prefix">提示</h6><p><code>require.resolveWeak</code> 是<em>通用渲染</em>（服务器端渲染 SSR + 代码分离 Code Splitting）的基础。例如在 <a href="https://github.com/faceyspacey/react-universal-component">react-universal-component</a> 等包中的用法。它允许代码在服务器端和客户端初始页面的加载上同步渲染。它要求手动或以某种方式提供 chunk。它可以在不需要指示应该被打包的情况下引入模块。它与 <code>import()</code> 一起使用，当用户导航触发额外的导入时，它会被接管。</p></aside><h3><span id="warning"></span>warning<a href="#warning" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>如果模块源码包含无法静态分析的 require，则会发出关键依赖项警告。</p><p>示例代码：</p><pre><code class="hljs language-javascript"><span class="token function">someFn</span><span class="token punctuation">(</span>require<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">require</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">require</span><span class="token punctuation">(</span>variable<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h1><span id="Module-Variables"></span>Module Variables<a href="#Module-Variables" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1>
<p>本章节涵盖了使用 webpack 编译的代码中所有的<strong>变量</strong>。模块将通过 <code>module</code> 和其他变量，来访问编译过程中的某些数据。</p><h2><span id="moduleloaded-nodejs"></span>module.loaded (NodeJS)<a href="#moduleloaded-nodejs" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p><code>false</code> 表示该模块正在执行， <code>true</code> 表示同步执行已经完成。</p><h2><span id="modulehot-webpack-specific"></span>module.hot (webpack-specific)<a href="#modulehot-webpack-specific" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>表示 <a href="/concepts/hot-module-replacement">模块热替换(Hot Module Replacement)</a> 是否启用，并给进程提供一个接口。详细说明请查看 <a href="/api/hot-module-replacement">模块热替换 API 页面</a>。</p><h2><span id="moduleid-commonjs"></span>module.id (CommonJS)<a href="#moduleid-commonjs" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>当前模块的 ID。</p><pre><code class="hljs language-javascript">module<span class="token punctuation">.</span>id <span class="token operator">===</span> require<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&#x27;./file.js&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h2><span id="moduleexports-commonjs"></span>module.exports (CommonJS)<a href="#moduleexports-commonjs" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>调用者通过 <code>require</code> 对模块进行调用时返回的值（默认为一个新对象）。</p><pre><code class="hljs language-javascript">module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Do something...</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><aside class="warning"><h6 class="warning__prefix">警告</h6><p>无法在异步函数中访问该变量。</p></aside><h2><span id="exports-commonjs"></span>exports (CommonJS)<a href="#exports-commonjs" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>该变量默认值为 <code>module.exports</code>（即一个对象）。 如果 <code>module.exports</code> 被重写的话， <code>exports</code> 不再会被导出。</p><pre><code class="hljs language-javascript">exports<span class="token punctuation">.</span>someValue <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>anObject <span class="token operator">=</span> <span class="token punctuation">{</span>
  x<span class="token operator">:</span> <span class="token number">123</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span><span class="token function-variable function">aFunction</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Do something</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><h2><span id="global-nodejs"></span>global (NodeJS)<a href="#global-nodejs" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>见 <a href="https://nodejs.org/api/globals.html#globals_global">node.js global</a>.</p><p>出于兼容性考虑，webpack 默认填充了 <code>global</code> 变量。</p><h2><span id="__dirname-nodejs"></span>__dirname (NodeJS)<a href="#__dirname-nodejs" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>取决于 <code>node.__dirname</code> 配置选项：</p><ul><li><code>false</code>: 未定义</li><li><code>mock</code>: 等同于 <code>&#x27;/&#x27;</code></li><li><code>true</code>: <a href="https://nodejs.org/api/globals.html#globals_dirname">node.js __dirname</a></li></ul><p>如果在一个被 Parser 解析的表达式内部使用，则配置选项会被当作 <code>true</code> 处理。</p><h2><span id="importmetaurl"></span>import.meta.url<a href="#importmetaurl" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>返回模块以 <code>file:</code> 开头绝对路径的 URL。</p><p><strong>src/index.js</strong></p><pre><code class="hljs language-javascript">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出结果类似于 `file:///path/to/your/project/src/index.js`</span></code></pre><h2><span id="importmetawebpack"></span>import.meta.webpack<a href="#importmetawebpack" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>返回 webpack 的版本</p><p><strong>src/index.js</strong></p><pre><code class="hljs language-javascript">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>webpack<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// output `5` for webpack 5</span></code></pre><h2><span id="importmetawebpackHot"></span>import.meta.webpackHot<a href="#importmetawebpackHot" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>webpack 特定。<a href="#modulehot-webpack-specific"><code>module.hot</code></a> 的一个别名，<a href="/guides/ecma-script-modules/#flagging-modules-as-esm">strict ESM</a> 中可以使用 <code>import.meta.webpackHot</code> 但是不能使用 <code>module.hot</code>。</p><h2><span id="importmetawebpackContext"></span>import.meta.webpackContext<a href="#importmetawebpackContext" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>返回与 <code>require.context</code> 一样的值，但是仅用于 <code>javascript/auto</code> 和 <code>javascript/esm</code>。</p><ul><li><p>类型：</p><pre><code class="hljs language-ts"><span class="token punctuation">(</span>
  request<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  options<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    recursive<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
    regExp<span class="token operator">?</span><span class="token operator">:</span> RegExp<span class="token punctuation">;</span>
    include<span class="token operator">?</span><span class="token operator">:</span> RegExp<span class="token punctuation">;</span>
    exclude<span class="token operator">?</span><span class="token operator">:</span> RegExp<span class="token punctuation">;</span>
    preload<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token operator">|</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
    prefetch<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token operator">|</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
    chunkName<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    exports<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    mode<span class="token operator">?</span><span class="token operator">:</span> <span class="token string">&#x27;sync&#x27;</span> <span class="token operator">|</span> <span class="token string">&#x27;eager&#x27;</span> <span class="token operator">|</span> <span class="token string">&#x27;weak&#x27;</span> <span class="token operator">|</span> <span class="token string">&#x27;lazy&#x27;</span> <span class="token operator">|</span> <span class="token string">&#x27;lazy-once&#x27;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> webpack<span class="token punctuation">.</span>Context<span class="token punctuation">;</span></code></pre></li><li><p>可用版本：5.70.0+</p></li><li><p>示例：</p><pre><code class="hljs language-js"><span class="token keyword">const</span> contextRequire <span class="token operator">=</span> <span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span><span class="token function">webpackContext</span><span class="token punctuation">(</span><span class="token string">&#x27;.&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  recursive<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  regExp<span class="token operator">:</span> <span class="token regex">/two/</span><span class="token punctuation">,</span>
  mode<span class="token operator">:</span> <span class="token string">&#x27;weak&#x27;</span><span class="token punctuation">,</span>
  exclude<span class="token operator">:</span> <span class="token regex">/three/</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></li></ul><h2><span id="__filename-NodeJS"></span>__filename (NodeJS)<a href="#__filename-NodeJS" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>取决于 <code>node.__filename</code> 配置选项：</p><ul><li><code>false</code>: 未定义</li><li><code>mock</code>: 等同于 <code>&#x27;/index.js&#x27;</code></li><li><code>true</code>: <a href="https://nodejs.org/api/globals.html#globals_filename">node.js __filename</a></li></ul><p>如果在一个被 Parser 解析的表达式内部使用，则配置选项会被当作 <code>true</code> 处理。</p><h2><span id="__resourcequery-webpack-specific"></span>__resourceQuery (webpack-specific)<a href="#__resourcequery-webpack-specific" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>当前模块的资源查询(resource query) 。如果进行了如下的 <code>reqiure</code> 调用，那么查询字符串(query string)在<code>file.js</code> 中可访问。</p><pre><code class="hljs language-javascript"><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;file.js?test&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><strong>file.js</strong></p><pre><code class="hljs language-javascript">__resourceQuery <span class="token operator">===</span> <span class="token string">&#x27;?test&#x27;</span><span class="token punctuation">;</span></code></pre><h2><span id="__webpack_public_path__-webpack-specific"></span>__webpack_public_path__ (webpack-specific)<a href="#__webpack_public_path__-webpack-specific" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>等同于 <code>output.publicPath</code> 配置选项。</p><h2><span id="__webpack_require__-webpack-specific"></span>__webpack_require__ (webpack-specific)<a href="#__webpack_require__-webpack-specific" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>原始 require 函数。这个表达式不会被解析器解析为依赖。</p><h2><span id="__webpack_chunk_load__-webpack-specific"></span><code>__webpack_chunk_load__</code> (webpack-specific)<a href="#__webpack_chunk_load__-webpack-specific" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>内部 chunk 载入函数，有一个输入参数：</p><ul><li><code>chunkId</code> 需要载入的 chunk id。</li></ul><p>当一个 chunk 加载失败时，从备用公共路径加载 chunk 的示例：</p><pre><code class="hljs language-js"><span class="token keyword">const</span> originalLoad <span class="token operator">=</span> __webpack_chunk_load__<span class="token punctuation">;</span>
<span class="token keyword">const</span> publicPaths <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#x27;a&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;b&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;c&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function-variable function">__webpack_chunk_load__</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> error<span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> path <span class="token keyword">of</span> publicPaths<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    __webpack_public_path__ <span class="token operator">=</span> path<span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">await</span> <span class="token function">originalLoad</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      error <span class="token operator">=</span> e<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">throw</span> error<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&#x27;./module-a&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">moduleA</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// now webpack will use the custom __webpack_chunk_load__ to load chunk</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h2><span id="__webpack_module__-webpack-specific"></span>__webpack_module__ (webpack-specific)<a href="#__webpack_module__-webpack-specific" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><span class="badge">5.68.0+</span><p>它提供对当前 <code>module</code> 的访问。<code>module</code> 在 ESM 严格模式下不可用。</p><h2><span id="__webpack_module__id-webpack-specific"></span>__webpack_module__.id (webpack-specific)<a href="#__webpack_module__id-webpack-specific" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><span class="badge">5.68.0+</span><p>它提供对当前 <code>module</code>(<code>module.id</code>) ID 的访问。<code>module</code> 在 ESM 严格模式下不可用。</p><h2><span id="__webpack_modules__-webpack-specific"></span>__webpack_modules__ (webpack-specific)<a href="#__webpack_modules__-webpack-specific" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>访问所有模块的内部对象。</p><h2><span id="__webpack_hash__-webpack-specific"></span>__webpack_hash__ (webpack-specific)<a href="#__webpack_hash__-webpack-specific" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>这个变量提供对编译过程中(compilation)的 hash 信息的访问。</p><h2><span id="__webpack_get_script_filename__-webpack-specific"></span>__webpack_get_script_filename__ (webpack-specific)<a href="#__webpack_get_script_filename__-webpack-specific" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p><code>function (chunkId)</code></p><p>它通过 chunk 的 id 提供 chunk 的文件名。</p><p>它是可分配的，允许更改运行时使用的文件名。例如，它可以用来确定加载 chunk 时的最终路径。</p><pre><code class="hljs language-js"><span class="token keyword">const</span> oldFn <span class="token operator">=</span> __webpack_get_script_filename__<span class="token punctuation">;</span>

<span class="token function-variable function">__webpack_get_script_filename__</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">chunkId</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> filename <span class="token operator">=</span> <span class="token function">oldFn</span><span class="token punctuation">(</span>chunkId<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> filename <span class="token operator">+</span> <span class="token string">&#x27;.changed&#x27;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><h2><span id="__non_webpack_require__-webpack-specific"></span>__non_webpack_require__ (webpack-specific)<a href="#__non_webpack_require__-webpack-specific" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>生成一个不会被 webpack 解析的 <code>require</code> 函数。配合全局可以获取到的 require 函数，可以完成一些酷炫操作。</p><h2><span id="__webpack_exports_info__-webpack-specific"></span>__webpack_exports_info__ (webpack-specific)<a href="#__webpack_exports_info__-webpack-specific" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>在模块中, <code>__webpack_exports_info__</code> 可以被获取到，以便导出模块用以自我检查：</p><ul><li><p><code>__webpack_exports_info__</code> 总是 <code>true</code></p></li><li><p>当导出模块未被使用时 <code>__webpack_exports_info__.&lt;exportName&gt;.used</code> 为 <code>false</code>, 否则是 <code>true</code></p></li><li><p><code>__webpack_exports_info__.&lt;exportName&gt;.useInfo</code> 是</p><ul><li><code>false</code> 当导出模块未被使用</li><li><code>true</code> 当导出模块被使用</li><li><code>null</code> 当导出模块的使用情况取决于运行时的条件</li><li><code>undefined</code> 当没有可用信息时</li></ul></li><li><p><code>__webpack_exports_info__.&lt;exportName&gt;.provideInfo</code> 是</p><ul><li><code>false</code> 当导出模块没有被提供</li><li><code>true</code> 当导出模块被提供</li><li><code>null</code> 当导出模块的提供情况取决于运行时的条件</li><li><code>undefined</code> 当没有可用信息时</li></ul></li><li><p>可以从嵌套的 exports 中得到相关信息: 例如 <code>__webpack_exports_info__.&lt;exportName&gt;.&lt;exportName&gt;.&lt;exportName&gt;.used</code></p></li><li><p>Check whether exports can be mangled with <code>__webpack_exports_info__.&lt;name&gt;.canMangle</code></p></li></ul><h2><span id="__webpack_is_included__-webpack-specific"></span>__webpack_is_included__ (webpack-specific)<a href="#__webpack_is_included__-webpack-specific" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><span class="badge">5.16.0+</span><p>测试给定的模块是否被 webpack 打包。</p><pre><code class="hljs language-js"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">__webpack_is_included__</span><span class="token punctuation">(</span><span class="token string">&#x27;./module-a.js&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// do something</span>
<span class="token punctuation">}</span></code></pre><h2><span id="__webpack_base_uri__-webpack-specific"></span>__webpack_base_uri__ (webpack-specific)<a href="#__webpack_base_uri__-webpack-specific" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>运行时修改 base 的 URI。</p><ul><li><p>类型：<code>string</code></p></li><li><p>可用：5.21.0+</p></li><li><p>示例:</p><pre><code class="hljs language-js">__webpack_base_uri__ <span class="token operator">=</span> <span class="token string">&#x27;https://example.com&#x27;</span><span class="token punctuation">;</span></code></pre></li></ul><h2><span id="__webpack_runtime_id__"></span>__webpack_runtime_id__<a href="#__webpack_runtime_id__" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>访问当前入口的 <a href="/blog/2020-10-10-webpack-5-release/#entry-point-runtime">runtime</a> id。</p><p>这是一个 webpack 特性，并且在 webpack 5.25.0 后可用。</p><p><strong>src/index.js</strong></p><pre><code class="hljs language-js">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>__webpack_runtime_id__ <span class="token operator">===</span> <span class="token string">&#x27;main&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h2><span id="DEBUG-webpack-specific"></span>DEBUG (webpack-specific)<a href="#DEBUG-webpack-specific" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>等同于 <code>debug</code> 配置选项。</p><h1><span id="compiler-钩子"></span>compiler 钩子<a href="#compiler-%E9%92%A9%E5%AD%90" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1>
<p><code>Compiler</code> 模块是 webpack 的主要引擎，它通过 <a href="/api/cli">CLI</a> 或者 <a href="/api/node">Node API</a>
传递的所有选项创建出一个 compilation 实例。
它扩展（extends）自 <code>Tapable</code> 类，用来注册和调用插件。
大多数面向用户的插件会首先在 <code>Compiler</code> 上注册。</p><p>在为 webpack 开发插件时，你可能需要知道每个钩子函数是在哪里调用的。想要了解这些内容，请在 webpack 源码中搜索 <code>hooks.&lt;hook name&gt;.call</code>。</p><h2><span id="watching"></span>监听(watching)<a href="#watching" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p><code>Compiler</code> 支持可以监控文件系统的 <a href="/api/node/#watching">监听(watching)</a> 机制，并且在文件修改时重新编译。
当处于监听模式(watch mode)时，
compiler 会触发诸如 <code>watchRun</code>, <code>watchClose</code> 和 <code>invalid</code> 等额外的事件。
通常在 <a href="/guides/development">开发环境</a> 中使用，
也常常会在 <code>webpack-dev-server</code> 这些工具的底层调用，
由此开发人员无须每次都使用手动方式重新编译。
还可以通过 <a href="/api/cli/#watch-options">CLI</a> 进入监听模式。</p><h2><span id="hooks"></span>钩子<a href="#hooks" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>以下生命周期钩子函数，是由 <code>compiler</code> 暴露，
可以通过如下方式访问：</p><pre><code class="hljs language-js">compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>someHook<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">&#x27;MyPlugin&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">params</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">/* ... */</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>取决于不同的钩子类型，也可以在某些钩子上访问 <code>tapAsync</code> 和 <code>tapPromise</code>。</p><p>关于钩子类型的描述，请查看 <a href="https://github.com/webpack/tapable#tapable">Tapable 文档</a>.</p><h3><span id="environment"></span>environment<a href="#environment" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p>在编译器准备环境时调用，时机就在配置文件中初始化插件之后。</p><h3><span id="afterEnvironment-afterEnvironment"></span>afterEnvironment $#afterEnvironment$<a href="#afterEnvironment-afterEnvironment" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p>当编译器环境设置完成后，在 <code>environment</code> hook 后直接调用。</p><h3><span id="entryoption"></span>entryOption<a href="#entryoption" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncBailHook</code></p><p>在 webpack 选项中的 <a href="/configuration/entry-context/#entry"><code>entry</code></a> 被处理过之后调用。</p><ul><li>回调参数：<a href="/configuration/entry-context/#context"><code>context</code></a>, <a href="/configuration/entry-context/#entry"><code>entry</code></a></li></ul><pre><code class="hljs language-js">compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>entryOption<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">&#x27;MyPlugin&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> entry</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">/* ... */</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3><span id="afterplugins"></span>afterPlugins<a href="#afterplugins" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p>在初始化内部插件集合完成设置之后调用。</p><ul><li>回调参数：<code>compiler</code></li></ul><h3><span id="afterresolvers"></span>afterResolvers<a href="#afterresolvers" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p>resolver 设置完成之后触发。</p><ul><li>回调参数：<code>compiler</code></li></ul><h3><span id="initialize"></span>initialize<a href="#initialize" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p>当编译器对象被初始化时调用。</p><h3><span id="beforerun"></span>beforeRun<a href="#beforerun" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>AsyncSeriesHook</code></p><p>在开始执行一次构建之前调用，compiler.run 方法开始执行后立刻进行调用。</p><ul><li>回调参数：<code>compiler</code></li></ul><h3><span id="run"></span>run<a href="#run" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>AsyncSeriesHook</code></p><p>在开始读取 <a href="/configuration/other-options/#recordspath"><code>records</code></a> 之前调用。</p><ul><li>回调参数：<code>compiler</code></li></ul><h3><span id="watchrun"></span>watchRun<a href="#watchrun" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>AsyncSeriesHook</code></p><p>在监听模式下，一个新的 compilation 触发之后，但在 compilation 实际开始之前执行。</p><ul><li>回调参数：<code>compiler</code></li></ul><h3><span id="normalmodulefactory"></span>normalModuleFactory<a href="#normalmodulefactory" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p><a href="/api/normalmodulefactory-hooks">NormalModuleFactory</a> 创建之后调用。</p><ul><li>回调参数：<code>normalModuleFactory</code></li></ul><h3><span id="contextmodulefactory"></span>contextModuleFactory<a href="#contextmodulefactory" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p><a href="/api/contextmodulefactory-hooks">ContextModuleFactory</a> 创建之后调用。</p><ul><li>回调参数：<code>contextModuleFactory</code></li></ul><h3><span id="beforecompile"></span>beforeCompile<a href="#beforecompile" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>AsyncSeriesHook</code></p><p>在创建 compilation parameter 之后执行。</p><ul><li>回调参数：<code>compilationParams</code></li></ul><p>初始化 <code>compilationParams</code> 变量的示例如下：</p><pre><code class="hljs language-js">compilationParams <span class="token operator">=</span> <span class="token punctuation">{</span>
  normalModuleFactory<span class="token punctuation">,</span>
  contextModuleFactory<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>此钩子可用于添加/修改 compilation parameter：</p><pre><code class="hljs language-js">compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>beforeCompile<span class="token punctuation">.</span><span class="token function">tapAsync</span><span class="token punctuation">(</span><span class="token string">&#x27;MyPlugin&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">params<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  params<span class="token punctuation">[</span><span class="token string">&#x27;MyPlugin - data&#x27;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&#x27;important stuff my plugin will use later&#x27;</span><span class="token punctuation">;</span>
  <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3><span id="compile"></span>compile<a href="#compile" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p><code>beforeCompile</code> 之后立即调用，但在一个新的 compilation 创建之前。这个钩子 <em>不会</em> 被复制到子编译器。</p><ul><li>回调参数：<code>compilationParams</code></li></ul><h3><span id="thiscompilation"></span>thisCompilation<a href="#thiscompilation" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p>初始化 compilation 时调用，在触发 <code>compilation</code> 事件之前调用。这个钩子 <em>不会</em> 被复制到子编译器。</p><ul><li>回调参数：<code>compilation</code>, <code>compilationParams</code></li></ul><h3><span id="compilation"></span>compilation<a href="#compilation" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p>compilation 创建之后执行。</p><ul><li>回调参数：<code>compilation</code>, <code>compilationParams</code></li></ul><h3><span id="make"></span>make<a href="#make" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>AsyncParallelHook</code></p><p>compilation 结束之前执行。这个钩子 <em>不会</em> 被复制到子编译器。</p><ul><li>回调参数：<code>compilation</code></li></ul><h3><span id="aftercompile"></span>afterCompile<a href="#aftercompile" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>AsyncSeriesHook</code></p><p>compilation 结束和封印之后执行。</p><ul><li>回调参数：<code>compilation</code></li></ul><h3><span id="shouldemit"></span>shouldEmit<a href="#shouldemit" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncBailHook</code></p><p>在输出 asset 之前调用。返回一个布尔值，告知是否输出。</p><ul><li>回调参数：<code>compilation</code></li></ul><pre><code class="hljs language-js">compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>shouldEmit<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">&#x27;MyPlugin&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">compilation</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 返回 true 以输出 output 结果，否则返回 false</span>
  <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3><span id="emit"></span>emit<a href="#emit" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>AsyncSeriesHook</code></p><p>输出 asset 到 output 目录之前执行。这个钩子 <em>不会</em> 被复制到子编译器。</p><ul><li>回调参数：<code>compilation</code></li></ul><h3><span id="afteremit"></span>afterEmit<a href="#afteremit" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>AsyncSeriesHook</code></p><p>输出 asset 到 output 目录之后执行。这个钩子 <em>不会</em> 被复制到子编译器。</p><ul><li>回调参数：<code>compilation</code></li></ul><h3><span id="assetemitted"></span>assetEmitted<a href="#assetemitted" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>AsyncSeriesHook</code></p><p>在 asset 被输出时执行。此钩子可以访问被输出的 asset 的相关信息，例如它的输出路径和字节内容。</p><ul><li>回调参数：<code>file</code>, <code>info</code></li></ul><p>例如，可以通过 <code>info.content</code> 访问 asset 的内容 buffer：</p><pre><code class="hljs language-js">compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>assetEmitted<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span>
  <span class="token string">&#x27;MyPlugin&#x27;</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token parameter">file<span class="token punctuation">,</span> <span class="token punctuation">{</span> content<span class="token punctuation">,</span> source<span class="token punctuation">,</span> outputPath<span class="token punctuation">,</span> compilation<span class="token punctuation">,</span> targetPath <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &lt;Buffer 66 6f 6f 62 61 72&gt;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3><span id="done"></span>done<a href="#done" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>AsyncSeriesHook</code></p><p>在 compilation 完成时执行。这个钩子 <em>不会</em> 被复制到子编译器。</p><ul><li>回调参数：<code>stats</code></li></ul><h3><span id="additionalPass"></span>additionalPass<a href="#additionalPass" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>AsyncSeriesHook</code></p><p>This hook allows you to do a one more additional pass of the build.</p><h3><span id="failed"></span>failed<a href="#failed" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p>在 compilation 失败时调用。</p><ul><li>回调参数：<code>error</code></li></ul><h3><span id="invalid"></span>invalid<a href="#invalid" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p>在一个观察中的 compilation 无效时执行。这个钩子 <em>不会</em> 被复制到子编译器。</p><ul><li>回调参数：<code>fileName</code>, <code>changeTime</code></li></ul><h3><span id="watchclose"></span>watchClose<a href="#watchclose" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p>在一个观察中的 compilation 停止时执行。</p><h3><span id="shutdown"></span>shutdown<a href="#shutdown" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>AsyncSeriesHook</code></p><p>当编译器关闭时调用。</p><h3><span id="infrastructureLog"></span>infrastructureLog<a href="#infrastructureLog" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncBailHook</code></p><p>在配置中启用 <a href="/configuration/other-options/#infrastructurelogging"><code>infrastructureLogging</code> 选项</a> 后，允许使用 infrastructure log(基础日志)。</p><ul><li>回调参数：<code>name</code>, <code>type</code>, <code>args</code></li></ul><h3><span id="log"></span>log<a href="#log" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncBailHook</code></p><p>启用后允许记录到 <a href="/configuration/stats/">stats</a> 对象，请参阅 <a href="/configuration/stats/#stats-options"><code>stats.logging</code>, <code>stats.loggingDebug</code> 和 <code>stats.loggingTrace</code> 选项</a>。</p><ul><li>回调参数：<code>origin</code>, <code>logEntry</code></li></ul><h1><span id="compilation-钩子"></span>compilation 钩子<a href="#compilation-%E9%92%A9%E5%AD%90" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1>
<p><code>Compilation</code> 模块会被 <code>Compiler</code> 用来创建新的 compilation 对象（或新的 build 对象）。
<code>compilation</code> 实例能够访问所有的模块和它们的依赖（大部分是循环依赖）。
它会对应用程序的依赖图中所有模块，
进行字面上的编译(literal compilation)。
在编译阶段，模块会被加载(load)、封存(seal)、优化(optimize)、
分块(chunk)、哈希(hash)和重新创建(restore)。</p><p><code>Compilation</code> 类扩展(extend)自 <code>Tapable</code>，并提供了以下生命周期钩子。
可以按照 compiler 钩子的相同方式来调用 tap：</p><pre><code class="hljs language-js">compilation<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>someHook<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token comment">/* ... */</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>和 <code>compiler</code> 用法相同，取决于不同的钩子类型，
所以也可以在某些钩子上访问 <code>tapAsync</code> 和 <code>tapPromise</code>。</p><h3><span id="buildmodule"></span>buildModule<a href="#buildmodule" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p>在模块构建开始之前触发，可以用来修改模块。</p><ul><li>回调参数：<code>module</code></li></ul><pre><code class="hljs language-js">compilation<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>buildModule<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span>
  <span class="token string">&#x27;SourceMapDevToolModuleOptionsPlugin&#x27;</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token parameter">module</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    module<span class="token punctuation">.</span>useSourceMap <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3><span id="rebuildmodule"></span>rebuildModule<a href="#rebuildmodule" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p>在重新构建一个模块之前触发。</p><ul><li>回调参数：<code>module</code></li></ul><h3><span id="failedmodule"></span>failedModule<a href="#failedmodule" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p>模块构建失败时执行。</p><ul><li>回调参数：<code>module</code> <code>error</code></li></ul><h3><span id="succeedmodule"></span>succeedModule<a href="#succeedmodule" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p>模块构建成功时执行。</p><ul><li>回调参数：<code>module</code></li></ul><h3><span id="finishmodules"></span>finishModules<a href="#finishmodules" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>AsyncSeriesHook</code></p><p>所有模块都完成构建并且没有错误时执行。</p><ul><li>回调参数：<code>modules</code></li></ul><h3><span id="finishrebuildingmodule"></span>finishRebuildingModule<a href="#finishrebuildingmodule" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p>一个模块完成重新构建时执行，在都成功或有错误的情况下。</p><ul><li>回调参数：<code>module</code></li></ul><h3><span id="seal"></span>seal<a href="#seal" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p>compilation 对象停止接收新的模块时触发。</p><h3><span id="unseal"></span>unseal<a href="#unseal" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p>compilation 对象开始接收新模块时触发。</p><h3><span id="optimizedependencies"></span>optimizeDependencies<a href="#optimizedependencies" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncBailHook</code></p><p>依赖优化开始时触发。</p><ul><li>回调参数：<code>modules</code></li></ul><h3><span id="afteroptimizedependencies"></span>afterOptimizeDependencies<a href="#afteroptimizedependencies" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p>依赖优化之后触发。</p><ul><li>回调参数：<code>modules</code></li></ul><h3><span id="optimize"></span>optimize<a href="#optimize" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p>优化阶段开始时触发。</p><h3><span id="optimizemodules"></span>optimizeModules<a href="#optimizemodules" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncBailHook</code></p><p>在模块优化阶段开始时调用。插件可以 tap 此钩子对模块进行优化。</p><ul><li>回调参数：<code>modules</code></li></ul><h3><span id="afteroptimizemodules"></span>afterOptimizeModules<a href="#afteroptimizemodules" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p>在模块优化完成之后调用。</p><ul><li>回调参数：<code>modules</code></li></ul><h3><span id="optimizechunks"></span>optimizeChunks<a href="#optimizechunks" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncBailHook</code></p><p>在 chunk 优化阶段开始时调用。插件可以 tap 此钩子对 chunk 执行优化。</p><ul><li>回调参数：<code>chunks</code></li></ul><h3><span id="afteroptimizechunks"></span>afterOptimizeChunks<a href="#afteroptimizechunks" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p>chunk 优化完成之后触发。</p><ul><li>回调参数：<code>chunks</code></li></ul><h3><span id="optimizetree"></span>optimizeTree<a href="#optimizetree" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>AsyncSeriesHook</code></p><p>在优化依赖树之前调用。插件可以 tap 此钩子执行依赖树优化。</p><ul><li>回调参数：<code>chunks</code> <code>modules</code></li></ul><h3><span id="afteroptimizetree"></span>afterOptimizeTree<a href="#afteroptimizetree" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p>在依赖树优化成功完成之后调用。</p><ul><li>回调参数：<code>chunks</code> <code>modules</code></li></ul><h3><span id="optimizechunkmodules"></span>optimizeChunkModules<a href="#optimizechunkmodules" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncBailHook</code></p><p>在树优化之后，chunk 模块优化开始时调用。插件可以 tap 此钩子来执行 chunk 模块的优化。</p><ul><li>回调参数：<code>chunks</code> <code>modules</code></li></ul><h3><span id="afteroptimizechunkmodules"></span>afterOptimizeChunkModules<a href="#afteroptimizechunkmodules" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p>在 chunk 模块优化成功完成之后调用。</p><ul><li>回调参数：<code>chunks</code> <code>modules</code></li></ul><h3><span id="shouldrecord"></span>shouldRecord<a href="#shouldrecord" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncBailHook</code></p><p>调用来决定是否存储 record。返回任何内容 <code>!== false</code> 将阻止执行所有其他 &quot;record&quot; 钩子（<a href="#record"><code>record</code></a>, <a href="#recordmodules"><code>recordModules</code></a>, <a href="#recordchunks"><code>recordChunks</code></a> 和 <a href="#recordhash"><code>recordHash</code></a>）。</p><h3><span id="revivemodules"></span>reviveModules<a href="#revivemodules" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p>从 record 中恢复模块信息。</p><ul><li>回调参数：<code>modules</code> <code>records</code></li></ul><h3><span id="beforemoduleids"></span>beforeModuleIds<a href="#beforemoduleids" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p>在为每个模块分配 <code>id</code> 之前执行。</p><ul><li>回调参数：<code>modules</code></li></ul><h3><span id="moduleids"></span>moduleIds<a href="#moduleids" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p>调用来每个模块分配一个 <code>id</code>。</p><ul><li>回调参数：<code>modules</code></li></ul><h3><span id="optimizemoduleids"></span>optimizeModuleIds<a href="#optimizemoduleids" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p>在模块 <code>id</code> 优化开始时调用。</p><ul><li>回调参数：<code>modules</code></li></ul><h3><span id="afteroptimizemoduleids"></span>afterOptimizeModuleIds<a href="#afteroptimizemoduleids" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p>在模块 <code>id</code> 优化完成时调用。</p><ul><li>回调参数：<code>modules</code></li></ul><h3><span id="revivechunks"></span>reviveChunks<a href="#revivechunks" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p>从 record 中恢复 chunk 信息。</p><ul><li>回调参数：<code>chunks</code> <code>records</code></li></ul><h3><span id="beforechunkids"></span>beforeChunkIds<a href="#beforechunkids" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p>在为每个 chunk 分配 <code>id</code> 之前执行。</p><ul><li>回调参数：<code>chunks</code></li></ul><h3><span id="chunkids"></span>chunkIds<a href="#chunkids" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p>调用时，会为每个 chunk 分配一个 <code>id</code>。</p><ul><li>回调函数的参数为：<code>chunks</code></li></ul><h3><span id="optimizechunkids"></span>optimizeChunkIds<a href="#optimizechunkids" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p>在 chunk <code>id</code> 优化阶段开始时调用。</p><ul><li>回调参数：<code>chunks</code></li></ul><h3><span id="afteroptimizechunkids"></span>afterOptimizeChunkIds<a href="#afteroptimizechunkids" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p>chunk <code>id</code> 优化结束之后触发。</p><ul><li>回调参数：<code>chunks</code></li></ul><h3><span id="recordmodules"></span>recordModules<a href="#recordmodules" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p>将模块信息存储到 record 中。<a href="#shouldrecord"><code>shouldRecord</code></a> 返回 truthy 值时触发。</p><ul><li>回调参数：<code>modules</code> <code>records</code></li></ul><h3><span id="recordchunks"></span>recordChunks<a href="#recordchunks" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p>将 chunk 存储到 record 中。<a href="#shouldrecord"><code>shouldRecord</code></a> 返回 truthy 值时触发。</p><ul><li>回调参数：<code>chunks</code> <code>records</code></li></ul><h3><span id="beforemodulehash"></span>beforeModuleHash<a href="#beforemodulehash" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p>在创建模块哈希（hash）之前。</p><h3><span id="aftermodulehash"></span>afterModuleHash<a href="#aftermodulehash" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>syncHook</code></p><p>在创建模块哈希（hash）之后。</p><h3><span id="beforehash"></span>beforeHash<a href="#beforehash" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p>在 compilation 添加哈希（hash）之前。</p><h3><span id="afterhash"></span>afterHash<a href="#afterhash" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p>在 compilation 添加哈希（hash）之后。</p><h3><span id="recordhash"></span>recordHash<a href="#recordhash" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p>将有关 record 的信息存储到 <code>records</code> 中。仅在 <a href="#shouldrecord"><code>shouldRecord</code></a> 返回 truthy 值时触发。</p><ul><li>回调参数：<code>records</code></li></ul><h3><span id="record"></span>record<a href="#record" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p>将 <code>compilation</code> 相关信息存储到 <code>record</code> 中。仅在 <a href="#shouldrecord"><code>shouldRecord</code></a> 返回 truthy 值时触发。</p><ul><li>回调参数：<code>compilation</code> <code>records</code></li></ul><h3><span id="beforemoduleassets"></span>beforeModuleAssets<a href="#beforemoduleassets" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p>在创建模块 asset 之前执行。</p><h3><span id="additionalchunkassets"></span>additionalChunkAssets<a href="#additionalchunkassets" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><aside class="warning"><h6 class="warning__prefix">警告</h6><p><code>additionalChunkAssets</code> 已弃用（可使用 <a href="#processassets">Compilation.hook.processAssets</a> 来代替，并且可使用 ompilation.PROCESS_ASSETS_STAGE_* 作为其选项参数。）</p></aside><p>为这些 chunk 创建其他 asset。</p><ul><li>回调参数：<code>chunks</code></li></ul><h3><span id="shouldgeneratechunkassets"></span>shouldGenerateChunkAssets<a href="#shouldgeneratechunkassets" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncBailHook</code></p><p>调用以确定是否生成 chunk asset。返回任何 <code>!== false</code> 将允许生成 chunk asset。</p><h3><span id="beforechunkassets"></span>beforeChunkAssets<a href="#beforechunkassets" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p>在创建 chunk asset 之前。</p><h3><span id="additionalassets"></span>additionalAssets<a href="#additionalassets" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>AsyncSeriesHook</code></p><p>为 compilation 创建额外 asset。
这个钩子可以用来下载图像，例如：</p><pre><code class="hljs language-js">compilation<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>additionalAssets<span class="token punctuation">.</span><span class="token function">tapAsync</span><span class="token punctuation">(</span><span class="token string">&#x27;MyPlugin&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">download</span><span class="token punctuation">(</span><span class="token string">&#x27;https://img.shields.io/npm/v/webpack.svg&#x27;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">resp</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>resp<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      compilation<span class="token punctuation">.</span>assets<span class="token punctuation">[</span><span class="token string">&#x27;webpack-version.svg&#x27;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">toAsset</span><span class="token punctuation">(</span>resp<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token function">callback</span><span class="token punctuation">(</span>
        <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&#x27;[webpack-example-plugin] Unable to download the image&#x27;</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3><span id="optimizechunkassets"></span>optimizeChunkAssets<a href="#optimizechunkassets" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>AsyncSeriesHook</code></p><aside class="warning"><h6 class="warning__prefix">警告</h6><p><code>optimizeChunkAssets</code> 已弃用。（可使用 <a href="#processassets">Compilation.hook.processAssets</a> 来代替，并且可使用 Compilation.PROCESS_ASSETS_STAGE_* 作为其选项参数。</p></aside><p>优化所有 chunk asset。asset 存储在 <code>compilation.assets</code> 中。
每个 <code>Chunk</code> 都具有一个 <code>files</code> 属性，其指向由一个 chunk 创建的所有文件。
任何额外 chunk asset 都存储在 <code>compilation.additionalChunkAssets</code> 中。</p><ul><li>回调参数：<code>chunks</code></li></ul><p>Here&#x27;s an example that adds a banner to each chunk.</p><pre><code class="hljs language-js">compilation<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>optimizeChunkAssets<span class="token punctuation">.</span><span class="token function">tapAsync</span><span class="token punctuation">(</span>
  <span class="token string">&#x27;MyPlugin&#x27;</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token parameter">chunks<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    chunks<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">chunk</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      chunk<span class="token punctuation">.</span>files<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">file</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        compilation<span class="token punctuation">.</span>assets<span class="token punctuation">[</span>file<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConcatSource</span><span class="token punctuation">(</span>
          <span class="token string">&#x27;/**Sweet Banner**/&#x27;</span><span class="token punctuation">,</span>
          <span class="token string">&#x27;\n&#x27;</span><span class="token punctuation">,</span>
          compilation<span class="token punctuation">.</span>assets<span class="token punctuation">[</span>file<span class="token punctuation">]</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3><span id="afteroptimizechunkassets"></span>afterOptimizeChunkAssets<a href="#afteroptimizechunkassets" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><aside class="warning"><h6 class="warning__prefix">警告</h6><p><code>afterOptimizeChunkAssets</code> 已弃用。（可使用 <a href="#processassets">Compilation.hook.processAssets</a> 来代替，并且可使用 Compilation.PROCESS_ASSETS_STAGE_* 作为其选项参数。</p></aside><p>chunk asset 已经被优化。</p><ul><li>回调参数：<code>chunks</code></li></ul><p>这里是一个来自 <a href="https://github.com/boopathi">@boopathi</a> 的示例插件，详细地输出每个 chunk 里有什么。</p><pre><code class="hljs language-js">compilation<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>afterOptimizeChunkAssets<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">&#x27;MyPlugin&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">chunks</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  chunks<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">chunk</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      id<span class="token operator">:</span> chunk<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
      name<span class="token operator">:</span> chunk<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
      includes<span class="token operator">:</span> chunk<span class="token punctuation">.</span><span class="token function">getModules</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">module</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> module<span class="token punctuation">.</span>request<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3><span id="optimizeassets"></span>optimizeAssets<a href="#optimizeassets" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>AsyncSeriesHook</code></p><p>优化存储在 <code>compilation.assets</code> 中的所有 asset。</p><ul><li>回调参数：<code>assets</code></li></ul><h3><span id="afteroptimizeassets"></span>afterOptimizeAssets<a href="#afteroptimizeassets" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p>asset 已经优化。</p><ul><li>回调参数：<code>assets</code></li></ul><h3><span id="processassets"></span>processAssets<a href="#processassets" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>AsyncSeriesHook</code></p><p>asset 处理.</p><p><strong>Hook 参数：</strong></p><ul><li><code>name: string</code> — 插件名称</li><li><code>stage: Stage</code> — a stage to tap into (see the <a href="#list-of-asset-processing-stages">list of supported stages</a> below)</li><li><code>additionalAssets?: true | (assets, [callback]) =&gt; (void | Promise&lt;void&gt;)</code> — a callback for additional assets (<a href="#additional-assets">see below</a>)</li></ul><p><strong>回调参数：</strong></p><ul><li><code>assets: { [pathname: string]: Source }</code> — 普通对象，其中 key 是 asset 的路径名，value 是 asset 的数据，具体的代表请参考 <a href="https://github.com/webpack/webpack-sources#source"><code>Source</code></a>。</li></ul><p><strong>示例：</strong></p><pre><code class="hljs language-js">compilation<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>processAssets<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span>
  <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">&#x27;MyPlugin&#x27;</span><span class="token punctuation">,</span>
    stage<span class="token operator">:</span> Compilation<span class="token punctuation">.</span><span class="token constant">PROCESS_ASSETS_STAGE_ADDITIONS</span><span class="token punctuation">,</span> <span class="token comment">// see below for more stages</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token parameter">assets</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#x27;List of assets and their sizes:&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Object<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span>assets<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">[</span>pathname<span class="token punctuation">,</span> source<span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">— </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>pathname<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>source<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> bytes</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h4><span id="additional-assets"></span>额外的 assets<a href="#additional-assets" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4><p>除了 <code>name</code> 和 <code>stage</code> 以外，你还可以传递 <code>additionalAssets</code> <span class="badge">5.8.0+</span> 选项，此选项可接受 <code>true</code> 或者一个带有 <code>assets</code> 的函数作为参数：</p><ol><li><p><code>true</code> - 针对插件后续添加的 asset 执行回调。</p><p>在此模式下，回调将被多次调用：一次是在指定阶段之前添加资产时，另一次是后来由插件添加资产时。（在本阶段或下一阶段）。</p><pre><code class="hljs language-js">compilation<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>processAssets<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span>
  <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">&#x27;MyPlugin&#x27;</span><span class="token punctuation">,</span>
    stage<span class="token operator">:</span> Compilation<span class="token punctuation">.</span><span class="token constant">PROCESS_ASSETS_STAGE_DEV_TOOLING</span><span class="token punctuation">,</span>
    additionalAssets<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token parameter">assets</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// this function will be called multiple times with each bulk of assets</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></li><li><p><code>(assets, [callback]) =&gt; (void | Promise&lt;void&gt;)</code> - 针对插件后续添加的 asset 执行指定的回调（在本阶段或下一阶段）。回调必须遵循所使用的 tap 函数的类型（例如，当与 <code>tapPromise()</code> 一同使用时，它应该返回一个 Promise）。</p><pre><code class="hljs language-js">compilation<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>processAssets<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span>
  <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">&#x27;MyPlugin&#x27;</span><span class="token punctuation">,</span>
    stage<span class="token operator">:</span> Compilation<span class="token punctuation">.</span><span class="token constant">PROCESS_ASSETS_STAGE_DEV_TOOLING</span><span class="token punctuation">,</span>
    <span class="token function-variable function">additionalAssets</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">assets</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// this function potentially could be called multiple times for assets added on later stages</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token parameter">assets</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// this function will be called once with assets added by plugins on prior stages</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></li></ol><h4><span id="list-of-asset-processing-stages"></span>资产处理 stage 的列表<a href="#list-of-asset-processing-stages" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4><p>如下是我们可以使用的 stage 清单（按顺序处理）：</p><ul><li><code>PROCESS_ASSETS_STAGE_ADDITIONAL</code> — 在编译中添加额外的 asset。</li><li><code>PROCESS_ASSETS_STAGE_PRE_PROCESS</code> — asset 进行了基础预处理。</li><li><code>PROCESS_ASSETS_STAGE_DERIVED</code> — 从已有 asset 中获取新的 asset。</li><li><code>PROCESS_ASSETS_STAGE_ADDITIONS</code> — 为现有的 asset 添加额外的内容，例如 banner 或初始代码。</li><li><code>PROCESS_ASSETS_STAGE_OPTIMIZE</code> — 以通用的方式优化已有 asset。</li><li><code>PROCESS_ASSETS_STAGE_OPTIMIZE_COUNT</code> — 优化现有资产的数量，例如，进行合并操作。</li><li><code>PROCESS_ASSETS_STAGE_OPTIMIZE_COMPATIBILITY</code> — 优化现有 asset 兼容性，例如添加 polyfills 或者 vendor prefixes。</li><li><code>PROCESS_ASSETS_STAGE_OPTIMIZE_SIZE</code> — 优化现有 asset 大小，例如进行压缩或者删除空格。</li><li><code>PROCESS_ASSETS_STAGE_DEV_TOOLING</code> — 为 asset 添加开发者工具，例如，提取 source map。</li><li><code>PROCESS_ASSETS_STAGE_OPTIMIZE_INLINE</code> <span class="badge">5.8.0+</span> — 优化已有 asset 数量，例如，通过将 asset 内联到其他 asset 中。</li><li><code>PROCESS_ASSETS_STAGE_SUMMARIZE</code> — 整理现有 asset 列表。</li><li><code>PROCESS_ASSETS_STAGE_OPTIMIZE_HASH</code> — 优化 asset 的 hash 值，例如，生成 asset 内容的真实 hash 值。</li><li><code>PROCESS_ASSETS_STAGE_OPTIMIZE_TRANSFER</code> — 优化已有 asset 的转换操作，例如对 asset 进行压缩，并作为独立的 asset。</li><li><code>PROCESS_ASSETS_STAGE_ANALYSE</code> — 分析已有 asset。</li><li><code>PROCESS_ASSETS_STAGE_REPORT</code> — 创建用于上报的 asset。</li></ul><h4><span id="assets-info"></span>Assets info<a href="#assets-info" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4><p>&quot;asset info&quot; 元数据不会自动提供给这个 hook。如果必须使用，你需要通过编译实例以及 asset 路径来手动获取这个元数据。这将在未来的 webpack 版本中得到改善。</p><p><strong>Example:</strong></p><pre><code class="hljs language-js">compilation<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>processAssets<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span>
  <span class="token punctuation">{</span>
    <span class="token comment">/** … */</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token parameter">assets</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    Object<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span>assets<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">[</span>pathname<span class="token punctuation">,</span> source<span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> assetInfo <span class="token operator">=</span> compilation<span class="token punctuation">.</span>assetsInfo<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>pathname<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// @todo: do something with &quot;pathname&quot;, &quot;source&quot; and &quot;assetInfo&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3><span id="afterprocessassets"></span>afterProcessAssets<a href="#afterprocessassets" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p>在 <a href="#processassets"><code>processAssets</code></a> hook 无错误执行后调用。</p><h3><span id="needadditionalseal"></span>needAdditionalSeal<a href="#needadditionalseal" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncBailHook</code></p><p>调用来决定 compilation 是否需要解除 seal 以引入其他文件。</p><h3><span id="afterseal"></span>afterSeal<a href="#afterseal" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>AsyncSeriesHook</code></p><p>在 <code>needAdditionalSeal</code> 之后立即执行。</p><h3><span id="chunkhash"></span>chunkHash<a href="#chunkhash" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p>触发来为每个 chunk 生成 hash。</p><ul><li>回调参数：<code>chunk</code> <code>chunkHash</code></li></ul><h3><span id="moduleasset"></span>moduleAsset<a href="#moduleasset" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p>一个模块中的一个 asset 被添加到 compilation 时调用。</p><ul><li>回调参数：<code>module</code> <code>filename</code></li></ul><h3><span id="chunkasset"></span>chunkAsset<a href="#chunkasset" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p>一个 chunk 中的一个 asset 被添加到 compilation 时调用。</p><ul><li>回调参数：<code>chunk</code> <code>filename</code></li></ul><h3><span id="assetpath"></span>assetPath<a href="#assetpath" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncWaterfallHook</code></p><p>调用以决定 asset 的路径。</p><ul><li>回调参数：<code>path</code> <code>options</code></li></ul><h3><span id="needadditionalpass"></span>needAdditionalPass<a href="#needadditionalpass" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncBailHook</code></p><p>调用以决定 asset 在输出后是否需要进一步处理。</p><h3><span id="childcompiler"></span>childCompiler<a href="#childcompiler" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncHook</code></p><p>子 compiler 设置之后执行。</p><ul><li>回调参数：<code>childCompiler</code> <code>compilerName</code> <code>compilerIndex</code></li></ul><h3><span id="normalmoduleloader"></span>normalModuleLoader<a href="#normalmoduleloader" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p>从 webpack v5 开始，<code>normalModuleLoader</code> 钩子已经删除。现在要访问 loader 请改用 <code>NormalModule.getCompilationHooks(compilation).loader</code>。</p><h1><span id="ContextModuleFactory-Hooks"></span>ContextModuleFactory Hooks<a href="#ContextModuleFactory-Hooks" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1>
<p><code>Compiler</code> 使用 <code>ContextModuleFactory</code> 模块从 webpack 独特的 <a href="/api/module-methods/#requirecontext">require.context</a> API 生成依赖关系。它会解析请求的目录，为每个文件生成请求，并依据传递来的 regExp 进行过滤。最后匹配成功的依赖关系将被传入 <a href="/api/normalmodulefactory-hooks">NormalModuleFactory</a>。</p><p><code>ContextModuleFactory</code> 类扩展了 <code>Tapable</code> 并提供了以下的生命周期钩子。
你可以像使用编译器钩子一样使用它们：</p><pre><code class="hljs language-js">ContextModuleFactory<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>someHook<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token comment">/* ... */</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>与 <code>compiler</code> 一样，<code>tapAsync</code> 和 <code>tapPromise</code> 是否可用
取决于钩子的类型。</p><h3><span id="beforeresolve"></span>beforeResolve<a href="#beforeresolve" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>AsyncSeriesWaterfallHook</code></p><p>在解析请求的目录之前调用。请求可以通过返回 <code>false</code> 来忽略。</p><ul><li>回调参数：<code>data</code></li></ul><h3><span id="afterresolve"></span>afterResolve<a href="#afterresolve" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>AsyncSeriesWaterfallHook</code></p><p>在请求的目录解析后调用。</p><ul><li>回调参数：<code>data</code></li></ul><h3><span id="contextmodulefiles"></span>contextModuleFiles<a href="#contextmodulefiles" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncWaterfallHook</code></p><p>读取目录内容后调用。在递归模式下，也会读取每个子目录。回调参数是一个包含每个目录中所有文件和文件夹名称的数组。</p><ul><li>回调参数：<code>fileNames</code></li></ul><h3><span id="alternativerequests"></span>alternativeRequests<a href="#alternativerequests" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>AsyncSeriesWaterfallHook</code></p><p>在创建请求之后但依据 regExp 进行过滤之前，为每个文件调用。</p><ul><li>回调参数：<code>request</code> <code>options</code></li></ul><h1><span id="JavascriptParser-Hooks"></span>JavascriptParser Hooks<a href="#JavascriptParser-Hooks" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1>
<p><code>parser</code> 实例，在 <code>compiler</code> 中被发现，是用来解析由 webpack
处理过的每个模块。<code>parser</code> 也是扩展自 <code>tapable</code> 的 webpack 类
并且提供多种 <code>tapable</code> 钩子，</p><p>以下示例中，<code>parser</code> 位于 <a href="/api/compiler-hooks/#normalmodulefactory">NormalModuleFactory</a> 中，因此需要调用额外钩子
来进行获取：</p><pre><code class="hljs language-js">compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>normalModuleFactory<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">&#x27;MyPlugin&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">factory</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  factory<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>parser
    <span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">&#x27;javascript/auto&#x27;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">&#x27;MyPlugin&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">parser<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      parser<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>someHook<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token comment">/* ... */</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>和 <code>compiler</code> 用法相同，取决于不同的钩子类型，
也可以在某些钩子上访问 <code>tapAsync</code> 和 <code>tapPromise</code>。</p><h2><span id="hooks"></span>钩子<a href="#hooks" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>以下生命周期钩子函数，是由 <code>parser</code> 暴露，可以通过
如下方式访问：</p><h3><span id="evaluatetypeof"></span>evaluateTypeof<a href="#evaluatetypeof" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncBailHook</code></p><p>Triggered when evaluating an expression consisting in a <code>typeof</code> of a free variable</p><ul><li>Hook Parameters: <code>identifier</code></li><li>Callback Parameters: <code>expression</code></li></ul><pre><code class="hljs language-js">parser<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>evaluateTypeof
  <span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">&#x27;myIdentifier&#x27;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">&#x27;MyPlugin&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">expression</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">/* ... */</span>
    <span class="token keyword">return</span> expressionResult<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>这会触发 <code>evaluateTypeof</code> 钩子的调用：</p><pre><code class="hljs language-js"><span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token keyword">typeof</span> myIdentifier<span class="token punctuation">;</span></code></pre><p>This won&#x27;t trigger:</p><pre><code class="hljs language-js"><span class="token keyword">const</span> myIdentifier <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> b <span class="token operator">=</span> <span class="token keyword">typeof</span> myIdentifier<span class="token punctuation">;</span></code></pre><h3><span id="evaluate"></span>evaluate<a href="#evaluate" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncBailHook</code></p><p>Called when evaluating an expression.</p><ul><li>Hook parameters: <code>expressionType</code></li><li>Callback parameters: <code>expression</code></li></ul><p>For example:</p><p><strong>index.js</strong></p><pre><code class="hljs language-js"><span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><strong>MyPlugin.js</strong></p><pre><code class="hljs language-js">parser<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>evaluate<span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">&#x27;NewExpression&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">&#x27;MyPlugin&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">expression</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">/* ... */</span>
  <span class="token keyword">return</span> expressionResult<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Where the expressions types are:</p><ul><li><code>&#x27;ArrowFunctionExpression&#x27;</code></li><li><code>&#x27;AssignmentExpression&#x27;</code></li><li><code>&#x27;AwaitExpression&#x27;</code></li><li><code>&#x27;BinaryExpression&#x27;</code></li><li><code>&#x27;CallExpression&#x27;</code></li><li><code>&#x27;ClassExpression&#x27;</code></li><li><code>&#x27;ConditionalExpression&#x27;</code></li><li><code>&#x27;FunctionExpression&#x27;</code></li><li><code>&#x27;Identifier&#x27;</code></li><li><code>&#x27;LogicalExpression&#x27;</code></li><li><code>&#x27;MemberExpression&#x27;</code></li><li><code>&#x27;NewExpression&#x27;</code></li><li><code>&#x27;ObjectExpression&#x27;</code></li><li><code>&#x27;SequenceExpression&#x27;</code></li><li><code>&#x27;SpreadElement&#x27;</code></li><li><code>&#x27;TaggedTemplateExpression&#x27;</code></li><li><code>&#x27;TemplateLiteral&#x27;</code></li><li><code>&#x27;ThisExpression&#x27;</code></li><li><code>&#x27;UnaryExpression&#x27;</code></li><li><code>&#x27;UpdateExpression&#x27;</code></li></ul><h3><span id="evaluateidentifier"></span>evaluateIdentifier<a href="#evaluateidentifier" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncBailHook</code></p><p>Called when evaluating an identifier that is a free variable.</p><ul><li>Hook Parameters: <code>identifier</code></li><li>Callback Parameters: <code>expression</code></li></ul><h3><span id="evaluatedefinedidentifier"></span>evaluateDefinedIdentifier<a href="#evaluatedefinedidentifier" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncBailHook</code></p><p>Called when evaluating an identifier that is a defined variable.</p><ul><li>Hook Parameters: <code>identifier</code></li><li>Callback Parameters: <code>expression</code></li></ul><h3><span id="evaluatecallexpressionmember"></span>evaluateCallExpressionMember<a href="#evaluatecallexpressionmember" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncBailHook</code></p><p>Called when evaluating a call to a member function of a successfully evaluated expression.</p><ul><li>Hook Parameters: <code>identifier</code></li><li>Callback Parameters: <code>expression</code> <code>param</code></li></ul><p>This expression will trigger the hook:</p><p><strong>index.js</strong></p><pre><code class="hljs language-js"><span class="token keyword">const</span> a <span class="token operator">=</span> expression<span class="token punctuation">.</span><span class="token function">myFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><strong>MyPlugin.js</strong></p><pre><code class="hljs language-js">parser<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>evaluateCallExpressionMember
  <span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">&#x27;myFunc&#x27;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">&#x27;MyPlugin&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">expression<span class="token punctuation">,</span> param</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">/* ... */</span>
    <span class="token keyword">return</span> expressionResult<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3><span id="statement"></span>statement<a href="#statement" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncBailHook</code></p><p>General purpose hook that is called for every parsed statement in a code fragment.</p><ul><li>Callback Parameters: <code>statement</code></li></ul><pre><code class="hljs language-js">parser<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>statement<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">&#x27;MyPlugin&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">statement</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">/* ... */</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Where the <code>statement.type</code> could be:</p><ul><li><code>&#x27;BlockStatement&#x27;</code></li><li><code>&#x27;VariableDeclaration&#x27;</code></li><li><code>&#x27;FunctionDeclaration&#x27;</code></li><li><code>&#x27;ReturnStatement&#x27;</code></li><li><code>&#x27;ClassDeclaration&#x27;</code></li><li><code>&#x27;ExpressionStatement&#x27;</code></li><li><code>&#x27;ImportDeclaration&#x27;</code></li><li><code>&#x27;ExportAllDeclaration&#x27;</code></li><li><code>&#x27;ExportDefaultDeclaration&#x27;</code></li><li><code>&#x27;ExportNamedDeclaration&#x27;</code></li><li><code>&#x27;IfStatement&#x27;</code></li><li><code>&#x27;SwitchStatement&#x27;</code></li><li><code>&#x27;ForInStatement&#x27;</code></li><li><code>&#x27;ForOfStatement&#x27;</code></li><li><code>&#x27;ForStatement&#x27;</code></li><li><code>&#x27;WhileStatement&#x27;</code></li><li><code>&#x27;DoWhileStatement&#x27;</code></li><li><code>&#x27;ThrowStatement&#x27;</code></li><li><code>&#x27;TryStatement&#x27;</code></li><li><code>&#x27;LabeledStatement&#x27;</code></li><li><code>&#x27;WithStatement&#x27;</code></li></ul><h3><span id="statementif"></span>statementIf<a href="#statementif" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncBailHook</code></p><p>Called when parsing an if statement. Same as the <code>statement</code> hook, but triggered only when <code>statement.type == &#x27;IfStatement&#x27;</code>.</p><ul><li>Callback Parameters: <code>statement</code></li></ul><h3><span id="label"></span>label<a href="#label" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncBailHook</code></p><p>Called when parsing statements with a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/label">label</a>. Those statements have <code>statement.type === &#x27;LabeledStatement&#x27;</code>.</p><ul><li>Hook Parameters: <code>labelName</code></li><li>Callback Parameters: <code>statement</code></li></ul><h3><span id="import"></span>import<a href="#import" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncBailHook</code></p><p>Called for every import statement in a code fragment. The <code>source</code> parameter contains the name of the imported file.</p><ul><li>Callback Parameters: <code>statement</code> <code>source</code></li></ul><p>The following import statement will trigger the hook once:</p><p><strong>index.js</strong></p><pre><code class="hljs language-js"><span class="token keyword">import</span> _ <span class="token keyword">from</span> <span class="token string">&#x27;lodash&#x27;</span><span class="token punctuation">;</span></code></pre><p><strong>MyPlugin.js</strong></p><pre><code class="hljs language-js">parser<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>import<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">&#x27;MyPlugin&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">statement<span class="token punctuation">,</span> source</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// source == &#x27;lodash&#x27;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3><span id="importspecifier"></span>importSpecifier<a href="#importspecifier" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncBailHook</code></p><p>Called for every specifier of every <code>import</code> statement.</p><ul><li>Callback Parameters: <code>statement</code> <code>source</code> <code>exportName</code> <code>identifierName</code></li></ul><p>The following import statement will trigger the hook twice:</p><p><strong>index.js</strong></p><pre><code class="hljs language-js"><span class="token keyword">import</span> _<span class="token punctuation">,</span> <span class="token punctuation">{</span> has <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;lodash&#x27;</span><span class="token punctuation">;</span></code></pre><p><strong>MyPlugin.js</strong></p><pre><code class="hljs language-js">parser<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>importSpecifier<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span>
  <span class="token string">&#x27;MyPlugin&#x27;</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token parameter">statement<span class="token punctuation">,</span> source<span class="token punctuation">,</span> exportName<span class="token punctuation">,</span> identifierName</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">/* First call
    source == &#x27;lodash&#x27;
    exportName == &#x27;default&#x27;
    identifierName == &#x27;_&#x27;
  */</span>
    <span class="token comment">/* Second call
    source == &#x27;lodash&#x27;
    exportName == &#x27;has&#x27;
    identifierName == &#x27;has&#x27;
  */</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3><span id="export"></span>export<a href="#export" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncBailHook</code></p><p>Called for every <code>export</code> statement in a code fragment.</p><ul><li>Callback Parameters: <code>statement</code></li></ul><h3><span id="exportimport"></span>exportImport<a href="#exportimport" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncBailHook</code></p><p>Called for every <code>export</code>-import statement eg: <code>export * from &#x27;otherModule&#x27;;</code>.</p><ul><li>Callback Parameters: <code>statement</code> <code>source</code></li></ul><h3><span id="exportdeclaration"></span>exportDeclaration<a href="#exportdeclaration" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncBailHook</code></p><p>Called for every <code>export</code> statement exporting a declaration.</p><ul><li>Callback Parameters: <code>statement</code> <code>declaration</code></li></ul><p>Those exports will trigger this hook:</p><pre><code class="hljs language-js"><span class="token keyword">export</span> <span class="token keyword">const</span> myVar <span class="token operator">=</span> <span class="token string">&#x27;hello&#x27;</span><span class="token punctuation">;</span> <span class="token comment">// also var, let</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">FunctionName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">ClassName</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></code></pre><h3><span id="exportexpression"></span>exportExpression<a href="#exportexpression" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncBailHook</code></p><p>Called for every <code>export</code> statement exporting an expression e.g.<code>export default expression;</code>.</p><ul><li>Callback Parameters: <code>statement</code> <code>declaration</code></li></ul><h3><span id="exportspecifier"></span>exportSpecifier<a href="#exportspecifier" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncBailHook</code></p><p>Called for every specifier of every <code>export</code> statement.</p><ul><li>Callback Parameters: <code>statement</code> <code>identifierName</code> <code>exportName</code> <code>index</code></li></ul><h3><span id="exportimportspecifier"></span>exportImportSpecifier<a href="#exportimportspecifier" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncBailHook</code></p><p>Called for every specifier of every <code>export</code>-import statement.</p><ul><li>Callback Parameters: <code>statement</code> <code>source</code> <code>identifierName</code> <code>exportName</code> <code>index</code></li></ul><h3><span id="vardeclaration"></span>varDeclaration<a href="#vardeclaration" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncBailHook</code></p><p>Called when parsing a variable declaration.</p><ul><li>Callback Parameters: <code>declaration</code></li></ul><h3><span id="vardeclarationlet"></span>varDeclarationLet<a href="#vardeclarationlet" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncBailHook</code></p><p>Called when parsing a variable declaration defined using <code>let</code></p><ul><li>Callback Parameters: <code>declaration</code></li></ul><h3><span id="vardeclarationconst"></span>varDeclarationConst<a href="#vardeclarationconst" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncBailHook</code></p><p>Called when parsing a variable declaration defined using <code>const</code></p><ul><li>Callback Parameters: <code>declaration</code></li></ul><h3><span id="vardeclarationvar"></span>varDeclarationVar<a href="#vardeclarationvar" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncBailHook</code></p><p>Called when parsing a variable declaration defined using <code>var</code></p><ul><li>Callback Parameters: <code>declaration</code></li></ul><h3><span id="canrename"></span>canRename<a href="#canrename" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncBailHook</code></p><p>Triggered before renaming an identifier to determine if the renaming is allowed. This is usually used together with the <code>rename</code> hook.</p><ul><li>Hook Parameters: <code>identifier</code></li><li>Callback Parameters: <code>expression</code></li></ul><pre><code class="hljs language-js"><span class="token keyword">var</span> a <span class="token operator">=</span> b<span class="token punctuation">;</span>

parser<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>canRename<span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">&#x27;b&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">&#x27;MyPlugin&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">expression</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// returning true allows renaming</span>
  <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3><span id="rename"></span>rename<a href="#rename" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncBailHook</code></p><p>Triggered when renaming to get the new identifier. This hook will be called only if <code>canRename</code> returns <code>true</code>.</p><ul><li>Hook Parameters: <code>identifier</code></li><li>Callback Parameters: <code>expression</code></li></ul><pre><code class="hljs language-js"><span class="token keyword">var</span> a <span class="token operator">=</span> b<span class="token punctuation">;</span>

parser<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>rename<span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">&#x27;b&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">&#x27;MyPlugin&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">expression</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3><span id="assigned"></span>assigned<a href="#assigned" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncBailHook</code></p><p>Called when parsing an <code>AssignmentExpression</code> before parsing the assigned expression.</p><ul><li>Hook Parameters: <code>identifier</code></li><li>Callback Parameters: <code>expression</code></li></ul><pre><code class="hljs language-js">a <span class="token operator">+=</span> b<span class="token punctuation">;</span>

parser<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>assigned<span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">&#x27;a&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">&#x27;MyPlugin&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">expression</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// this is called before parsing b</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3><span id="assign"></span>assign<a href="#assign" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncBailHook</code></p><p>Called when parsing an <code>AssignmentExpression</code> before parsing the assign expression.</p><ul><li>Hook Parameters: <code>identifier</code></li><li>Callback Parameters: <code>expression</code></li></ul><pre><code class="hljs language-js">a <span class="token operator">+=</span> b<span class="token punctuation">;</span>

parser<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>assigned<span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">&#x27;a&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">&#x27;MyPlugin&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">expression</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// this is called before parsing a</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3><span id="typeof"></span>typeof<a href="#typeof" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncBailHook</code></p><p>Triggered when parsing the <code>typeof</code> of an identifier</p><ul><li>Hook Parameters: <code>identifier</code></li><li>Callback Parameters: <code>expression</code></li></ul><h3><span id="call"></span>call<a href="#call" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncBailHook</code></p><p>Called when parsing a function call.</p><ul><li>Hook Parameters: <code>identifier</code></li><li>Callback Parameters: <code>expression</code></li></ul><pre><code class="hljs language-js"><span class="token function">eval</span><span class="token punctuation">(</span><span class="token comment">/* something */</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

parser<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>call<span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">&#x27;eval&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">&#x27;MyPlugin&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">expression</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3><span id="callmemberchain"></span>callMemberChain<a href="#callmemberchain" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncBailHook</code></p><p>Triggered when parsing a call to a member function of an object.</p><ul><li>Hook Parameters: <code>objectIdentifier</code></li><li>Callback Parameters: <code>expression, properties</code></li></ul><pre><code class="hljs language-js">myObj<span class="token punctuation">.</span><span class="token function">anyFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

parser<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>callMemberChain
  <span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">&#x27;myObj&#x27;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">&#x27;MyPlugin&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">expression<span class="token punctuation">,</span> properties</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3><span id="new"></span>new<a href="#new" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncBailHook</code></p><p>Invoked when parsing a <code>new</code> expression.</p><ul><li>Hook Parameters: <code>identifier</code></li><li>Callback Parameters: <code>expression</code></li></ul><pre><code class="hljs language-js"><span class="token keyword">new</span> <span class="token class-name">MyClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

parser<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>new<span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">&#x27;MyClass&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">&#x27;MyPlugin&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">expression</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3><span id="expression"></span>expression<a href="#expression" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncBailHook</code></p><p>Called when parsing an expression.</p><ul><li>Hook Parameters: <code>identifier</code></li><li>Callback Parameters: <code>expression</code></li></ul><pre><code class="hljs language-js"><span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>

parser<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>expression<span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">&#x27;this&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">&#x27;MyPlugin&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">expression</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3><span id="expressionconditionaloperator"></span>expressionConditionalOperator<a href="#expressionconditionaloperator" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncBailHook</code></p><p>Called when parsing a <code>ConditionalExpression</code> e.g. <code>condition ? a : b</code></p><ul><li>Callback Parameters: <code>expression</code></li></ul><h3><span id="program"></span>program<a href="#program" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncBailHook</code></p><p>Get access to the abstract syntax tree (AST) of a code fragment</p><ul><li>Parameters: <code>ast</code> <code>comments</code></li></ul><h1><span id="NormalModuleFactory-Hooks"></span>NormalModuleFactory Hooks<a href="#NormalModuleFactory-Hooks" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1>
<p><code>Compiler</code> 使用 <code>NormalModuleFactory</code> 模块生成各类模块。从入口点开始，此模块会分解每个请求，解析文件内容以查找进一步的请求，然后通过分解所有请求以及解析新的文件来爬取全部文件。在最后阶段，每个依赖项都会成为一个模块实例。</p><p><code>NormalModuleFactory</code> 类扩展了 <code>Tapable</code> 并提供了以下的生命周期钩子。
你可以像使用编译器钩子一样使用它们：</p><pre><code class="hljs language-js">NormalModuleFactory<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>someHook<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token comment">/* ... */</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><code>NormalModuleFactory</code> 创建了可由 <code>HookMaps</code> 访问的 <code>Parser</code> 和 <code>Generator</code> 实例。同时必须传入 <code>identifier</code> 才能使用以下代码：</p><pre><code class="hljs language-js">NormalModuleFactory<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>someHook<span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">&#x27;identifier&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token comment">/* ... */</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>与 <code>compiler</code> 一样，<code>tapAsync</code> 和 <code>tapPromise</code> 是否可用
取决于钩子的类型。</p><h3><span id="beforeresolve"></span>beforeResolve<a href="#beforeresolve" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>AsyncSeriesBailHook</code></p><p>当遇到新的依赖项请求时调用。可以通过返回 <code>false</code> 来忽略依赖项。否则，返回 <code>undefined</code> 以继续。</p><ul><li>回调参数：<code>resolveData</code></li></ul><h3><span id="factorize"></span>factorize<a href="#factorize" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>AsyncSeriesBailHook</code></p><p>在初始化解析之前调用。它应该返回 <code>undefined</code> 以继续。</p><ul><li>回调参数：<code>resolveData</code></li></ul><h3><span id="resolve"></span>resolve<a href="#resolve" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>AsyncSeriesBailHook</code></p><p>在请求被解析之前调用。可以通过返回 <code>false</code> 来忽略依赖项。返回一个模块实例将结束进程。否则，返回 <code>undefined</code> 以继续。</p><ul><li>回调参数：<code>resolveData</code></li></ul><h3><span id="resolveforscheme"></span>resolveForScheme<a href="#resolveforscheme" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>AsyncSeriesBailHook</code></p><p>在解析符合统一资源标志符方案(URI)的请求之前调用。</p><ul><li>回调参数：<code>resolveData</code></li></ul><h3><span id="afterresolve"></span>afterResolve<a href="#afterresolve" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>AsyncSeriesBailHook</code></p><p>在请求解析后调用。</p><ul><li>回调参数：<code>resolveData</code></li></ul><h3><span id="createmodule"></span>createModule<a href="#createmodule" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>AsyncSeriesBailHook</code></p><p>在创建 <code>NormalModule</code> 实例之前调用。</p><ul><li>回调参数：<code>createData</code> <code>resolveData</code></li></ul><h3><span id="module"></span>module<a href="#module" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>SyncWaterfallHook</code></p><p>在创建 <code>NormalModule</code> 实例后调用。</p><ul><li>回调参数：<code>module</code> <code>createData</code> <code>resolveData</code></li></ul><h3><span id="createparser"></span>createParser<a href="#createparser" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>HookMap&lt;SyncBailHook&gt;</code></p><p>在 <code>Parser</code> 实例创建之前调用。<code>parserOptions</code> 是 <a href="/configuration/module/#moduleparser">module.parser</a> 中对应标识符或空对象的选项。</p><ul><li><p>钩子参数：<code>identifier</code></p></li><li><p>回调参数：<code>parserOptions</code></p></li></ul><h3><span id="parser"></span>parser<a href="#parser" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>HookMap&lt;SyncHook&gt;</code></p><p>在创建 <code>Parser</code> 实例后触发。</p><ul><li><p>钩子参数：<code>identifier</code></p></li><li><p>回调参数：<code>parser</code> <code>parserOptions</code></p></li></ul><p>可能的默认标识符：</p><ol><li><code>javascript/auto</code></li><li><code>javascript/dynamic</code></li><li><code>javascript/esm</code></li><li><code>json</code></li><li><code>webassembly/sync</code></li><li><code>webassembly/async</code></li><li><code>asset</code></li></ol><h3><span id="creategenerator"></span>createGenerator<a href="#creategenerator" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>HookMap&lt;SyncBailHook&gt;</code></p><p>在 <code>Generator</code> 实例创建之前调用。<code>generatorOptions</code> 是 <a href="/configuration/module/#modulegenerator">module.parser</a> 中对应标识符或空对象的选项。</p><ul><li><p>钩子参数：<code>identifier</code></p></li><li><p>回调参数：<code>generatorOptions</code></p></li></ul><h3><span id="generator"></span>generator<a href="#generator" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>HookMap&lt;SyncHook&gt;</code></p><p>在 <code>Generator</code> 实例创建之后调用。</p><ul><li><p>钩子参数：<code>identifier</code></p></li><li><p>回调参数：<code>generator</code> <code>generatorOptions</code></p></li></ul><p>可能的默认标识符：</p><ol><li><code>json</code></li><li><code>webassembly/sync</code></li><li><code>webassembly/async</code></li><li><code>asset</code></li><li><code>asset/source</code></li><li><code>asset/resource</code></li><li><code>asset/inline</code></li></ol><h1><span id="Compilation-Object"></span>Compilation Object<a href="#Compilation-Object" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1>
<p>Compilation 对象有很多可用的方法和钩子。在此页面，我们将会列举出这些可用的方法和属性。</p><h2><span id="compilation-object-methods"></span>compilation 对象方法<a href="#compilation-object-methods" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><h3><span id="getstats"></span>getStats<a href="#getstats" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>function</code></p><p>返回当前编译的状态对象。</p><h3><span id="addmodule"></span>addModule<a href="#addmodule" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>function (module, cacheGroup)</code></p><p>向当前编译添加一个模块。</p><p>参数：</p><ul><li><code>module</code> - 要添加的模块</li><li><code>cacheGroup</code> - 模块的 <code>cacheGroup</code></li></ul><h3><span id="getmodule"></span>getModule<a href="#getmodule" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>function (module)</code></p><p>通过编译的标识符获取其模块。</p><p>参数：</p><ul><li><code>module</code> - 要获取的模块。标识符是通过编译使用 <code>module.identifier()</code> 方法从模块中提取的。</li></ul><h3><span id="findmodule"></span>findModule<a href="#findmodule" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>function (module)</code></p><p>尝试通过其标识符搜索模块。</p><p>参数：</p><ul><li><code>module</code> - 要搜索的模块。标识符是通过编译使用 <code>module.identifier()</code> 方法从模块中提取的。</li></ul><h3><span id="buildmodule"></span>buildModule<a href="#buildmodule" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>function (module, optional, origin, dependencies)</code></p><p>构建给定的模块。</p><p>参数：</p><ul><li><code>module</code> - 要构建的模块。</li><li><code>optional</code> - 可选标志。</li><li><code>origin</code> - 请求此模块构建的原始模块。</li><li><code>dependencies</code> - 要构建模块的可选依赖。</li></ul><h3><span id="processmoduledependencies"></span>processModuleDependencies<a href="#processmoduledependencies" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>function (module, callback)</code></p><p>处理给定模块依赖。</p><p>参数：</p><ul><li><code>module</code> - 要被处理依赖的模块。</li><li><code>callback</code> - 模块依赖处理完成时回调的函数。</li></ul><h3><span id="addentry"></span>addEntry<a href="#addentry" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>function (context, entry, name, callback)</code></p><p>为编译添加入口。</p><p>参数：</p><ul><li><code>context</code> - 入口的上下文路径。</li><li><code>entry</code> - 入口依赖。</li><li><code>name</code> - 入口名称。</li><li><code>callback</code> - 添加入口完成之后回调的函数。</li></ul><h3><span id="rebuildmodule"></span>rebuildModule<a href="#rebuildmodule" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>function (module, thisCallback)</code></p><p>触发模块的重建。</p><p>参数：</p><ul><li><code>module</code> - 要被重建的模块。</li><li><code>thisCallback</code> - 模块重建完成之后调用的函数。</li></ul><h3><span id="finish"></span>finish<a href="#finish" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>function (callback)</code></p><p>完成编译并调用给定的回调。</p><p>参数：</p><ul><li><code>callback</code> - 编译完成之后调用的函数。</li></ul><h3><span id="seal"></span>seal<a href="#seal" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>function (callback)</code></p><p>封闭编译。</p><p>参数：</p><ul><li><code>callback</code> - 封闭编译时回调的函数。</li></ul><h3><span id="unseal"></span>unseal<a href="#unseal" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>function</code></p><p>解除封闭编译。</p><p>参数：</p><ul><li><code>callback</code> - 解除封闭编译时回调的函数。</li></ul><h3><span id="reportdependencyerrorsandwarnings"></span>reportDependencyErrorsAndWarnings<a href="#reportdependencyerrorsandwarnings" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>function (module, blocks)</code></p><p>将给定模块的错误和警告添加到编译的错误和警告中。</p><p>参数：</p><ul><li><code>module</code> - 要被报告错误与警告的模块。</li><li><code>blocks</code> - 一组要报告的依赖块。</li></ul><h3><span id="addchunkingroup"></span>addChunkInGroup<a href="#addchunkingroup" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>function (groupOptions, module, loc, request)</code></p><p>将模块添加到现有 chunk 组或创建一个新的组。返回一个 <code>chunkGroup</code>。</p><p>参数：</p><ul><li><code>groupOptions</code> - chunk 组的选项。</li><li><code>module</code> - 引用 chunk 组的模块。</li><li><code>loc</code> - 引用 chunk 组的位置（模块内部）。</li><li><code>request</code> - 引用 chunk 组的请求。</li></ul><h3><span id="addchunk"></span>addChunk<a href="#addchunk" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>function (name)</code></p><p>向 <code>compilation.chunks</code> 创建或添加一个新的 chunk。返回这个 <code>chunk</code>.</p><p>参数：</p><ul><li><code>name</code> - chunk 的名称。</li></ul><h3><span id="assigndepth"></span>assignDepth<a href="#assigndepth" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>function (module)</code></p><p>为给定的模块及其依赖块递归分配 <code>depth</code> 。</p><p>参数：</p><ul><li><code>module</code> - 要被分配 depth 的模块。</li></ul><h3><span id="getdependencyreference"></span>getDependencyReference<a href="#getdependencyreference" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>function (module, dependency)</code></p><p>返回给定模块对依赖的引用。</p><p>参数：</p><ul><li><code>module</code> - 有问题的模块。</li><li><code>dependency</code> - 要引用的依赖。</li></ul><h3><span id="processdependenciesblocksforchunkgroups"></span>processDependenciesBlocksForChunkGroups<a href="#processdependenciesblocksforchunkgroups" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>function (inputChunkGroups)</code></p><p>通过 <code>Module</code> 图创建 <code>Chunk</code> 图。该过程分为两个阶段完成。阶段一：遍历模块图，在 <code>chunkDependencies</code> 中创建一个基础 chunk 图。阶段二：通过基本 chunk 图遍历所有可能的方法并且跟踪可用模块。遍历过程中 <code>processDependenciesBlocksForChunkGroups</code> 将 chunk 相互连接，并将 <code>Blocks</code> 与 <code>Chunks</code> 连接. 当一个 chunk 的所有模块都已经可用且未连接不需要的 chunk 时，它将停止遍历。</p><p>参数：</p><ul><li><code>inputChunkGroups</code> - 被处理的 chunk 组。</li></ul><h3><span id="removereasonsofdependencyblock"></span>removeReasonsOfDependencyBlock<a href="#removereasonsofdependencyblock" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>function (module, block)</code></p><p>移除模块与依赖块之间的关系。</p><p>参数：</p><ul><li><code>module</code> - 要移除的模块关系。</li><li><code>block</code> - 依赖块。</li></ul><h3><span id="patchchunksafterreasonremoval"></span>patchChunksAfterReasonRemoval<a href="#patchchunksafterreasonremoval" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>function (module, chunk)</code></p><p>删除依赖性原因后，修补模块和 chunk 的关系。被 <code>removeReasonsOfDependencyBlock</code> 自动调用。</p><p>参数：</p><ul><li><code>module</code> - 要修复关系的模块。</li><li><code>chunk</code> - 要修复关系的 chunk。</li></ul><h3><span id="removechunkfromdependencies"></span>removeChunkFromDependencies<a href="#removechunkfromdependencies" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>function (block, chunk)</code></p><p>在除去依赖性原因后，从依赖块模块和 chunk 中移除给定的 chunk。会被 <code>removeReasonsOfDependencyBlock</code> 自动调用。</p><p>参数：</p><ul><li><code>block</code> - <code>Chunk</code> 的块连接。</li><li><code>chunk</code> - 从依赖中删除的块。</li></ul><h3><span id="sortitemswithmoduleids"></span>sortItemsWithChunkIds<a href="#sortitemswithmoduleids" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>function</code></p><h3><span id="summarizedependencies"></span>summarizeDependencies<a href="#summarizedependencies" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>function</code></p><h3><span id="createhash"></span>createHash<a href="#createhash" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>function</code></p><h3><span id="createmoduleassets"></span>createModuleAssets<a href="#createmoduleassets" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>function</code></p><h3><span id="createchunkassets"></span>createChunkAssets<a href="#createchunkassets" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>function</code></p><h3><span id="getpath"></span>getPath<a href="#getpath" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>function (filename, data)</code></p><p>返回插值路径。</p><p>参数：</p><ul><li><code>filename</code> - 用于通过哈希获取资源路径。</li><li><code>data</code> - 数据对象。</li></ul><h3><span id="getpathwithinfo"></span>getPathWithInfo<a href="#getpathwithinfo" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>function (filename, data)</code></p><p>返回插值路径和资源信息。</p><p>参数：</p><ul><li><code>filename</code> - 用于通过哈希获取资源路径。</li><li><code>data</code> - 数据对象。</li></ul><h3><span id="createchildcompiler"></span>createChildCompiler<a href="#createchildcompiler" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>function (name, outputOptions, plugins)</code></p><p>允许在 webpack 中运行另一个 webpack 实例。但是，子编译器会应用不同的设置和配置。他会从父编译器（或者顶级编译器）中复制所有的钩子(hook)和插件(plugin)，并且创建一个子 <code>Compiler</code> 实例。 返回值为创建好的 <code>Compiler</code> 实例。</p><p>参数：</p><ul><li><code>name</code> - 子 <code>Compiler</code> 的名称。</li><li><code>outputOptions</code> - 输出选项。</li><li><code>plugins</code> - 将被提供的 webpack 插件。</li></ul><h3><span id="checkconstraints"></span>checkConstraints<a href="#checkconstraints" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>function</code></p><h3><span id="emitasset"></span>emitAsset<a href="#emitasset" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>function (file, source, assetInfo = {})</code></p><p>参数：</p><ul><li><code>file</code> - 资源名称。</li><li><code>source</code> - 资源来源。</li><li><code>assetInfo</code> - 附加资源信息。</li></ul><h3><span id="updateasset"></span>updateAsset<a href="#updateasset" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>function (file, newSourceOrFunction, assetInfoUpdateOrFunction)</code></p><p>参数：</p><ul><li><code>file</code> - 资源名称。</li><li><code>newSourceOrFunction</code> - 新资源来源或将旧资源转换为新资源的函数。</li><li><code>assetInfoUpdateOrFunction</code> - 新资源信息或将旧资源转换为新资源的函数。</li></ul><h3><span id="deleteasset"></span>deleteAsset<a href="#deleteasset" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>function (file)</code></p><p>参数：</p><ul><li><code>file</code> —— 资源的文件名</li></ul><h3><span id="getassets"></span>getAssets<a href="#getassets" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>function</code></p><p>返回当前编译下所有资源的数组。</p><h3><span id="getasset"></span>getAsset<a href="#getasset" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3><p><code>function (name)</code></p><p>参数：</p><ul><li><code>name</code> - 要返回的资源名称。</li></ul><h1><span id="Plugin-API"></span>Plugin API<a href="#Plugin-API" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1>
<p>插件是 webpack 生态的关键部分，
它为社区用户提供了一种强有力的方式来直接触及 webpack 的编译过程(compilation process)。
插件能够 <a href="/api/compiler-hooks/#hooks">hook</a> 到每一个编译(compilation)中发出的关键事件中。
在编译的每个阶段中，插件都拥有对 <code>compiler</code> 对象的完全访问能力，
并且在合适的时机，还可以访问当前的 <code>compilation</code> 对象。</p><aside class="tip"><h6 class="tip__prefix">提示</h6><p>关于编写插件的高级介绍，请移步：
<a href="/contribute/writing-a-plugin">自定义插件</a>。</p></aside><p>让我们首先从 tapable 工具开始，
它为 webpack 插件接口提供了核心能力的。</p><h2><span id="tapable"></span>Tapable<a href="#tapable" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>这个小型库是 webpack 的一个核心工具，但也可用于其他地方，
以提供类似的插件接口。
在 webpack 中的许多对象都扩展自 <code>Tapable</code> 类。
它对外暴露了 <code>tap</code>，<code>tapAsync</code> 和 <code>tapPromise</code> 等方法，
插件可以使用这些方法向 webpack 中注入自定义构建的步骤，这些步骤将在构建过程中触发。</p><p>请查阅<a href="https://github.com/webpack/tapable">文档</a>了解更多知识。
理解上面的的三种 <code>tap</code> 方法，
以及提供这些方法的钩子(hooks)对于编写插件来说是至关重要的。
那些扩展自 <code>Tapable</code> 的对象（例如：compiler），
以及其提供的钩子(hooks)和每个钩子的类型（例如：<code>同步钩子(SyncHook)</code>）值得关注。</p><h2><span id="plugin-types"></span>插件类型<a href="#plugin-types" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>根据使用不同的钩子(hooks)和 <code>tap</code> 方法，
插件可以以多种不同的方式运行。
这个工作方式与 Tapable 提供的<a href="https://github.com/webpack/tapable#tapable">钩子(hooks)</a>密切相关。
<a href="/api/compiler-hooks/#hooks">compiler hooks</a> 分别记录了 Tapable 内在的钩子，
并指出哪些 tap 方法可用。</p><p>所以，依赖于使用的 <code>tap</code> 方法的不同，
插件可能会以不同的方式运行。
例如：当你钩入到 <code>编译(compile)</code> 阶段时，只有同步的 <code>tap</code> 方法可以使用。</p><pre><code class="hljs language-js">compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>compile<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">&#x27;MyPlugin&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">params</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#x27;以同步方式触及 compile 钩子。&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>然而，对于可以使用 <code>AsyncHook</code> 的 <code>run</code> 阶段，
则需使用 <code>tapAsync</code> 或 <code>tapPromise</code>（以及 <code>tap</code>）方法。</p><pre><code class="hljs language-js">compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>run<span class="token punctuation">.</span><span class="token function">tapAsync</span><span class="token punctuation">(</span>
  <span class="token string">&#x27;MyPlugin&#x27;</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token parameter">source<span class="token punctuation">,</span> target<span class="token punctuation">,</span> routesList<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#x27;以异步方式触及运行钩子。&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>run<span class="token punctuation">.</span><span class="token function">tapPromise</span><span class="token punctuation">(</span><span class="token string">&#x27;MyPlugin&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">source<span class="token punctuation">,</span> target<span class="token punctuation">,</span> routesList</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#x27;以异步的方式触发具有延迟操作的钩子。&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>run<span class="token punctuation">.</span><span class="token function">tapPromise</span><span class="token punctuation">(</span>
  <span class="token string">&#x27;MyPlugin&#x27;</span><span class="token punctuation">,</span>
  <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">source<span class="token punctuation">,</span> target<span class="token punctuation">,</span> routesList</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#x27;以异步的方式触发具有延迟操作的钩子。&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>这些需求(story)的含义在于，
我们可以有多种方式 hook 到 compiler 中，可以让各种插件都以合适的方式去运行。</p><h2><span id="custom-hooks"></span>自定义钩子<a href="#custom-hooks" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>为了便于其他插件的编译过程中可以 <code>tap</code> 到，
你可以这样做：</p><ol><li><p>Create a module-scope <code>WeakMap</code> for compilation hooks:</p><pre><code class="hljs language-ts"><span class="token keyword">const</span> compilationHooks <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeakMap<span class="token operator">&lt;</span>Compilation<span class="token punctuation">,</span> MyHooks<span class="token operator">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">MyHooks</span> <span class="token punctuation">{</span>
  custom<span class="token operator">:</span> SyncHook<span class="token operator">&lt;</span><span class="token punctuation">[</span><span class="token builtin">number</span><span class="token punctuation">,</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></li><li><p>在插件中创建一个静态方法：</p><pre><code class="hljs language-ts"><span class="token keyword">static</span> <span class="token function">getCompilationHooks</span><span class="token punctuation">(</span>compilation<span class="token operator">:</span> Compilation<span class="token punctuation">)</span> <span class="token operator">:</span> MyHooks <span class="token punctuation">{</span>
  <span class="token keyword">let</span> hooks <span class="token operator">=</span> compilationHooks<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span>compilation<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>hooks <span class="token operator">===</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    compilationHooks<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span>compilation<span class="token punctuation">,</span> hooks <span class="token operator">=</span> <span class="token punctuation">{</span>
      custom<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">SyncHook</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> hooks<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></li><li><p>像下面这样在你的插件中调用钩子函数：</p><pre><code class="hljs language-ts"><span class="token keyword">const</span> hooks <span class="token operator">=</span> MyPlugin<span class="token punctuation">.</span><span class="token function">getCompilationHooks</span><span class="token punctuation">(</span>compilation<span class="token punctuation">)</span><span class="token punctuation">;</span>

hooks<span class="token punctuation">.</span><span class="token function">custom</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&#x27;hello&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></li><li><p>其他插件也可以访问你的自定义钩子函数：</p><pre><code class="hljs language-ts"><span class="token keyword">import</span> MyPlugin <span class="token keyword">from</span> <span class="token string">&#x27;my-plugin&#x27;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> hooks <span class="token operator">=</span> MyPlugin<span class="token punctuation">.</span><span class="token function">getCompilationHooks</span><span class="token punctuation">(</span>compilation<span class="token punctuation">)</span><span class="token punctuation">;</span>

hooks<span class="token punctuation">.</span>custom<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">&#x27;OtherPlugin&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>n<span class="token punctuation">,</span> s<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// magic</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></li></ol><p>再次声明，
查看 <code>tapable</code> <a href="https://github.com/webpack/tapable">文档</a> 来了解更多不同的钩子类(hook class)，以及它们是如何工作的。</p><h2><span id="reporting-progress"></span>进度报告<a href="#reporting-progress" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>插件能够通过 <a href="/plugins/progress-plugin/"><code>ProgressPlugin</code></a> 这个在默认情况下将信息打印到标准错误输出(stderr)的插件来进行进度报告。如果想要使用这个功能，只需要在使用 <a href="/api/cli/">webpack CLI</a> 的时候传入 <code>--progress</code> 参数。</p><p>如果想要自定义打印输出，只需要传递不同的参数到 <a href="/plugins/progress-plugin/"><code>ProgressPlugin</code></a> 的 <code>reportProgress</code> 方法。</p><p>如果想要报告进度，插件必须在 <code>tap</code> 到 hook 的时候使用 <code>context: true</code> 选项。</p><pre><code class="hljs language-js">compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>emit<span class="token punctuation">.</span><span class="token function">tapAsync</span><span class="token punctuation">(</span>
  <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">&#x27;MyPlugin&#x27;</span><span class="token punctuation">,</span>
    context<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> compiler<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> reportProgress <span class="token operator">=</span> context <span class="token operator">&amp;&amp;</span> context<span class="token punctuation">.</span>reportProgress<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>reportProgress<span class="token punctuation">)</span> <span class="token function">reportProgress</span><span class="token punctuation">(</span><span class="token number">0.95</span><span class="token punctuation">,</span> <span class="token string">&#x27;Starting work&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>reportProgress<span class="token punctuation">)</span> <span class="token function">reportProgress</span><span class="token punctuation">(</span><span class="token number">0.95</span><span class="token punctuation">,</span> <span class="token string">&#x27;Done work&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><code>reportProgress</code> 方法在被调用的时候会传入以下的参数：</p><pre><code class="hljs language-js"><span class="token function">reportProgress</span><span class="token punctuation">(</span>percentage<span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><ul><li><code>percentage</code>：此参数未使用。作为代替，<a href="/plugins/progress-plugin/"><code>ProgressPlugin</code></a> 插件会基于当前的钩子(hook)计算进度。</li><li><code>...args</code>：任意数量的字符串，这些字符串会传递给 <code>ProgressPlugin</code> 插件并报告给用户。</li></ul><p>注意：只有 compiler 和 compilation 钩子的子集才支持 <code>reportProgress</code> 方法。请查看 <a href="/plugins/progress-plugin/#supported-hooks"><code>ProgressPlugin</code></a> 了解更多信息。</p><h2><span id="logging"></span>日志<a href="#logging" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>日志的 API 在 webpack 4.37 版本后提供支持。当 <code>logging</code> 在 <a href="/configuration/stats/#statslogging"><code>统计配置(stats configuration)</code></a>中可用和(或)当 <a href="/configuration/other-options/#infrastructurelogging"><code>infrastructure logging</code></a> 可用的时候，插件会通过各自的记录格式(stats，infrastructure)打印信息。</p><ul><li>插件可以使用 <code>compilation.getLogger(&#x27;PluginName&#x27;)</code> 来做记录。这种形式的记录保存在统计数据(Stats)中并做相应的格式化。它能够被用户过滤和导出。</li><li>插件也可以使用 <code>compilation.getInfrastructureLogger(&#x27;PluginName&#x27;)</code> 来做记录。使用 <code>infrastructure</code> 的形式并不会被保存在统计数据(Stats)中，因此也不会被格式化。它通常直接将记录载入到 console/dashboard/GUI 中。它能够被用户过滤。</li><li>插件也可以使用特殊的降级逻辑 <code>compilation.getLogger ? compilation.getLogger(&#x27;PluginName&#x27;) : console</code> 来检测是否支持记录，以此来在不支持 <code>compilation.getLogger</code> 方法的旧版本 webpack 中提供降级方法。</li></ul><h2><span id="next-steps"></span>下一步<a href="#next-steps" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>查看 <a href="/api/compiler-hooks/">compiler hooks</a> 部分，
了解所有可用的 <code>compiler</code> 钩子以及它们提供的参数的详细列表。</p><h1><span id="解析器Resolvers"></span>解析器（Resolvers）<a href="#%E8%A7%A3%E6%9E%90%E5%99%A8Resolvers" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1>
<p>解析器是使用 <code>enhanced-resolve</code> 库创建的。<code>Resolver</code> 类
拓展了 <code>tapable</code> 类，并使用 <code>tapable</code> 来提供了一些钩子。
<code>enhanced-resolve</code> 可以直接用于创建新的解析器，
但是，任何 <a href="/api/node/#compiler-instance"><code>compiler</code> 实例</a> 都有一些解析器实例，可以
被 <code>tap</code> 进去。</p><p>在继续阅读之前，请确保你已经读过
<a href="https://github.com/webpack/enhanced-resolve"><code>enhanced-resolve</code></a> 和 <a href="/api/plugins/#tapable"><code>tapable</code></a> 文档。</p><h2><span id="types"></span>类型<a href="#types" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>在 <code>compiler</code> 类中，提供了三种类型的内置解析器：</p><ul><li><code>normal</code>: 通过绝对或相对路径解析模块。</li><li><code>context</code>: 在给定的上下文中解析模块。</li><li><code>loader</code>: 解析 webpack <a href="/loaders">loader</a>。</li></ul><p>根据需要，任一个被使用在 <code>compiler</code> 中的内置解析器，
可以通过插件进行定制：</p><pre><code class="hljs language-js">compiler<span class="token punctuation">.</span>resolverFactory<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>resolver
  <span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">&#x27;[type]&#x27;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">&#x27;name&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">resolver</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// you can tap into resolver.hooks now</span>
    resolver<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>result<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">&#x27;MyPlugin&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>其中，<code>[type]</code> 是上述三个解析器之一。</p><p>请参阅 <a href="https://github.com/webpack/enhanced-resolve"><code>enhanced-resolve</code> documentation</a> 以获得钩子的完整列表以及它们的介绍。</p><h2><span id="configuration-options"></span>配置选项<a href="#configuration-options" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2><p>上述解析器也可以
利用 <a href="/configuration/resolve/"><code>resolve</code></a> or <a href="/configuration/resolve/#resolveloader"><code>resolveLoader</code></a> 选项，通过配置文件进行定制。这些选项允许
用户可以通过多种选项来更改解析行为，包括
通过解析 <code>plugins</code>。</p><p>解析器插件，例如：<a href="https://github.com/shaketbaby/directory-named-webpack-plugin"><code>DirectoryNamedPlugin</code></a>，可以直接引入
在 <code>resolve.plugins</code>，而不是直接在 <a href="/configuration/plugins/#plugins"><code>plugins</code> configuration option</a> 中使用。</p><aside class="tip"><h6 class="tip__prefix">提示</h6><p>请注意，<code>resolve</code> 配置会影响 <code>normal</code> 解析器和 <code>context</code> 解析器，而“ <code>resolveLoader</code> 用于修改 <code>loader</code> 解析器。</p></aside></div><div class="print:hidden mt-20"><a class="text-gray-500 dark:text-gray-500 text-sm cursor-pointer font-sans hover:underline" href="https://github.com/docschina/webpack.js.org/edit/cn/src/content/api/printable.mdx">编辑此页</a><span class="mx-5 text-black font-bold dark:text-white">·</span><a class="text-gray-500 dark:text-gray-500 text-sm cursor-pointer font-sans hover:underline">打印文档</a></div><div data-testid="contributors" class="print:hidden"><h2 class="!font-sans !font-normal">1<!-- --> <!-- -->位贡献者</h2><div><div class="grid gap-[10px] lg:gap-[15px] grid-cols-contributors"><a href="https://github.com/webpack"><img width="45" height="45" alt="webpack" title="webpack" class="w-full rounded-full shadow" src="/icon-square-small-slack.9281492bb267314634b4.png"/></a></div></div></div></div></section></div><footer class="footer"><div class="container footer__inner"><section class="footer__left"><a class="footer__link" href="/guides/getting-started/">快速开始</a><a class="footer__link" href="/comparison/">对比</a><a href="https://privacy-policy.openjsf.org/" target="_blank" rel="noopener noreferrer" class="footer__link">Privacy Policy</a></section><section class="footer__middle"><a class="footer__icon" href="/"><img src="/icon-square-small.85ba630cf0c5f29ae3e3.svg" alt="webpack icon" width="35" height="35"/></a></section><section class="footer__right"><a href="https://webpack.threadless.com/" target="_blank" rel="noopener noreferrer" class="footer__link">周边</a><a class="footer__link" href="/awesome-webpack/">Awesome webpack</a><a class="footer__link" href="/glossary/">术语</a><a class="footer__link" href="/branding/">品牌</a><a href="https://gitter.im/webpack/webpack" target="_blank" rel="noopener noreferrer" class="footer__link">Gitter</a><a href="https://github.com/webpack/webpack/releases" target="_blank" rel="noopener noreferrer" class="footer__link">更新日志</a><a class="footer__link footer__license" href="/license"><img alt="Creative Commons License" src="/cc.ab77d813bf219c6e34ff.svg" width="25" height="25"/><img alt="Creative Commons License" src="/by.1360bb2e6d1fc28cdd9e.svg" width="25" height="25"/></a></section></div></footer></div></div><script>
window.matchMedia('print').addListener(function(mql) {
  if (!mql.matches) {
      window.close();
  }
});
window.print();
</script><script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?f92e0e48311f635665d2de225751a349";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script></body>