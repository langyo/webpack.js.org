"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1126],{1126:function(a,e,n){n.r(e),n(7378);var t=n(2682);function s(){return s=Object.assign?Object.assign.bind():function(a){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(a[t]=n[t])}return a},s.apply(this,arguments)}function p(a){let{components:e,...n}=a;return(0,t.kt)("wrapper",s({components:e},n),(0,t.kt)("p",null,"Webpack 提供了 Node.js API，可以在 Node.js 运行时下直接使用。"),(0,t.kt)("p",null,"当你需要自定义构建或开发流程时，Node.js API 非常有用，因为此时所有的报告和错误处理都必须自行实现，webpack 仅仅负责编译的部分。所以 ",(0,t.kt)("a",{href:"/configuration/stats",parentName:"p"},(0,t.kt)("inlineCode",{parentName:"a"},"stats"))," 配置选项不会在 ",(0,t.kt)("inlineCode",{parentName:"p"},"webpack()")," 调用中生效。"),(0,t.kt)("h2",null,(0,t.kt)("span",{id:"installation",parentName:"h2"}),"安装(Installation)",(0,t.kt)("a",{href:"#installation","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"开始使用 webpack 的 Node.js API 之前，首先你需要安装 webpack："),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-bash",parentName:"pre"},(0,t.kt)("span",{className:"token function",parentName:"code"},"npm")," ",(0,t.kt)("span",{className:"token function",parentName:"code"},"install")," --save-dev webpack")),(0,t.kt)("p",null,"在 Node.js 文件中，引入 webpack 模块:"),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-js",parentName:"pre"},(0,t.kt)("span",{className:"token keyword",parentName:"code"},"const")," webpack ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,t.kt)("span",{className:"token function",parentName:"code"},"require"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token string",parentName:"code"},"'webpack'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,t.kt)("p",null,"或者如果你更喜欢 ES2015:"),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-js",parentName:"pre"},(0,t.kt)("span",{className:"token keyword",parentName:"code"},"import")," webpack ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"from")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'webpack'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,t.kt)("h2",null,(0,t.kt)("span",{id:"webpack",parentName:"h2"}),"webpack()",(0,t.kt)("a",{href:"#webpack","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"导入的 ",(0,t.kt)("inlineCode",{parentName:"p"},"webpack")," 函数会将 ",(0,t.kt)("a",{href:"/configuration/",parentName:"p"},"配置对象")," 传给 webpack，如果同时传入回调函数会在 webpack compiler 运行时被执行:"),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-js",parentName:"pre"},(0,t.kt)("span",{className:"token keyword",parentName:"code"},"const")," webpack ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,t.kt)("span",{className:"token function",parentName:"code"},"require"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token string",parentName:"code"},"'webpack'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n\n",(0,t.kt)("span",{className:"token function",parentName:"code"},"webpack"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},",")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token parameter",parentName:"code"},"err",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},",")," stats"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=>")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"if")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),"err ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"||")," stats",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function",parentName:"code"},"hasErrors"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// ..."),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// 处理完成"),"\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,t.kt)("aside",{className:"tip"},(0,t.kt)("h6",{className:"tip__prefix",parentName:"aside"},"提示"),(0,t.kt)("p",{parentName:"aside"},(0,t.kt)("inlineCode",{parentName:"p"},"err"),"对象 ",(0,t.kt)("strong",{parentName:"p"},"不包含")," 编译错误，必须使用 ",(0,t.kt)("inlineCode",{parentName:"p"},"stats.hasErrors()")," 单独处理，文档的 ",(0,t.kt)("a",{href:"#error-handling",parentName:"p"},"错误处理")," 将对这部分进行详细介绍。",(0,t.kt)("inlineCode",{parentName:"p"},"err")," 对象只包含 webpack 相关的问题，例如配置错误等。")),(0,t.kt)("aside",{className:"tip"},(0,t.kt)("h6",{className:"tip__prefix",parentName:"aside"},"提示"),(0,t.kt)("p",{parentName:"aside"},"你也可以为 ",(0,t.kt)("inlineCode",{parentName:"p"},"webpack")," 函数提供一个配置数组。更多详细信息，请查看 ",(0,t.kt)("a",{href:"#multicompiler",parentName:"p"},"MultiCompiler")," 章节。")),(0,t.kt)("h2",null,(0,t.kt)("span",{id:"compiler-instance",parentName:"h2"}),"Compiler 实例（Compiler Instance）",(0,t.kt)("a",{href:"#compiler-instance","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"如果你不向 ",(0,t.kt)("inlineCode",{parentName:"p"},"webpack")," 传入可执行的回调函数，\n它会返回一个 webpack ",(0,t.kt)("inlineCode",{parentName:"p"},"Compiler")," 实例。\n你可以通过手动执行它或者为它的构建时添加一个监听器，\n就像 ",(0,t.kt)("a",{href:"/api/cli/",parentName:"p"},"CLI")," 类似。",(0,t.kt)("inlineCode",{parentName:"p"},"Compiler")," 实例提供了以下方法:"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},".run(callback)")),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},".watch(watchOptions, handler)"))),(0,t.kt)("p",null,"通常情况下，仅会创建一个主要 ",(0,t.kt)("inlineCode",{parentName:"p"},"Compiler")," 实例，\n虽然可以创建一些子 compiler 来代理到特定任务。\n",(0,t.kt)("inlineCode",{parentName:"p"},"Compiler")," 基本上只是执行最低限度的功能，以维持生命周期运行的功能。\n它将所有的加载、打包和写入工作，\n都委托到注册过的插件上。"),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"Compiler")," 实例上的 ",(0,t.kt)("inlineCode",{parentName:"p"},"hooks")," 属性，用于将一个插件注册\n到 ",(0,t.kt)("inlineCode",{parentName:"p"},"Compiler")," 的生命周期中的所有钩子事件上。\n",(0,t.kt)("inlineCode",{parentName:"p"},"webpack")," 使用\n",(0,t.kt)("a",{href:"https://github.com/webpack/webpack/blob/master/lib/WebpackOptionsDefaulter.js",parentName:"p"},(0,t.kt)("inlineCode",{parentName:"a"},"WebpackOptionsDefaulter")),"\n和 ",(0,t.kt)("a",{href:"https://github.com/webpack/webpack/blob/master/lib/WebpackOptionsApply.js",parentName:"p"},(0,t.kt)("inlineCode",{parentName:"a"},"WebpackOptionsApply")),"\n来配置 ",(0,t.kt)("inlineCode",{parentName:"p"},"Compiler")," 实例以及所有内置插件。"),(0,t.kt)("p",null,"使用 ",(0,t.kt)("inlineCode",{parentName:"p"},"run")," 方法启动所有编译工作。\n完成之后，执行传入的的 ",(0,t.kt)("inlineCode",{parentName:"p"},"callback")," 函数。\n最终记录下来的概括信息（stats）和错误（errors），都应在这个 callback 函数中获取。"),(0,t.kt)("aside",{className:"warning"},(0,t.kt)("h6",{className:"warning__prefix",parentName:"aside"},"警告"),(0,t.kt)("p",{parentName:"aside"},"这个 API 一次仅支持一个编译。当使用 ",(0,t.kt)("inlineCode",{parentName:"p"},"run")," 或者\n",(0,t.kt)("inlineCode",{parentName:"p"},"watch")," 时，调用 ",(0,t.kt)("inlineCode",{parentName:"p"},"close"),"，并等待它完成后再次执行 ",(0,t.kt)("inlineCode",{parentName:"p"},"run")," 或者 ",(0,t.kt)("inlineCode",{parentName:"p"},"watch"),"。\n并发编译将破坏输出文件。")),(0,t.kt)("h2",null,(0,t.kt)("span",{id:"run",parentName:"h2"}),"执行（Run）",(0,t.kt)("a",{href:"#run","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"调用 ",(0,t.kt)("inlineCode",{parentName:"p"},"Compiler")," 实例的 ",(0,t.kt)("inlineCode",{parentName:"p"},"run")," 方法跟上文提到的\n快速执行方法很类似："),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-js",parentName:"pre"},(0,t.kt)("span",{className:"token keyword",parentName:"code"},"const")," webpack ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,t.kt)("span",{className:"token function",parentName:"code"},"require"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token string",parentName:"code"},"'webpack'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n\n",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"const")," compiler ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,t.kt)("span",{className:"token function",parentName:"code"},"webpack"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// ..."),"\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n\ncompiler",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function",parentName:"code"},"run"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token parameter",parentName:"code"},"err",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},",")," stats"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=>")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// ..."),"\n\n  compiler",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function",parentName:"code"},"close"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token parameter",parentName:"code"},"closeErr"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=>")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// ..."),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,t.kt)("aside",{className:"warning"},(0,t.kt)("h6",{className:"warning__prefix",parentName:"aside"},"警告"),(0,t.kt)("p",{parentName:"aside"},"不要忘记关闭编译器，这样低优先级的工作（比如持久缓存）就有机会完成。")),(0,t.kt)("h2",null,(0,t.kt)("span",{id:"watching",parentName:"h2"}),"监听(Watching)",(0,t.kt)("a",{href:"#watching","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"调用 ",(0,t.kt)("inlineCode",{parentName:"p"},"watch")," 方法会触发 webpack 执行，但之后会监听变更（很像 CLI 命令: ",(0,t.kt)("inlineCode",{parentName:"p"},"webpack --watch"),"），\n一旦 webpack 检测到文件变更，就会重新执行编译。\n该方法返回一个 ",(0,t.kt)("inlineCode",{parentName:"p"},"Watching")," 实例。"),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-js",parentName:"pre"},(0,t.kt)("span",{className:"token function",parentName:"code"},"watch"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),"watchOptions",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},",")," callback",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-js",parentName:"pre"},(0,t.kt)("span",{className:"token keyword",parentName:"code"},"const")," webpack ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,t.kt)("span",{className:"token function",parentName:"code"},"require"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token string",parentName:"code"},"'webpack'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n\n",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"const")," compiler ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,t.kt)("span",{className:"token function",parentName:"code"},"webpack"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// ..."),"\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n\n",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"const")," watching ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=")," compiler",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function",parentName:"code"},"watch"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// 示例"),"\n    aggregateTimeout",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token number",parentName:"code"},"300"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n    poll",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"undefined"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token parameter",parentName:"code"},"err",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},",")," stats"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=>")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// 这里打印 watch/build 结果..."),"\n    console",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function",parentName:"code"},"log"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),"stats",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),"\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"Watching")," 配置选项的细节可以在\n",(0,t.kt)("a",{href:"/configuration/watch/#watchoptions",parentName:"p"},"这里"),"查询。"),(0,t.kt)("aside",{className:"warning"},(0,t.kt)("h6",{className:"warning__prefix",parentName:"aside"},"警告"),(0,t.kt)("p",{parentName:"aside"},"文件系统不正确的问题，可能会对单次修改触发多次构建。\n因此，在上面的示例中，一次修改可能会多次触发 ",(0,t.kt)("inlineCode",{parentName:"p"},"console.log")," 语句。\n用户应该预知此行为，\n并且可能需要检查 ",(0,t.kt)("inlineCode",{parentName:"p"},"stats.hash")," 来查看文件哈希是否确实变更。")),(0,t.kt)("h3",null,(0,t.kt)("span",{id:"close-watching",parentName:"h3"}),"关闭 ",(0,t.kt)("inlineCode",{parentName:"h3"},"Watching")," (Close ",(0,t.kt)("inlineCode",{parentName:"h3"},"Watching"),")",(0,t.kt)("a",{href:"#close-watching","aria-hidden":"true",tabIndex:"-1",parentName:"h3"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"watch")," 方法返回一个 ",(0,t.kt)("inlineCode",{parentName:"p"},"Watching")," 实例，该实例会暴露一个 ",(0,t.kt)("inlineCode",{parentName:"p"},".close(callback)")," 方法。\n调用该方法将会结束监听:"),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-js",parentName:"pre"},"watching",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function",parentName:"code"},"close"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token parameter",parentName:"code"},"closeErr"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=>")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  console",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function",parentName:"code"},"log"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token string",parentName:"code"},"'Watching Ended.'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,t.kt)("aside",{className:"warning"},(0,t.kt)("h6",{className:"warning__prefix",parentName:"aside"},"警告"),(0,t.kt)("p",{parentName:"aside"},"不允许在监听器关闭或者失效前\n再次监听或执行。")),(0,t.kt)("h3",null,(0,t.kt)("span",{id:"invalidate-watching",parentName:"h3"}),"Invalidate ",(0,t.kt)("inlineCode",{parentName:"h3"},"Watching"),(0,t.kt)("a",{href:"#invalidate-watching","aria-hidden":"true",tabIndex:"-1",parentName:"h3"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"使用 ",(0,t.kt)("inlineCode",{parentName:"p"},"watching.invalidate"),"，你可以手动使当前编译循环（compiling round）无效，\n而不会停止监听进程（process）："),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-js",parentName:"pre"},"watching",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function",parentName:"code"},"invalidate"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,t.kt)("h2",null,(0,t.kt)("span",{id:"stats-object",parentName:"h2"}),"Stats 对象(Stats Object)",(0,t.kt)("a",{href:"#stats-object","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"stats")," 对象会被作为 ",(0,t.kt)("a",{href:"#webpack",parentName:"p"},(0,t.kt)("inlineCode",{parentName:"a"},"webpack()"))," 回调函数的第二个参数传递，\n可以通过它获取到代码编译过程中的有用信息，\n包括："),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"错误和警告(如果有的话)"),(0,t.kt)("li",{parentName:"ul"},"计时信息"),(0,t.kt)("li",{parentName:"ul"},"module 和 chunk 信息")),(0,t.kt)("p",null,(0,t.kt)("a",{href:"/api/cli",parentName:"p"},"webpack CLI")," 正是基于这些信息在控制台\n展示友好的格式输出。"),(0,t.kt)("aside",{className:"tip"},(0,t.kt)("h6",{className:"tip__prefix",parentName:"aside"},"提示"),(0,t.kt)("p",{parentName:"aside"},"当使用 ",(0,t.kt)("a",{href:"#multicompiler",parentName:"p"},(0,t.kt)("inlineCode",{parentName:"a"},"MultiCompiler"))," 时，\n会返回一个 ",(0,t.kt)("inlineCode",{parentName:"p"},"MultiStats")," 实例，\n它实现与 ",(0,t.kt)("inlineCode",{parentName:"p"},"stats")," 相同的接口，也就是下面描述的方法。")),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"stats")," 对象暴露了以下方法:"),(0,t.kt)("h3",null,(0,t.kt)("span",{id:"statshaserrors",parentName:"h3"}),"stats.hasErrors()",(0,t.kt)("a",{href:"#statshaserrors","aria-hidden":"true",tabIndex:"-1",parentName:"h3"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"可以用来检查编译期是否有错误，\n返回值为 ",(0,t.kt)("inlineCode",{parentName:"p"},"true")," 或 ",(0,t.kt)("inlineCode",{parentName:"p"},"false"),"。"),(0,t.kt)("h3",null,(0,t.kt)("span",{id:"statshaswarnings",parentName:"h3"}),"stats.hasWarnings()",(0,t.kt)("a",{href:"#statshaswarnings","aria-hidden":"true",tabIndex:"-1",parentName:"h3"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"可以用来检查编译期是否有警告，\n返回值为 ",(0,t.kt)("inlineCode",{parentName:"p"},"true")," 或 ",(0,t.kt)("inlineCode",{parentName:"p"},"false"),"。"),(0,t.kt)("h3",null,(0,t.kt)("span",{id:"statstojsonoptions",parentName:"h3"}),"stats.toJson(options)",(0,t.kt)("a",{href:"#statstojsonoptions","aria-hidden":"true",tabIndex:"-1",parentName:"h3"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"以 JSON 对象形式返回编译信息。\n",(0,t.kt)("inlineCode",{parentName:"p"},"options")," 可以是一个字符串（预设值）或是颗粒化控制的对象:"),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-js",parentName:"pre"},"stats",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function",parentName:"code"},"toJson"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token string",parentName:"code"},"'minimal'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-js",parentName:"pre"},"stats",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function",parentName:"code"},"toJson"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  assets",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token boolean",parentName:"code"},"false"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  hash",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token boolean",parentName:"code"},"true"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,t.kt)("p",null,"所有可用的配置选项和预设值都可查询 stats ",(0,t.kt)("a",{href:"/configuration/stats",parentName:"p"},"文档"),"。"),(0,t.kt)("blockquote",null,(0,t.kt)("p",{parentName:"blockquote"},"这里有")),(0,t.kt)("p",null,"该函数输出的"),(0,t.kt)("blockquote",null,(0,t.kt)("p",{parentName:"blockquote"},(0,t.kt)("a",{href:"https://raw.githubusercontent.com/webpack/analyse/master/app/pages/upload/example2.json",parentName:"p"},"示例"),"。")),(0,t.kt)("h3",null,(0,t.kt)("span",{id:"statstostringoptions",parentName:"h3"}),"stats.toString(options)",(0,t.kt)("a",{href:"#statstostringoptions","aria-hidden":"true",tabIndex:"-1",parentName:"h3"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"以格式化的字符串形式返回描述编译信息\n（类似 ",(0,t.kt)("a",{href:"/api/cli",parentName:"p"},"CLI")," 的输出）。"),(0,t.kt)("p",null,"配置对象与 ",(0,t.kt)("a",{href:"/api/node/#statstojsonoptions",parentName:"p"},(0,t.kt)("inlineCode",{parentName:"a"},"stats.toJson(options)"))," 一致，除了额外增加的一个选项:"),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-js",parentName:"pre"},"stats",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function",parentName:"code"},"toString"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// 增加控制台颜色开关"),"\n  colors",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token boolean",parentName:"code"},"true"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,t.kt)("p",null,"下面是 ",(0,t.kt)("inlineCode",{parentName:"p"},"stats.toString()")," 用法的示例:"),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-js",parentName:"pre"},(0,t.kt)("span",{className:"token keyword",parentName:"code"},"const")," webpack ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,t.kt)("span",{className:"token function",parentName:"code"},"require"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token string",parentName:"code"},"'webpack'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n\n",(0,t.kt)("span",{className:"token function",parentName:"code"},"webpack"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// ..."),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token parameter",parentName:"code"},"err",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},",")," stats"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=>")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"if")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),"err",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n      console",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function",parentName:"code"},"error"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),"err",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n      ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"return"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n    ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),"\n\n    console",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function",parentName:"code"},"log"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),"\n      stats",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function",parentName:"code"},"toString"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n        chunks",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token boolean",parentName:"code"},"false"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},",")," ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// 使构建过程更静默无输出"),"\n        colors",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token boolean",parentName:"code"},"true"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// 在控制台展示颜色"),"\n      ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),"\n    ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),"\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,t.kt)("h2",null,(0,t.kt)("span",{id:"multicompiler",parentName:"h2"}),"MultiCompiler",(0,t.kt)("a",{href:"#multicompiler","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"MultiCompiler")," 模块可以让 webpack 同时执行多个配置。\n如果传给 webpack 的 Node.js API 的 ",(0,t.kt)("inlineCode",{parentName:"p"},"options")," 参数，\n该参数由是由多个配置对象构成的数组，webpack 会相应地创建多个 compiler 实例，\n并且在所有 compiler 执行完毕后调用 ",(0,t.kt)("inlineCode",{parentName:"p"},"callback")," 方法。"),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-js",parentName:"pre"},(0,t.kt)("span",{className:"token keyword",parentName:"code"},"var")," webpack ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,t.kt)("span",{className:"token function",parentName:"code"},"require"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token string",parentName:"code"},"'webpack'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n\n",(0,t.kt)("span",{className:"token function",parentName:"code"},"webpack"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"\n    ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{")," entry",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'./index1.js'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},",")," output",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{")," filename",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'bundle1.js'")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n    ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{")," entry",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'./index2.js'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},",")," output",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{")," filename",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'bundle2.js'")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token parameter",parentName:"code"},"err",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},",")," stats"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=>")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    process",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),"stdout",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function",parentName:"code"},"write"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),"stats",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function",parentName:"code"},"toString"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"+")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'\\n'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),"\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,t.kt)("aside",{className:"warning"},(0,t.kt)("h6",{className:"warning__prefix",parentName:"aside"},"警告"),(0,t.kt)("p",{parentName:"aside"},"多个配置对象在执行时，",(0,t.kt)("strong",{parentName:"p"},"不会并行执行"),"。\n每个配置都只会在前一个处理结束后，\n才进行处理。")),(0,t.kt)("h2",null,(0,t.kt)("span",{id:"error-handling",parentName:"h2"}),"错误处理(Error Handling)",(0,t.kt)("a",{href:"#error-handling","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"完备的错误处理中需要考虑以下三种类型的错误:"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"致命的 wepback 错误（配置出错等）"),(0,t.kt)("li",{parentName:"ul"},"编译错误（缺失的 module，语法错误等）"),(0,t.kt)("li",{parentName:"ul"},"编译警告")),(0,t.kt)("p",null,"下面是一个覆盖这些场景的示例:"),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-js",parentName:"pre"},(0,t.kt)("span",{className:"token keyword",parentName:"code"},"const")," webpack ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,t.kt)("span",{className:"token function",parentName:"code"},"require"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token string",parentName:"code"},"'webpack'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n\n",(0,t.kt)("span",{className:"token function",parentName:"code"},"webpack"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// ..."),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token parameter",parentName:"code"},"err",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},",")," stats"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=>")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"if")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),"err",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n      console",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function",parentName:"code"},"error"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),"err",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),"stack ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"||")," err",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n      ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"if")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),"err",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),"details",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n        console",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function",parentName:"code"},"error"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),"err",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),"details",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n      ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),"\n      ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"return"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n    ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),"\n\n    ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"const")," info ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=")," stats",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function",parentName:"code"},"toJson"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n\n    ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"if")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),"stats",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function",parentName:"code"},"hasErrors"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n      console",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function",parentName:"code"},"error"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),"info",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),"errors",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n    ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),"\n\n    ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"if")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),"stats",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function",parentName:"code"},"hasWarnings"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n      console",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function",parentName:"code"},"warn"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),"info",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),"warnings",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n    ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),"\n\n    ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// Log result..."),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),"\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,t.kt)("h2",null,(0,t.kt)("span",{id:"custom-file-systems",parentName:"h2"}),"自定义文件系统(Custom File Systems)",(0,t.kt)("a",{href:"#custom-file-systems","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"默认情况下，webpack 使用普通文件系统来读取文件并将文件写入磁盘。\n但是，还可以使用不同类型的文件系统（内存(memory), webDAV 等）来更改输入或输出行为。\n为了实现这一点，\n可以改变 ",(0,t.kt)("inlineCode",{parentName:"p"},"inputFileSystem")," 或 ",(0,t.kt)("inlineCode",{parentName:"p"},"outputFileSystem"),"。\n例如，可以使用 ",(0,t.kt)("a",{href:"https://github.com/streamich/memfs",parentName:"p"},(0,t.kt)("inlineCode",{parentName:"a"},"memfs"))," 替换默认的 ",(0,t.kt)("inlineCode",{parentName:"p"},"outputFileSystem"),"，\n以将文件写入到内存中，\n而不是写入到磁盘:"),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-js",parentName:"pre"},(0,t.kt)("span",{className:"token keyword",parentName:"code"},"const")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{")," createFsFromVolume",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},",")," Volume ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}")," ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,t.kt)("span",{className:"token function",parentName:"code"},"require"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token string",parentName:"code"},"'memfs'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"const")," webpack ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,t.kt)("span",{className:"token function",parentName:"code"},"require"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token string",parentName:"code"},"'webpack'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n\n",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"const")," fs ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,t.kt)("span",{className:"token function",parentName:"code"},"createFsFromVolume"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token keyword",parentName:"code"},"new")," ",(0,t.kt)("span",{className:"token class-name",parentName:"code"},"Volume"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"const")," compiler ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,t.kt)("span",{className:"token function",parentName:"code"},"webpack"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"/* options */"),"\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n\ncompiler",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),"outputFileSystem ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=")," fs",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\ncompiler",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function",parentName:"code"},"run"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token parameter",parentName:"code"},"err",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},",")," stats"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=>")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// 之后读取输出:"),"\n  ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"const")," content ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=")," fs",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function",parentName:"code"},"readFileSync"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token string",parentName:"code"},"'...'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n  compiler",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function",parentName:"code"},"close"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token parameter",parentName:"code"},"closeErr"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=>")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// ..."),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,t.kt)("p",null,"值得一提的是，被\n",(0,t.kt)("a",{href:"https://github.com/webpack/webpack-dev-server",parentName:"p"},"webpack-dev-server"),"\n及众多其他包依赖的\n",(0,t.kt)("a",{href:"https://github.com/webpack/webpack-dev-middleware",parentName:"p"},"webpack-dev-middleware")," 就是通过这种方式，\n将你的文件神秘地隐藏起来，但却仍然可以用它们为浏览器提供服务！"),(0,t.kt)("aside",{className:"tip"},(0,t.kt)("h6",{className:"tip__prefix",parentName:"aside"},"提示"),(0,t.kt)("p",{parentName:"aside"},"你指定的输出文件系统需要\n兼容 Node 自身的 ",(0,t.kt)("a",{href:"https://nodejs.org/api/fs.html",parentName:"p"},(0,t.kt)("inlineCode",{parentName:"a"},"fs"))," 模块接口，\n接口需要提供 ",(0,t.kt)("inlineCode",{parentName:"p"},"mkdirp")," 和 ",(0,t.kt)("inlineCode",{parentName:"p"},"join")," 工具方法。")))}p.isMDXComponent=!0,e.default=p}}]);