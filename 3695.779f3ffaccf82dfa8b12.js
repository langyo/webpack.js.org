"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3695],{3695:function(e,a,n){n.r(a),n(7378);var t=n(2682);function o(){return o=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e},o.apply(this,arguments)}function s(e){let{components:a,...n}=e;return(0,t.kt)("wrapper",o({components:a},n),(0,t.kt)("blockquote",null,(0,t.kt)("p",{parentName:"blockquote"},"This README is for babel-loader v8 + Babel v7\nCheck the ",(0,t.kt)("a",{href:"https://github.com/babel/babel-loader/tree/7.x",parentName:"p"},"7.x branch")," for docs with Babel v6")),(0,t.kt)("p",null,(0,t.kt)("a",{href:"https://www.npmjs.com/package/babel-loader",parentName:"p"},(0,t.kt)("img",{src:"https://img.shields.io/npm/v/babel-loader.svg?style=flat",alt:"NPM Status",parentName:"a"})),"\n",(0,t.kt)("a",{href:"https://codecov.io/gh/babel/babel-loader",parentName:"p"},(0,t.kt)("img",{src:"https://codecov.io/gh/babel/babel-loader/branch/master/graph/badge.svg",alt:"codecov",parentName:"a"}))),(0,t.kt)("div",{align:"center"}),(0,t.kt)("p",null,"此 package 允许你使用 ",(0,t.kt)("a",{href:"https://github.com/babel/babel",parentName:"p"},"Babel")," 和 ",(0,t.kt)("a",{href:"https://github.com/webpack/webpack",parentName:"p"},"webpack")," 转译 ",(0,t.kt)("inlineCode",{parentName:"p"},"JavaScript")," 文件。"),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"注意"),"：请在 Babel ",(0,t.kt)("a",{href:"https://github.com/babel/babel/issues",parentName:"p"},"Issues")," tracker 上报告输出时遇到的问题。"),(0,t.kt)("h2",null,(0,t.kt)("span",{id:"install",parentName:"h2"}),"安装",(0,t.kt)("a",{href:"#install","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("blockquote",null,(0,t.kt)("p",{parentName:"blockquote"},"webpack 4.x | babel-loader 8.x | babel 7.x")),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-bash",parentName:"pre"},(0,t.kt)("span",{className:"token function",parentName:"code"},"npm")," ",(0,t.kt)("span",{className:"token function",parentName:"code"},"install")," -D babel-loader @babel/core @babel/preset-env webpack")),(0,t.kt)("h2",null,(0,t.kt)("span",{id:"usage",parentName:"h2"}),"用法",(0,t.kt)("a",{href:"#usage","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"webpack 文档：",(0,t.kt)("a",{href:"/loaders/",parentName:"p"},"Loaders")),(0,t.kt)("p",null,"在 webpack 配置对象中，需要将 babel-loader 添加到 module 列表中，就像下面这样："),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-javascript",parentName:"pre"},"module",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  rules",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"\n    ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n      test",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token regex",parentName:"code"},"/\\.m?js$/"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n      exclude",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token regex",parentName:"code"},"/(node_modules|bower_components)/"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n      use",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n        loader",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'babel-loader'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n        options",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n          presets",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),(0,t.kt)("span",{className:"token string",parentName:"code"},"'@babel/preset-env'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n        ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n      ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n    ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"))),(0,t.kt)("h3",null,(0,t.kt)("span",{id:"options",parentName:"h3"}),"选项",(0,t.kt)("a",{href:"#options","aria-hidden":"true",tabIndex:"-1",parentName:"h3"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"查看 babel ",(0,t.kt)("a",{href:"https://babeljs.io/docs/en/options",parentName:"p"},"选项"),"。"),(0,t.kt)("p",null,"你可以使用 options 属性，来向 loader 传递 options ",(0,t.kt)("a",{href:"/configuration/module/#ruleoptions--rulequery",parentName:"p"},"选项"),"："),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-javascript",parentName:"pre"},"module",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  rules",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"\n    ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n      test",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token regex",parentName:"code"},"/\\.m?js$/"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n      exclude",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token regex",parentName:"code"},"/(node_modules|bower_components)/"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n      use",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n        loader",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'babel-loader'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n        options",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n          presets",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),(0,t.kt)("span",{className:"token string",parentName:"code"},"'@babel/preset-env'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n          plugins",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),(0,t.kt)("span",{className:"token string",parentName:"code"},"'@babel/plugin-proposal-object-rest-spread'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n        ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n      ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n    ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"))),(0,t.kt)("p",null,"此 loader 也支持下面这些 loader 特有的选项："),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("p",{parentName:"li"},(0,t.kt)("inlineCode",{parentName:"p"},"cacheDirectory"),"：默认值为 ",(0,t.kt)("inlineCode",{parentName:"p"},"false"),"。当有设置时，指定的目录将用来缓存 loader 的执行结果。之后的 webpack 构建，将会尝试读取缓存，来避免在每次执行时，可能产生的、高性能消耗的 Babel 重新编译过程(recompilation process)。如果设置了一个空值 (",(0,t.kt)("inlineCode",{parentName:"p"},"loader: 'babel-loader?cacheDirectory'"),") 或者 ",(0,t.kt)("inlineCode",{parentName:"p"},"true")," (",(0,t.kt)("inlineCode",{parentName:"p"},"loader: 'babel-loader?cacheDirectory=true'"),")，loader 将使用默认的缓存目录 ",(0,t.kt)("inlineCode",{parentName:"p"},"node_modules/.cache/babel-loader"),"，如果在任何根目录下都没有找到 ",(0,t.kt)("inlineCode",{parentName:"p"},"node_modules")," 目录，将会降级回退到操作系统默认的临时文件目录。")),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("p",{parentName:"li"},(0,t.kt)("inlineCode",{parentName:"p"},"cacheIdentifier"),"：默认是由 ",(0,t.kt)("inlineCode",{parentName:"p"},"@babel/core")," 版本号，",(0,t.kt)("inlineCode",{parentName:"p"},"babel-loader")," 版本号，",(0,t.kt)("inlineCode",{parentName:"p"},".babelrc")," 文件内容（存在的情况下），环境变量 ",(0,t.kt)("inlineCode",{parentName:"p"},"BABEL_ENV")," 的值（没有时降级到 ",(0,t.kt)("inlineCode",{parentName:"p"},"NODE_ENV"),"）组成的一个字符串。可以设置为一个自定义的值，在 identifier 改变后，来强制缓存失效。")),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("p",{parentName:"li"},(0,t.kt)("inlineCode",{parentName:"p"},"cacheCompression"),"：默认值为 ",(0,t.kt)("inlineCode",{parentName:"p"},"true"),"。当设置此值时，会使用 Gzip 压缩每个 Babel transform 输出。如果你想要退出缓存压缩，将它设置为 ",(0,t.kt)("inlineCode",{parentName:"p"},"false")," -- 如果你的项目中有数千个文件需要压缩转译，那么设置此选项可能会从中收益。")),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("p",{parentName:"li"},(0,t.kt)("inlineCode",{parentName:"p"},"customize"),": 默认值为 ",(0,t.kt)("inlineCode",{parentName:"p"},"null"),"。导出 ",(0,t.kt)("inlineCode",{parentName:"p"},"custom")," 回调函数的模块路径，",(0,t.kt)("a",{href:"#customized-loader",parentName:"p"},"例如传入 ",(0,t.kt)("inlineCode",{parentName:"a"},".custom()")," 的 callback 函数"),"。由于你必须创建一个新文件才能使用它，建议改为使用 ",(0,t.kt)("inlineCode",{parentName:"p"},".custom")," 来创建一个包装 loader。只有在你",(0,t.kt)("em",{parentName:"p"},"必须"),"继续直接使用 ",(0,t.kt)("inlineCode",{parentName:"p"},"babel-loader")," 但又想自定义的情况下，才使用这项配置。"))),(0,t.kt)("h2",null,(0,t.kt)("span",{id:"troubleshooting",parentName:"h2"}),"疑难解答",(0,t.kt)("a",{href:"#troubleshooting","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("h3",null,(0,t.kt)("span",{id:"babel-loader-is-slow",parentName:"h3"}),"babel-loader 很慢！",(0,t.kt)("a",{href:"#babel-loader-is-slow","aria-hidden":"true",tabIndex:"-1",parentName:"h3"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"确保转译尽可能少的文件。你可能使用 ",(0,t.kt)("inlineCode",{parentName:"p"},"/\\.m?js$/")," 来匹配，这样也许会去转译 ",(0,t.kt)("inlineCode",{parentName:"p"},"node_modules")," 目录或者其他不需要的源代码。"),(0,t.kt)("p",null,"要排除 ",(0,t.kt)("inlineCode",{parentName:"p"},"node_modules"),"，参考文档中的 ",(0,t.kt)("inlineCode",{parentName:"p"},"loaders")," 配置的 ",(0,t.kt)("inlineCode",{parentName:"p"},"exclude")," 选项。"),(0,t.kt)("p",null,"你也可以通过使用 ",(0,t.kt)("inlineCode",{parentName:"p"},"cacheDirectory")," 选项，将 babel-loader 提速至少两倍。这会将转译的结果缓存到文件系统中。"),(0,t.kt)("h3",null,(0,t.kt)("span",{id:"babel-is-injecting-helpers-into-each-file-and-bloating-my-code",parentName:"h3"}),"Babel 在每个文件都插入了辅助代码，使代码体积过大！",(0,t.kt)("a",{href:"#babel-is-injecting-helpers-into-each-file-and-bloating-my-code","aria-hidden":"true",tabIndex:"-1",parentName:"h3"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"Babel 对一些公共方法使用了非常小的辅助代码，比如 ",(0,t.kt)("inlineCode",{parentName:"p"},"_extend"),"。默认情况下会被添加到每一个需要它的文件中。"),(0,t.kt)("p",null,"你可以引入 Babel runtime 作为一个独立模块，来避免重复引入。"),(0,t.kt)("p",null,"下面的配置禁用了 Babel 自动对每个文件的 runtime 注入，而是引入 ",(0,t.kt)("inlineCode",{parentName:"p"},"@babel/plugin-transform-runtime")," 并且使所有辅助代码从这里引用。"),(0,t.kt)("p",null,"更多信息请查看 ",(0,t.kt)("a",{href:"https://babel.docschina.org/docs/en/babel-plugin-transform-runtime/",parentName:"p"},"文档"),"。"),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"注意"),"：你必须执行 ",(0,t.kt)("inlineCode",{parentName:"p"},"npm install -D @babel/plugin-transform-runtime")," 来把它包含到你的项目中，然后使用 ",(0,t.kt)("inlineCode",{parentName:"p"},"npm install @babel/runtime")," 把 ",(0,t.kt)("inlineCode",{parentName:"p"},"@babel/runtime")," 安装为一个依赖。"),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-javascript",parentName:"pre"},"rules",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// 'transform-runtime' 插件告诉 Babel"),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// 要引用 runtime 来代替注入。"),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    test",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token regex",parentName:"code"},"/\\.m?js$/"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n    exclude",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token regex",parentName:"code"},"/(node_modules|bower_components)/"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n    use",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n      loader",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'babel-loader'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n      options",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n        presets",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),(0,t.kt)("span",{className:"token string",parentName:"code"},"'@babel/preset-env'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n        plugins",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),(0,t.kt)("span",{className:"token string",parentName:"code"},"'@babel/plugin-transform-runtime'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n      ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n    ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,t.kt)("h4",null,(0,t.kt)("span",{id:"note-transform-runtime--custom-polyfills-eg-promise-library",parentName:"h4"}),(0,t.kt)("strong",{parentName:"h4"},"注意"),"：transform-runtime 和自定义 polyfills (例如 Promise library)",(0,t.kt)("a",{href:"#note-transform-runtime--custom-polyfills-eg-promise-library","aria-hidden":"true",tabIndex:"-1",parentName:"h4"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"由于 ",(0,t.kt)("a",{href:"https://github.com/babel/babel/tree/master/packages/babel-plugin-transform-runtime",parentName:"p"},"@babel/plugin-transform-runtime")," 包含了一个 polyfill，含有自定义的 ",(0,t.kt)("a",{href:"https://github.com/facebook/regenerator/blob/master/packages/regenerator-runtime/runtime.js",parentName:"p"},"regenerator-runtime")," 和 ",(0,t.kt)("a",{href:"https://github.com/zloirock/core-js",parentName:"p"},"core-js"),", 下面使用 ",(0,t.kt)("inlineCode",{parentName:"p"},"webpack.ProvidePlugin")," 来配置 shimming 的常用方法将没有作用："),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-javascript",parentName:"pre"},(0,t.kt)("span",{className:"token comment",parentName:"code"},"// ..."),"\n        ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"new")," ",(0,t.kt)("span",{className:"token class-name",parentName:"code"},"webpack",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"."),"ProvidePlugin"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n            ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'Promise'"),(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'bluebird'"),"\n        ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// ..."))),(0,t.kt)("p",null,"下面这样的写法也没有作用："),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-javascript",parentName:"pre"},(0,t.kt)("span",{className:"token function",parentName:"code"},"require"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token string",parentName:"code"},"'@babel/runtime/core-js/promise'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),"default ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,t.kt)("span",{className:"token function",parentName:"code"},"require"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token string",parentName:"code"},"'bluebird'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n\n",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"var")," promise ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"new")," ",(0,t.kt)("span",{className:"token class-name",parentName:"code"},"Promise"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,t.kt)("p",null,"它其实会生成下面这样 (使用了 ",(0,t.kt)("inlineCode",{parentName:"p"},"runtime")," 后)："),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-javascript",parentName:"pre"},(0,t.kt)("span",{className:"token string",parentName:"code"},"'use strict'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n\n",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"var")," _Promise ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,t.kt)("span",{className:"token function",parentName:"code"},"require"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token string",parentName:"code"},"'@babel/runtime/core-js/promise'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),(0,t.kt)("span",{className:"token string",parentName:"code"},"'default'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n\n",(0,t.kt)("span",{className:"token function",parentName:"code"},"require"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token string",parentName:"code"},"'@babel/runtime/core-js/promise'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),(0,t.kt)("span",{className:"token string",parentName:"code"},"'default'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]")," ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,t.kt)("span",{className:"token function",parentName:"code"},"require"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token string",parentName:"code"},"'bluebird'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n\n",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"var")," promise ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"new")," ",(0,t.kt)("span",{className:"token class-name",parentName:"code"},"_Promise"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,t.kt)("p",null,"前面的 ",(0,t.kt)("inlineCode",{parentName:"p"},"Promise")," library 在被覆盖前已经被引用和使用了。"),(0,t.kt)("p",null,"一种可行的办法是，在你的应用程序中加入一个“引导(bootstrap)”步骤，在应用程序开始前先覆盖默认的全局变量。"),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-javascript",parentName:"pre"},(0,t.kt)("span",{className:"token comment",parentName:"code"},"// bootstrap.js"),"\n\n",(0,t.kt)("span",{className:"token function",parentName:"code"},"require"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token string",parentName:"code"},"'@babel/runtime/core-js/promise'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),"default ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,t.kt)("span",{className:"token function",parentName:"code"},"require"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token string",parentName:"code"},"'bluebird'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n\n",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// ..."),"\n\n",(0,t.kt)("span",{className:"token function",parentName:"code"},"require"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token string",parentName:"code"},"'./app'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,t.kt)("h3",null,(0,t.kt)("span",{id:"the-nodejs-api-for-babel-has-been-moved-to-babel-core",parentName:"h3"}),(0,t.kt)("inlineCode",{parentName:"h3"},"babel")," 的 Node.js API 已经被移到 ",(0,t.kt)("inlineCode",{parentName:"h3"},"babel-core")," 中。",(0,t.kt)("a",{href:"#the-nodejs-api-for-babel-has-been-moved-to-babel-core","aria-hidden":"true",tabIndex:"-1",parentName:"h3"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"如果你收到这个信息，这说明你有一个已经安装的 ",(0,t.kt)("inlineCode",{parentName:"p"},"babel")," npm package，并且在 webpack 配置中使用 loader 简写方式（在 webpack 2.x 版本中将不再支持这种方式）："),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-javascript",parentName:"pre"},"  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    test",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token regex",parentName:"code"},"/\\.m?js$/"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n    loader",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'babel'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"))),(0,t.kt)("p",null,"webpack 将尝试读取 ",(0,t.kt)("inlineCode",{parentName:"p"},"babel")," package 而不是 ",(0,t.kt)("inlineCode",{parentName:"p"},"babel-loader"),"。"),(0,t.kt)("p",null,"想要修复这个问题，你需要卸载 ",(0,t.kt)("inlineCode",{parentName:"p"},"babel")," npm package，因为它在 Babel v6 中已经被废除。（安装 ",(0,t.kt)("inlineCode",{parentName:"p"},"@babel/cli")," 或者 ",(0,t.kt)("inlineCode",{parentName:"p"},"@babel/core")," 来替代它）\n在另一种场景中，如果你的依赖于 ",(0,t.kt)("inlineCode",{parentName:"p"},"babel")," 而无法删除它，可以在 webpack 配置中使用完整的 loader 名称来解决："),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-javascript",parentName:"pre"},"  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    test",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token regex",parentName:"code"},"/\\.m?js$/"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n    loader",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'babel-loader'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"))),(0,t.kt)("h3",null,(0,t.kt)("span",{id:"exclude-libraries-that-should-not-be-transpiled",parentName:"h3"}),"排除不应参与转码的库",(0,t.kt)("a",{href:"#exclude-libraries-that-should-not-be-transpiled","aria-hidden":"true",tabIndex:"-1",parentName:"h3"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"core-js")," 和 ",(0,t.kt)("inlineCode",{parentName:"p"},"webpack/buildin")," 如果被 Babel 转码会发生错误。"),(0,t.kt)("p",null,"你需要在 ",(0,t.kt)("inlineCode",{parentName:"p"},"babel-loader")," 中排除它们："),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-js",parentName:"pre"},(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  ",(0,t.kt)("span",{className:"token string",parentName:"code"},'"loader"'),(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},'"babel-loader"'),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.kt)("span",{className:"token string",parentName:"code"},'"options"'),(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    ",(0,t.kt)("span",{className:"token string",parentName:"code"},'"exclude"'),(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"\n      ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// \\\\ for Windows, \\/ for Mac OS and Linux"),"\n      ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"/"),"node_modules",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"\\\\\\",(0,t.kt)("span",{className:"token regex",parentName:"code"},"/]core-js/"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n      ",(0,t.kt)("span",{className:"token regex",parentName:"code"},"/node_modules[\\\\\\/]webpack[\\\\\\/]buildin/"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n    ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n    ",(0,t.kt)("span",{className:"token string",parentName:"code"},'"presets"'),(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"\n      ",(0,t.kt)("span",{className:"token string",parentName:"code"},'"@babel/preset-env"'),"\n    ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]"),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),"\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"))),(0,t.kt)("h2",null,(0,t.kt)("span",{id:"customize-config-based-on-webpack-target",parentName:"h2"}),"根据 webpack 部署目标(target)的自定义配置",(0,t.kt)("a",{href:"#customize-config-based-on-webpack-target","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"Webpack 支持打包成多种 ",(0,t.kt)("a",{href:"/concepts/targets/",parentName:"p"},"部署目标")," 。例如，当需要为不同的部署目标（例如 ",(0,t.kt)("inlineCode",{parentName:"p"},"web")," 与 ",(0,t.kt)("inlineCode",{parentName:"p"},"node"),"）指定不同的 Babel 配置时， babel-loader 通过 Babel 的",(0,t.kt)("a",{href:"https://babeljs.io/docs/en/config-files#apicallercb",parentName:"p"},"caller")," API 提供了 ",(0,t.kt)("inlineCode",{parentName:"p"},"target"),"属性。"),(0,t.kt)("p",null,"例如，根据 webpack 的部署目标改变传给",(0,t.kt)("inlineCode",{parentName:"p"},"@babel/preset-env"),"的 targets 选项"),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-javascript",parentName:"pre"},(0,t.kt)("span",{className:"token comment",parentName:"code"},"// babel.config.js"),"\n\nmodule",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function-variable function",parentName:"code"},"exports")," ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token parameter",parentName:"code"},"api"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=>")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"return")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    plugins",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"\n      ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'@babel/plugin-proposal-nullish-coalescing-operator'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n      ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'@babel/plugin-proposal-optional-chaining'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n    ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n    presets",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"\n      ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"\n        ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'@babel/preset-env'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n        ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n          useBuiltIns",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'entry'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n          ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// caller.target 等于 webpack 配置的 target 选项"),"\n          targets",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," api",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function",parentName:"code"},"caller"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token parameter",parentName:"code"},"caller"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=>")," caller ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"&&")," caller",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),"target ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"===")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'node'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),"\n            ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"?")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{")," node",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'current'")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),"\n            ",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{")," chrome",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'58'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},",")," ie",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'11'")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n        ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n      ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n    ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,t.kt)("h2",null,(0,t.kt)("span",{id:"customized-loader",parentName:"h2"}),"自定义 loader",(0,t.kt)("a",{href:"#customized-loader","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"babel-loader")," 提供了一个 loader-builder 工具函数，\n允许用户为 Babel 处理过的每个文件添加自定义处理选项"),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},".custom")," 接收一个 callback 函数，\n它将被调用，并传入 loader 中的 ",(0,t.kt)("inlineCode",{parentName:"p"},"babel")," 实例，\n因此，此工具函数才能够完全确保它使用与 loader 的 ",(0,t.kt)("inlineCode",{parentName:"p"},"@babel/core")," 相同的实例。"),(0,t.kt)("p",null,"如果你想自定义，但实际上某个文件又不想调用 ",(0,t.kt)("inlineCode",{parentName:"p"},".custom"),"，\n可以向 ",(0,t.kt)("inlineCode",{parentName:"p"},"customize")," 选项传入一个字符串，\n此字符串指向一个导出 ",(0,t.kt)("inlineCode",{parentName:"p"},"custom")," 回调函数的文件。"),(0,t.kt)("h3",null,(0,t.kt)("span",{id:"example",parentName:"h3"}),"示例",(0,t.kt)("a",{href:"#example","aria-hidden":"true",tabIndex:"-1",parentName:"h3"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-js",parentName:"pre"},(0,t.kt)("span",{className:"token comment",parentName:"code"},'// 从 "./my-custom-loader.js" 中导出，或者任何你想要的文件中导出。'),"\nmodule",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),"exports ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,t.kt)("span",{className:"token function",parentName:"code"},"require"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token string",parentName:"code"},"'babel-loader'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function",parentName:"code"},"custom"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token parameter",parentName:"code"},"babel"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=>")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"function")," ",(0,t.kt)("span",{className:"token function",parentName:"code"},"myPlugin"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"return")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n      visitor",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n    ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),"\n\n  ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"return")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// 传给 loader 的选项。"),"\n    ",(0,t.kt)("span",{className:"token function",parentName:"code"},"customOptions"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token parameter",parentName:"code"},(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"{")," opt1",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},",")," opt2",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},",")," ",(0,t.kt)("span",{className:"token operator",parentName:"span"},"..."),"loader ",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"}")),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n      ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"return")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n        ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// 获取 loader 可能会有的自定义选项"),"\n        custom",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{")," opt1",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},",")," opt2 ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n\n        ",(0,t.kt)("span",{className:"token comment",parentName:"code"},'// 传入"移除了两个自定义选项"后的选项'),"\n        loader",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n      ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n    ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n\n    ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// 提供 Babel 的 'PartialConfig' 对象"),"\n    ",(0,t.kt)("span",{className:"token function",parentName:"code"},"config"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token parameter",parentName:"code"},"cfg"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n      ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"if")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),"cfg",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function",parentName:"code"},"hasFilesystemConfig"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n        ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// 使用正常的配置"),"\n        ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"return")," cfg",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),"options",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n      ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),"\n\n      ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"return")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n        ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"..."),"cfg",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),"options",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n        plugins",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"\n          ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"..."),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),"cfg",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),"options",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),"plugins ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"||")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n\n          ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// 在选项中包含自定义 plugin"),"\n          myPlugin",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n        ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n      ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n    ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n\n    ",(0,t.kt)("span",{className:"token function",parentName:"code"},"result"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token parameter",parentName:"code"},"result"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n      ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"return")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n        ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"..."),"result",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n        code",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," result",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),"code ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"+")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'\\n// 自定义loader生成'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n      ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n    ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-js",parentName:"pre"},(0,t.kt)("span",{className:"token comment",parentName:"code"},"// 然后，在你的 webpack config 文件中"),"\nmodule",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),"exports ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// .."),"\n  module",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    rules",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"\n      ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n        ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// ..."),"\n        loader",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," path",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function",parentName:"code"},"join"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),"__dirname",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},",")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'my-custom-loader.js'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n        ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// ..."),"\n      ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n    ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,t.kt)("h3",null,(0,t.kt)("span",{id:"customoptionsoptions-object--custom-object-loader-object-",parentName:"h3"}),(0,t.kt)("inlineCode",{parentName:"h3"},"customOptions(options: Object): { custom: Object, loader: Object }"),(0,t.kt)("a",{href:"#customoptionsoptions-object--custom-object-loader-object-","aria-hidden":"true",tabIndex:"-1",parentName:"h3"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"指定的 loader 的选项，\n从 ",(0,t.kt)("inlineCode",{parentName:"p"},"babel-loader")," 选项中分离出自定义选项。"),(0,t.kt)("h3",null,(0,t.kt)("span",{id:"configcfg-partialconfig-object",parentName:"h3"}),(0,t.kt)("inlineCode",{parentName:"h3"},"config(cfg: PartialConfig): Object"),(0,t.kt)("a",{href:"#configcfg-partialconfig-object","aria-hidden":"true",tabIndex:"-1",parentName:"h3"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"指定的 Babel 的 ",(0,t.kt)("inlineCode",{parentName:"p"},"PartialConfig")," 对象，\n返回应该被传递给 ",(0,t.kt)("inlineCode",{parentName:"p"},"babel.transform")," 的 ",(0,t.kt)("inlineCode",{parentName:"p"},"option")," 对象。"),(0,t.kt)("h3",null,(0,t.kt)("span",{id:"resultresult-result-result",parentName:"h3"}),(0,t.kt)("inlineCode",{parentName:"h3"},"result(result: Result): Result"),(0,t.kt)("a",{href:"#resultresult-result-result","aria-hidden":"true",tabIndex:"-1",parentName:"h3"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"指定的 Babel 结果对象，允许 loaders 对它进行额外的调整。"),(0,t.kt)("h2",null,(0,t.kt)("span",{id:"license",parentName:"h2"}),"License",(0,t.kt)("a",{href:"#license","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,(0,t.kt)("a",{href:"https://couto.mit-license.org/",parentName:"p"},"MIT")))}s.isMDXComponent=!0,a.default=s}}]);